2026-01-04 20:55:04.665 | INFO     | BLE Operation Logger iniciado: ble_operations_E0D362D6EEA0_20260104_205504.log
2026-01-04 20:55:04.666 | INFO     | Scanner BLE iniciado: hci0 (E0:D3:62:D6:EE:A0)
2026-01-04 20:55:04.666 | INFO     | BLE Client iniciado
2026-01-04 20:55:04.667 | DEBUG    | FragmentReassembler inicializado
2026-01-04 20:55:04.667 | INFO     | ReplayProtection iniciado (window_size=100)
2026-01-04 20:55:04.668 | INFO     |  Router Daemon inicializado para NID=0abd8260...
2026-01-04 20:55:04.668 | DEBUG    |  Send callback configurado
2026-01-04 20:55:04.669 | DEBUG    |  Handler registado para MessageType(1)
2026-01-04 20:55:04.669 | DEBUG    |  Handler registado para MessageType(2)
2026-01-04 20:55:04.669 | INFO     | IoT Node inicializado (adapter=hci0)
2026-01-04 20:55:04.670 | INFO     |  Router Daemon integrado
2026-01-04 20:55:04.671 | INFO     | A configurar GATT Server...
2026-01-04 20:55:04.675 | INFO     | Application criada: /
2026-01-04 20:55:04.676 | INFO     | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-04 20:55:04.677 | INFO     | A criar IoTNetworkService...
2026-01-04 20:55:04.677 | DEBUG    | Characteristic criada: /0/char0 (UUID: 12340001-0000-1000-8000-00805f9b34fb, flags: ['write', 'notify'])
2026-01-04 20:55:04.678 | INFO     | NetworkPacketCharacteristic criada
2026-01-04 20:55:04.678 | DEBUG    | Characteristic criada: /0/char1 (UUID: 12340002-0000-1000-8000-00805f9b34fb, flags: ['read'])
2026-01-04 20:55:04.679 | INFO     | DeviceInfoCharacteristic criada: NID=0abd8260..., type=node
2026-01-04 20:55:04.680 | DEBUG    | Characteristic criada: /0/char2 (UUID: 12340003-0000-1000-8000-00805f9b34fb, flags: ['read', 'notify'])
2026-01-04 20:55:04.680 | INFO     | NeighborTableCharacteristic criada
2026-01-04 20:55:04.680 | DEBUG    | Characteristic criada: /0/char3 (UUID: 12340004-0000-1000-8000-00805f9b34fb, flags: ['write', 'indicate'])
2026-01-04 20:55:04.681 | INFO     | AuthCharacteristic criada
2026-01-04 20:55:04.681 | DEBUG    | Characteristic adicionada a /0: /0/char0
2026-01-04 20:55:04.682 | DEBUG    | Characteristic adicionada a /0: /0/char1
2026-01-04 20:55:04.682 | DEBUG    | Characteristic adicionada a /0: /0/char2
2026-01-04 20:55:04.682 | DEBUG    | Characteristic adicionada a /0: /0/char3
2026-01-04 20:55:04.682 | INFO     |  IoTNetworkService criado com sucesso!
2026-01-04 20:55:04.683 | INFO     | Service adicionado à aplicação: /0
2026-01-04 20:55:04.684 | DEBUG    | Packet callback definido
2026-01-04 20:55:04.684 | DEBUG    | Auth callback definido
2026-01-04 20:55:04.685 | INFO     | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-04 20:55:04.685 | INFO     |  Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:04.686 | INFO     |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 20:55:04.687 | DEBUG    | Local name definido: IoT-Node-0abd8260
2026-01-04 20:55:04.687 | DEBUG    | Manufacturer data adicionado: ID=65535
2026-01-04 20:55:04.687 | INFO     |  Advertising contínuo configurado (duration=0)
2026-01-04 20:55:04.688 | INFO     |  GATT Server configurado
2026-01-04 20:55:04.689 | INFO     | A iniciar GATT Server...
2026-01-04 20:55:04.694 | INFO     |  GATT Server iniciado em thread separada
2026-01-04 20:55:04.694 | INFO     |  Node Device iniciado - CLI interativo pronto
2026-01-04 20:55:04.696 | DEBUG    | GetManagedObjects called
2026-01-04 20:55:04.696 | DEBUG    | GetManagedObjects returning 5 objects
2026-01-04 20:55:04.758 | INFO     |  GATT application registada!
2026-01-04 20:55:04.758 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 20:55:04.759 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 20:55:04.861 | INFO     |  Advertisement registado!
2026-01-04 20:55:12.750 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:55:12.751 | INFO     | [OP-20260104_205504-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:55:17.881 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -50 dBm
2026-01-04 20:55:17.887 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -46 dBm
2026-01-04 20:55:17.888 | INFO     | Scan concluído: 2 dispositivos encontrados
2026-01-04 20:55:17.890 | INFO     | [OP-20260104_205504-0002] SCAN_RESULT | Devices_Found: 2
2026-01-04 20:55:17.892 | DEBUG    | [OP-20260104_205504-0002]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -50 dBm | Services: 1
2026-01-04 20:55:17.892 | DEBUG    | [OP-20260104_205504-0002]   Device_2: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -46 dBm | Services: 1
2026-01-04 20:55:17.893 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:55:17.893 | INFO     | [OP-20260104_205504-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:55:22.935 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -50 dBm
2026-01-04 20:55:22.935 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:55:22.936 | INFO     | [OP-20260104_205504-0004] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:55:22.939 | DEBUG    | [OP-20260104_205504-0004]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -50 dBm | Services: 1
2026-01-04 20:55:41.392 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:55:41.394 | INFO     | [OP-20260104_205504-0005] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:55:46.525 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -48 dBm
2026-01-04 20:55:46.525 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:55:46.526 | INFO     | [OP-20260104_205504-0006] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:55:46.528 | DEBUG    | [OP-20260104_205504-0006]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -48 dBm | Services: 1
2026-01-04 20:55:46.529 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:55:46.530 | INFO     | [OP-20260104_205504-0007] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:55:51.555 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -50 dBm
2026-01-04 20:55:51.562 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -50 dBm
2026-01-04 20:55:51.562 | INFO     | Scan concluído: 2 dispositivos encontrados
2026-01-04 20:55:51.563 | INFO     | [OP-20260104_205504-0008] SCAN_RESULT | Devices_Found: 2
2026-01-04 20:55:51.565 | DEBUG    | [OP-20260104_205504-0008]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -50 dBm | Services: 1
2026-01-04 20:55:51.565 | DEBUG    | [OP-20260104_205504-0008]   Device_2: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -50 dBm | Services: 1
2026-01-04 20:55:54.554 | INFO     | A conectar ao Sink 58:00:E3:66:74:7C...
2026-01-04 20:55:54.556 | DEBUG    | BLEConnection criada para 58:00:E3:66:74:7C
2026-01-04 20:55:54.556 | INFO     | A conectar a 58:00:E3:66:74:7C...
2026-01-04 20:55:54.557 | INFO     | [OP-20260104_205504-0009] CONNECT_ATTEMPT | Local: E0:D3:62:D6:EE:A0 | Remote: 58:00:E3:66:74:7C
2026-01-04 20:55:57.788 | INFO     |  Conectado a 58:00:E3:66:74:7C
2026-01-04 20:55:57.789 | INFO     | [OP-20260104_205504-0010] CONNECT_SUCCESS | Remote: 58:00:E3:66:74:7C | Time: 3226.97ms
2026-01-04 20:55:57.790 | DEBUG    |  Conexão estabelecida. Operações GATT usarão D-Bus se necessário.
2026-01-04 20:55:57.790 | INFO     |  Conectado ao Sink via GATT
2026-01-04 20:55:57.794 | DEBUG    | Descobertos 3 serviços
2026-01-04 20:55:57.798 | DEBUG    | Serviço 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 20:55:57.799 | INFO     |  Serviço IoT Network encontrado
2026-01-04 20:55:57.801 | DEBUG    |  Timestamp de heartbeat resetado para nova conexão
2026-01-04 20:55:57.801 | INFO     | A subscrever a notificações...
2026-01-04 20:55:58.283 | INFO     |  Subscrito a notificações: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.285 | INFO     | [OP-20260104_205504-0011] SUBSCRIBE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.286 | INFO     |  Subscrito a NETWORK_PACKET
2026-01-04 20:55:58.288 | DEBUG    | [OP-20260104_205504-0012] READ_REQUEST | Remote: 58:00:E3:66:74:7C | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.373 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 20:55:58.374 | INFO     | [OP-20260104_205504-0013] READ_RESPONSE | Remote: 58:00:E3:66:74:7C | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: a40543face324331ad8d4798037bfbc7ff00 | ASCII: ..C..2C1..G..{....
2026-01-04 20:55:58.375 | INFO     |  Conectado ao Sink - hop_count=0
2026-01-04 20:55:58.377 | INFO     |  A iniciar autenticação com Sink...
2026-01-04 20:55:58.379 | DEBUG    |  A subscrever a AUTH characteristic...
2026-01-04 20:55:58.462 | INFO     |  Subscrito a notificações: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.463 | INFO     | [OP-20260104_205504-0014] SUBSCRIBE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.464 | DEBUG    |  Subscrito a AUTH indications
2026-01-04 20:55:58.464 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 20:55:58.465 | INFO     |  Enviando certificado...
2026-01-04 20:55:58.466 | INFO     |  Iniciando autenticação - enviando certificado...
2026-01-04 20:55:58.466 | INFO     |    Certificado: 887 bytes
2026-01-04 20:55:58.467 | DEBUG    |    Estado: IDLE → CERT_SENT
2026-01-04 20:55:58.467 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 20:55:58.468 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 20:55:58.468 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 20:55:58.468 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 20:55:58.469 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 20:55:58.469 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 20:55:58.469 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 20:55:58.471 | INFO     | [OP-20260104_205504-0015] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 20:55:58.551 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:55:58.552 | INFO     | [OP-20260104_205504-0016] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.553 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 20:55:58.654 | INFO     | [OP-20260104_205504-0017] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 20:55:58.731 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:55:58.732 | INFO     | [OP-20260104_205504-0018] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.732 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 20:55:58.834 | INFO     | [OP-20260104_205504-0019] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 20:55:58.911 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:55:58.912 | INFO     | [OP-20260104_205504-0020] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:58.913 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 20:55:59.015 | INFO     | [OP-20260104_205504-0021] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 20:55:59.091 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:55:59.092 | INFO     | [OP-20260104_205504-0022] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:59.093 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 20:55:59.194 | INFO     | [OP-20260104_205504-0023] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 20:55:59.272 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 20:55:59.272 | INFO     | [OP-20260104_205504-0024] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:55:59.273 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 20:55:59.273 | INFO     | [OP-20260104_205504-0025] NOTIFICATION | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 20:55:59.274 | DEBUG    |  AUTH indication recebida: 6 bytes
2026-01-04 20:55:59.274 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 20:55:59.274 | INFO     | Iniciando recepção de 1 fragmentos
2026-01-04 20:55:59.275 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 20:55:59.275 | INFO     |  Mensagem reconstruída: 3 bytes (1 fragmentos)
2026-01-04 20:55:59.275 | DEBUG    | FragmentReassembler resetado
2026-01-04 20:55:59.275 | DEBUG    |  AUTH mensagem completa: 3 bytes
2026-01-04 20:55:59.374 | DEBUG    | Autenticação round 1/10
2026-01-04 20:55:59.874 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 20:55:59.875 | DEBUG    |  Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 20:55:59.875 | INFO     |  Peer confirmou autenticação bem sucedida!
2026-01-04 20:55:59.877 | INFO     |  Autenticação bem-sucedida!
2026-01-04 20:55:59.878 | ERROR    | Certificados não disponíveis para derivar session key
2026-01-04 20:55:59.879 | INFO     | DTLSChannel criado (client) com certificado node_0abd8260_cert.pem
2026-01-04 20:55:59.880 | INFO     | Estabelecendo canal DTLS...
2026-01-04 20:55:59.892 | INFO     |  Canal DTLS estabelecido com sucesso
2026-01-04 20:55:59.892 | INFO     |  Canal DTLS end-to-end estabelecido com Sink
2026-01-04 20:55:59.893 | DEBUG    |  Re-registando advertising após conexão uplink...
2026-01-04 20:55:59.899 | DEBUG    |  Advertisement desregistado
2026-01-04 20:56:00.201 | DEBUG    | RegisterAdvertisement chamado (tentativa 1, delay 0.3s)
2026-01-04 20:56:00.207 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 20:56:00.208 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 20:56:00.220 | INFO     | ✅ Advertising re-registado após conexão uplink (tentativa 1)
2026-01-04 20:56:10.801 | INFO     | Desconectado de 58:00:E3:66:74:7C
2026-01-04 20:56:10.802 | INFO     | [OP-20260104_205504-0026] DISCONNECT | Remote: 58:00:E3:66:74:7C | Reason: normal
2026-01-04 20:56:11.801 | WARNING  |   Conexão perdida com Sink
2026-01-04 20:56:11.802 | DEBUG    | Nenhum downlink para desconectar
2026-01-04 20:56:13.662 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:56:13.663 | INFO     | [OP-20260104_205504-0027] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:56:18.788 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -48 dBm
2026-01-04 20:56:18.789 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:56:18.789 | INFO     | [OP-20260104_205504-0028] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:56:18.790 | DEBUG    | [OP-20260104_205504-0028]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -48 dBm | Services: 1
2026-01-04 20:56:18.793 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:56:18.793 | INFO     | [OP-20260104_205504-0029] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:56:23.823 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -52 dBm
2026-01-04 20:56:23.823 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:56:23.824 | INFO     | [OP-20260104_205504-0030] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:56:23.825 | DEBUG    | [OP-20260104_205504-0030]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -52 dBm | Services: 1
2026-01-04 20:56:26.272 | INFO     | A conectar ao Sink E0:D3:62:D7:47:03...
2026-01-04 20:56:26.275 | DEBUG    | BLEConnection criada para E0:D3:62:D7:47:03
2026-01-04 20:56:26.276 | INFO     | A conectar a E0:D3:62:D7:47:03...
2026-01-04 20:56:26.278 | INFO     | [OP-20260104_205504-0031] CONNECT_ATTEMPT | Local: E0:D3:62:D6:EE:A0 | Remote: E0:D3:62:D7:47:03
2026-01-04 20:56:29.878 | INFO     |  Conectado a E0:D3:62:D7:47:03
2026-01-04 20:56:29.879 | INFO     | [OP-20260104_205504-0032] CONNECT_SUCCESS | Remote: E0:D3:62:D7:47:03 | Time: 3597.00ms
2026-01-04 20:56:29.880 | DEBUG    |  Conexão estabelecida. Operações GATT usarão D-Bus se necessário.
2026-01-04 20:56:29.881 | INFO     |  Conectado ao Sink via GATT
2026-01-04 20:56:29.883 | DEBUG    | Descobertos 4 serviços
2026-01-04 20:56:29.885 | DEBUG    | Serviço 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 20:56:29.886 | INFO     |  Serviço IoT Network encontrado
2026-01-04 20:56:29.887 | DEBUG    |  Timestamp de heartbeat resetado para nova conexão
2026-01-04 20:56:29.888 | INFO     | A subscrever a notificações...
2026-01-04 20:56:30.345 | INFO     |  Subscrito a notificações: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.347 | INFO     | [OP-20260104_205504-0033] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.348 | INFO     |  Subscrito a NETWORK_PACKET
2026-01-04 20:56:30.350 | DEBUG    | [OP-20260104_205504-0034] READ_REQUEST | Remote: E0:D3:62:D7:47:03 | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.434 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 20:56:30.435 | INFO     | [OP-20260104_205504-0035] READ_RESPONSE | Remote: E0:D3:62:D7:47:03 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b17ff01 | ASCII: N.rR..LP...].>{...
2026-01-04 20:56:30.435 | INFO     |  Conectado ao Sink - hop_count=0
2026-01-04 20:56:30.436 | INFO     |  A iniciar autenticação com Sink...
2026-01-04 20:56:30.437 | DEBUG    |  A subscrever a AUTH characteristic...
2026-01-04 20:56:30.524 | INFO     |  Subscrito a notificações: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.525 | INFO     | [OP-20260104_205504-0036] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.526 | DEBUG    |  Subscrito a AUTH indications
2026-01-04 20:56:30.526 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 20:56:30.526 | INFO     |  Enviando certificado...
2026-01-04 20:56:30.528 | INFO     |  Iniciando autenticação - enviando certificado...
2026-01-04 20:56:30.529 | INFO     |    Certificado: 887 bytes
2026-01-04 20:56:30.529 | DEBUG    |    Estado: IDLE → CERT_SENT
2026-01-04 20:56:30.530 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 20:56:30.530 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 20:56:30.531 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 20:56:30.531 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 20:56:30.531 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 20:56:30.532 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 20:56:30.532 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 20:56:30.534 | INFO     | [OP-20260104_205504-0037] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 20:56:30.613 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:56:30.614 | INFO     | [OP-20260104_205504-0038] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.614 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 20:56:30.716 | INFO     | [OP-20260104_205504-0039] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 20:56:30.793 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:56:30.794 | INFO     | [OP-20260104_205504-0040] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.794 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 20:56:30.896 | INFO     | [OP-20260104_205504-0041] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 20:56:30.973 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:56:30.974 | INFO     | [OP-20260104_205504-0042] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:30.974 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 20:56:31.076 | INFO     | [OP-20260104_205504-0043] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 20:56:31.153 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:56:31.154 | INFO     | [OP-20260104_205504-0044] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:31.154 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 20:56:31.256 | INFO     | [OP-20260104_205504-0045] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 20:56:31.378 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 20:56:31.379 | INFO     | [OP-20260104_205504-0046] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943634443434164476741774942416749554847374f5a74 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUHG7OZt [TRUNCATED]
2026-01-04 20:56:31.380 | INFO     | [OP-20260104_205504-0047] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:31.381 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:56:31.382 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 20:56:31.384 | DEBUG    | Fragmento recebido: seq=0, total=6, payload=180 bytes, flags=0x01
2026-01-04 20:56:31.386 | INFO     | Iniciando recepção de 6 fragmentos
2026-01-04 20:56:31.387 | DEBUG    | Fragmento 1/6 armazenado (1 de 6 recebidos)
2026-01-04 20:56:31.388 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:56:31.469 | INFO     | [OP-20260104_205504-0048] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e44517a4e466f580a44544d324d4445774d6a41 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNDQzNFoX.DTM2MDEwMjA [TRUNCATED]
2026-01-04 20:56:31.470 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:56:31.470 | DEBUG    | Fragmento recebido: seq=1, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:56:31.470 | DEBUG    | Fragmento 2/6 armazenado (2 de 6 recebidos)
2026-01-04 20:56:31.470 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:56:31.485 | DEBUG    | Autenticação round 1/10
2026-01-04 20:56:31.561 | INFO     | [OP-20260104_205504-0049] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064d5463784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241416965 | ASCII: ...MTcxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAie [TRUNCATED]
2026-01-04 20:56:31.562 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:56:31.562 | DEBUG    | Fragmento recebido: seq=2, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:56:31.562 | DEBUG    | Fragmento 3/6 armazenado (3 de 6 recebidos)
2026-01-04 20:56:31.562 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:56:31.651 | INFO     | [OP-20260104_205504-0050] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000306744e5338774d764f4b683338524e0a68474a6a584d4c4678794e3148747658795a6a6b546f6e452f454b6d542f4f2f676e544b3246515946364d344d44 | ASCII: ...tNS8wMvOKh38RN.hGJjXMLFxyN1HtvXyZjkTonE/EKmT/O/gnTK2FQYF6M4MD [TRUNCATED]
2026-01-04 20:56:31.652 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:56:31.652 | DEBUG    | Fragmento recebido: seq=3, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:56:31.652 | DEBUG    | Fragmento 4/6 armazenado (4 de 6 recebidos)
2026-01-04 20:56:31.652 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:56:31.741 | INFO     | [OP-20260104_205504-0051] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067147634b4e4f617968672f445975705336566f6269315549565972784e0a6b5258466b4e49746558616456426f6d324b326a397350446f307978766142 | ASCII: ...qGcKNOayhg/DYupS6Vobi1UIVYrxN.kRXFkNIteXadVBom2K2j9sPDo0yxvaB [TRUNCATED]
2026-01-04 20:56:31.742 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:56:31.742 | DEBUG    | Fragmento recebido: seq=4, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:56:31.742 | DEBUG    | Fragmento 5/6 armazenado (5 de 6 recebidos)
2026-01-04 20:56:31.742 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:56:31.829 | INFO     | [OP-20260104_205504-0052] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0aa749982defa42491ee0ada7d3d1602e38a3e5303d6508ffe4d1ab0698478a926 | ASCII: ...RTIFICATE-----..I.-..$....}=....>S..P..M..i.x.&
2026-01-04 20:56:31.830 | DEBUG    |  AUTH indication recebida: 50 bytes
2026-01-04 20:56:31.830 | DEBUG    | Fragmento recebido: seq=5, total=6, payload=47 bytes, flags=0x02
2026-01-04 20:56:31.830 | DEBUG    | Fragmento 6/6 armazenado (6 de 6 recebidos)
2026-01-04 20:56:31.831 | INFO     |  Mensagem reconstruída: 947 bytes (6 fragmentos)
2026-01-04 20:56:31.831 | DEBUG    | FragmentReassembler resetado
2026-01-04 20:56:31.831 | DEBUG    |  AUTH mensagem completa: 947 bytes
2026-01-04 20:56:31.986 | DEBUG    | Resposta auth lida do buffer: 947 bytes
2026-01-04 20:56:31.986 | DEBUG    |  Recebido: AuthMessage(type=CHALLENGE, payload=944 bytes)
2026-01-04 20:56:31.987 | INFO     |  Challenge recebido - processando certificado + challenge...
2026-01-04 20:56:31.988 | INFO     |  Extraindo certificado do peer do payload...
2026-01-04 20:56:31.997 | DEBUG    |  Assinatura da CA válida
2026-01-04 20:56:31.998 | DEBUG    |  Certificado válido temporalmente (expira em 2036-01-02 00:44:34+00:00)
2026-01-04 20:56:31.999 | INFO     |  Certificado validado com sucesso
2026-01-04 20:56:32.000 | INFO     |  Certificado do peer validado!
2026-01-04 20:56:32.002 | INFO     |    Peer NID: 4e127252...
2026-01-04 20:56:32.005 | INFO     |    Peer tipo: SINK
2026-01-04 20:56:32.006 | DEBUG    |    Challenge: a749982defa42491ee0ada7d3d1602e3...
2026-01-04 20:56:32.006 | INFO     |   Assinando dados:
2026-01-04 20:56:32.006 | INFO     |    Data: 32 bytes | a749982defa42491ee0ada7d3d1602e38a3e5303d6508ffe4d1ab0698478a926...
2026-01-04 20:56:32.009 | INFO     |    Signature: 138 bytes | 30818702414f38af4b13e1629dff0444fb9235bda95e656696ab76031230383e...
2026-01-04 20:56:32.011 | INFO     |   Response gerada: 138 bytes
2026-01-04 20:56:32.012 | DEBUG    |    Estado: CHALLENGE_RECEIVED
2026-01-04 20:56:32.013 | DEBUG    |  Enviando resposta (141 bytes)
2026-01-04 20:56:32.013 | DEBUG    | Mensagem pequena (141 bytes), 1 fragmento
2026-01-04 20:56:32.013 | DEBUG    | Enviando mensagem auth: 141 bytes em 1 fragmento(s)
2026-01-04 20:56:32.016 | INFO     | [OP-20260104_205504-0053] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 144 bytes | Hex: 03000103008a30818702414f38af4b13e1629dff0444fb9235bda95e656696ab76031230383e74802345b96b3af1d5fcbbb4326e1b1ab794d1b94931ed2fba27 | ASCII: ......0...AO8.K..b...D..5..^ef..v..08>t.#E.k:.....2n......I1./.' [TRUNCATED]
2026-01-04 20:56:32.098 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (144 bytes)
2026-01-04 20:56:32.099 | INFO     | [OP-20260104_205504-0054] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:56:32.100 | DEBUG    |   Fragmento 1/1 enviado
2026-01-04 20:56:32.100 | DEBUG    | Autenticação round 2/10
2026-01-04 20:56:32.099 | INFO     | [OP-20260104_205504-0055] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 20:56:32.101 | DEBUG    |  AUTH indication recebida: 6 bytes
2026-01-04 20:56:32.101 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 20:56:32.101 | INFO     | Iniciando recepção de 1 fragmentos
2026-01-04 20:56:32.101 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 20:56:32.102 | INFO     |  Mensagem reconstruída: 3 bytes (1 fragmentos)
2026-01-04 20:56:32.102 | DEBUG    | FragmentReassembler resetado
2026-01-04 20:56:32.102 | DEBUG    |  AUTH mensagem completa: 3 bytes
2026-01-04 20:56:32.507 | INFO     | [OP-20260104_205504-0056] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000011738877ddf62694c7b1abb38d82f14988e7582c1de2cad865e397 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......s.w..&........I..X,....e.. [TRUNCATED]
2026-01-04 20:56:32.508 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:56:32.509 | DEBUG    | Novo source 4e127252...: seq=17 (primeiro pacote)
2026-01-04 20:56:32.509 | DEBUG    | Learning new route: 4e127252... → uplink
2026-01-04 20:56:32.510 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:56:32.510 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:56:32.511 | INFO     | Sink NID identificado: 4e127252...
2026-01-04 20:56:32.512 | DEBUG    | Novo source 4e127252...: seq=17 (primeiro pacote)
2026-01-04 20:56:32.513 | WARNING  |   Certificado do Sink não disponível para verificação
2026-01-04 20:56:32.514 | DEBUG    |    hasattr _sink_cert: False
2026-01-04 20:56:32.515 | ERROR    |  Assinatura de heartbeat inválida!
2026-01-04 20:56:32.601 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 20:56:32.601 | DEBUG    |  Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 20:56:32.601 | INFO     |  Peer confirmou autenticação bem sucedida!
2026-01-04 20:56:32.602 | INFO     |  Autenticação bem-sucedida!
2026-01-04 20:56:32.603 | DEBUG    |  Session key derivada: 32 bytes
2026-01-04 20:56:32.603 | INFO     |  Session key estabelecida
2026-01-04 20:56:32.604 | DEBUG    |  Session key configurada para porta uplink
2026-01-04 20:56:32.604 | INFO     |  Session key configurada no Router Daemon
2026-01-04 20:56:32.604 | INFO     |  Certificado do Sink armazenado para verificação de heartbeats
2026-01-04 20:56:32.605 | INFO     | DTLSChannel criado (client) com certificado node_0abd8260_cert.pem
2026-01-04 20:56:32.605 | INFO     | Estabelecendo canal DTLS...
2026-01-04 20:56:32.608 | INFO     |  Canal DTLS estabelecido com sucesso
2026-01-04 20:56:32.609 | INFO     |  Canal DTLS end-to-end estabelecido com Sink
2026-01-04 20:56:32.610 | INFO     |  Chave de encriptação end-to-end derivada (AES-256-GCM)
2026-01-04 20:56:32.610 | INFO     |  Chave de encriptação end-to-end derivada
2026-01-04 20:56:32.611 | DEBUG    |  Re-registando advertising após conexão uplink...
2026-01-04 20:56:32.614 | DEBUG    |  Advertisement desregistado
2026-01-04 20:56:32.915 | DEBUG    | RegisterAdvertisement chamado (tentativa 1, delay 0.3s)
2026-01-04 20:56:32.921 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 20:56:32.922 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 20:56:32.932 | INFO     | ✅ Advertising re-registado após conexão uplink (tentativa 1)
2026-01-04 20:56:37.501 | INFO     | [OP-20260104_205504-0057] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000012ffc37fe5f224b1d2cc51d577de3cfa572d427e19e764113c9f13 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{............$...Q.w.<.W-B~..d.<.. [TRUNCATED]
2026-01-04 20:56:37.502 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:56:37.502 | DEBUG    | Source 4e127252...: seq=18 (novo highest, window: 2 seqs)
2026-01-04 20:56:37.503 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:56:37.503 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:56:37.505 | DEBUG    | Source 4e127252...: seq=18 (novo highest, window: 2 seqs)
2026-01-04 20:56:37.505 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 20:56:37.505 | INFO     |  Verificando heartbeat:
2026-01-04 20:56:37.506 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:56:37.508 | INFO     |    Timestamp: 1767560197.4548266
2026-01-04 20:56:37.509 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b5015d1be1
2026-01-04 20:56:37.511 | INFO     |  Verificando assinatura:
2026-01-04 20:56:37.512 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b5015d1be1...
2026-01-04 20:56:37.516 | INFO     |    Signature: 138 bytes | 3081870242010d31c7aa4c9aaab2a879ce96838e9fc5f229e5b28af9fbfe17f5...
2026-01-04 20:56:37.523 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:56:37.524 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:56:37.524 | DEBUG    |  Heartbeat recebido (seq=18, age=0.07s)
2026-01-04 20:56:42.495 | INFO     | [OP-20260104_205504-0058] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000133b48bb1ba3dbabb8bc7f9c95153a417a740c3ae94ed6027d45a8 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......;H...........:Azt.:.N..}E. [TRUNCATED]
2026-01-04 20:56:42.497 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:56:42.497 | DEBUG    | Source 4e127252...: seq=19 (novo highest, window: 3 seqs)
2026-01-04 20:56:42.498 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:56:42.498 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:56:42.499 | DEBUG    | Source 4e127252...: seq=19 (novo highest, window: 3 seqs)
2026-01-04 20:56:42.500 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 20:56:42.500 | INFO     |  Verificando heartbeat:
2026-01-04 20:56:42.501 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:56:42.503 | INFO     |    Timestamp: 1767560202.454654
2026-01-04 20:56:42.504 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b5029d190d
2026-01-04 20:56:42.505 | INFO     |  Verificando assinatura:
2026-01-04 20:56:42.506 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b5029d190d...
2026-01-04 20:56:42.507 | INFO     |    Signature: 139 bytes | 3081880242010c1b00c6990bd03432fce0403465ddb778bd247117bd47411a61...
2026-01-04 20:56:42.513 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:56:42.514 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:56:42.514 | DEBUG    |  Heartbeat recebido (seq=19, age=0.06s)
2026-01-04 20:56:47.490 | INFO     | [OP-20260104_205504-0059] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000014c5e8fd1959644412ce52627fb1850a62a640d5ec19067cc52941 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{...........YdD..Rb....b.@....|.)A [TRUNCATED]
2026-01-04 20:56:47.492 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:56:47.493 | DEBUG    | Source 4e127252...: seq=20 (novo highest, window: 4 seqs)
2026-01-04 20:56:47.493 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:56:47.493 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:56:47.494 | DEBUG    | Source 4e127252...: seq=20 (novo highest, window: 4 seqs)
2026-01-04 20:56:47.495 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 20:56:47.495 | INFO     |  Verificando heartbeat:
2026-01-04 20:56:47.496 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:56:47.497 | INFO     |    Timestamp: 1767560207.4543726
2026-01-04 20:56:47.499 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b503dd1471
2026-01-04 20:56:47.500 | INFO     |  Verificando assinatura:
2026-01-04 20:56:47.501 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b503dd1471...
2026-01-04 20:56:47.502 | INFO     |    Signature: 139 bytes | 3081880242009d7b4ba7fb0178069a7b0a0685f43cd1f6ed5fde718eb4b98c92...
2026-01-04 20:56:47.508 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:56:47.511 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:56:47.512 | DEBUG    |  Heartbeat recebido (seq=20, age=0.06s)
2026-01-04 20:56:52.486 | INFO     | [OP-20260104_205504-0060] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000015ac51d5f7d50317bda2e14b160c10e6512189fc6e05742399e18e | ASCII: N.rR..LP...].>{.N.rR..LP...].>{........Q........K....Q!..n.t#... [TRUNCATED]
2026-01-04 20:56:52.487 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:56:52.488 | DEBUG    | Source 4e127252...: seq=21 (novo highest, window: 5 seqs)
2026-01-04 20:56:52.488 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:56:52.489 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:56:52.489 | DEBUG    | Source 4e127252...: seq=21 (novo highest, window: 5 seqs)
2026-01-04 20:56:52.490 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 20:56:52.490 | INFO     |  Verificando heartbeat:
2026-01-04 20:56:52.492 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:56:52.494 | INFO     |    Timestamp: 1767560212.4543457
2026-01-04 20:56:52.495 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b5051d1400
2026-01-04 20:56:52.496 | INFO     |  Verificando assinatura:
2026-01-04 20:56:52.497 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b5051d1400...
2026-01-04 20:56:52.498 | INFO     |    Signature: 138 bytes | 3081870241787f6de72e228566c43cb40993392c3ac99633fa69e8e9dd0316be...
2026-01-04 20:56:52.504 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:56:52.504 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:56:52.505 | DEBUG    |  Heartbeat recebido (seq=21, age=0.05s)
2026-01-04 20:56:57.479 | INFO     | [OP-20260104_205504-0061] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000165a073d929ac3385bba47606227463948bd0e137a3167c612f1e4 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......Z.=...8[.G`b'F9H...z1g.... [TRUNCATED]
2026-01-04 20:56:57.481 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:56:57.481 | DEBUG    | Source 4e127252...: seq=22 (novo highest, window: 6 seqs)
2026-01-04 20:56:57.482 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:56:57.482 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:56:57.483 | DEBUG    | Source 4e127252...: seq=22 (novo highest, window: 6 seqs)
2026-01-04 20:56:57.484 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 20:56:57.484 | INFO     |  Verificando heartbeat:
2026-01-04 20:56:57.485 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:56:57.486 | INFO     |    Timestamp: 1767560217.454763
2026-01-04 20:56:57.487 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b5065d1ad6
2026-01-04 20:56:57.490 | INFO     |  Verificando assinatura:
2026-01-04 20:56:57.491 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b5065d1ad6...
2026-01-04 20:56:57.493 | INFO     |    Signature: 139 bytes | 308188024201cf819a5a46702571982e48021cf7d102e4983dff8491c45981c9...
2026-01-04 20:56:57.500 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:56:57.502 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:56:57.503 | DEBUG    |  Heartbeat recebido (seq=22, age=0.05s)
2026-01-04 20:57:02.519 | INFO     | [OP-20260104_205504-0062] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000172095a0aec60ac149c42618dfc9b3e4cc6ae28dac5a9dd458b348 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{....... ......I.&......j...Z..X.H [TRUNCATED]
2026-01-04 20:57:02.520 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:57:02.520 | DEBUG    | Source 4e127252...: seq=23 (novo highest, window: 7 seqs)
2026-01-04 20:57:02.521 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:57:02.521 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:57:02.522 | DEBUG    | Source 4e127252...: seq=23 (novo highest, window: 7 seqs)
2026-01-04 20:57:02.522 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 20:57:02.522 | INFO     |  Verificando heartbeat:
2026-01-04 20:57:02.523 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:57:02.523 | INFO     |    Timestamp: 1767560222.4543428
2026-01-04 20:57:02.524 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b5079d13f4
2026-01-04 20:57:02.526 | INFO     |  Verificando assinatura:
2026-01-04 20:57:02.526 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b5079d13f4...
2026-01-04 20:57:02.527 | INFO     |    Signature: 138 bytes | 3081870242012cbb1d52a60eb831a5daae48d78f996149e12bd1b7079cf9c631...
2026-01-04 20:57:02.530 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:57:02.536 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:57:02.536 | DEBUG    |  Heartbeat recebido (seq=23, age=0.08s)
2026-01-04 20:57:07.515 | INFO     | [OP-20260104_205504-0063] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000018b3232013c8a33342cf7f3db16240004803fbf7eb719db3814263 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{........# ...3B..=.b@.H....q...Bc [TRUNCATED]
2026-01-04 20:57:07.517 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:57:07.518 | DEBUG    | Source 4e127252...: seq=24 (novo highest, window: 8 seqs)
2026-01-04 20:57:07.518 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:57:07.519 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:57:07.520 | DEBUG    | Source 4e127252...: seq=24 (novo highest, window: 8 seqs)
2026-01-04 20:57:07.521 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 20:57:07.521 | INFO     |  Verificando heartbeat:
2026-01-04 20:57:07.523 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:57:07.524 | INFO     |    Timestamp: 1767560227.454422
2026-01-04 20:57:07.525 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b508dd1540
2026-01-04 20:57:07.526 | INFO     |  Verificando assinatura:
2026-01-04 20:57:07.527 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b508dd1540...
2026-01-04 20:57:07.528 | INFO     |    Signature: 138 bytes | 3081870241221cce5c339cbaca2e7a3aeb3631813b19b56a201570eb0279f1fb...
2026-01-04 20:57:07.533 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:57:07.534 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:57:07.535 | DEBUG    |  Heartbeat recebido (seq=24, age=0.08s)
2026-01-04 20:57:12.510 | INFO     | [OP-20260104_205504-0064] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000019b4b5fb6981914e03f4d04425cef5f6b854cd83a8c6cf98a06953 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{..........i..N...D%....T.......iS [TRUNCATED]
2026-01-04 20:57:12.511 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:57:12.512 | DEBUG    | Source 4e127252...: seq=25 (novo highest, window: 9 seqs)
2026-01-04 20:57:12.512 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:57:12.513 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:57:12.514 | DEBUG    | Source 4e127252...: seq=25 (novo highest, window: 9 seqs)
2026-01-04 20:57:12.514 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 20:57:12.515 | INFO     |  Verificando heartbeat:
2026-01-04 20:57:12.516 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:57:12.517 | INFO     |    Timestamp: 1767560232.4547493
2026-01-04 20:57:12.518 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b50a1d1a9d
2026-01-04 20:57:12.520 | INFO     |  Verificando assinatura:
2026-01-04 20:57:12.521 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b50a1d1a9d...
2026-01-04 20:57:12.523 | INFO     |    Signature: 139 bytes | 308188024201068ee82e9a46be857ec085013adbc858356ed72fd4001dbf02ae...
2026-01-04 20:57:12.533 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:57:12.534 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:57:12.535 | DEBUG    |  Heartbeat recebido (seq=25, age=0.08s)
2026-01-04 20:57:17.505 | INFO     | [OP-20260104_205504-0065] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000001a09a6131b7b1c1c7bd554b7a1700237751766e39eb8184b31f638 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{...........{..{.T..p.7u.f....K1.8 [TRUNCATED]
2026-01-04 20:57:17.506 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:57:17.507 | DEBUG    | Source 4e127252...: seq=26 (novo highest, window: 10 seqs)
2026-01-04 20:57:17.507 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:57:17.508 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:57:17.509 | DEBUG    | Source 4e127252...: seq=26 (novo highest, window: 10 seqs)
2026-01-04 20:57:17.509 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 20:57:17.509 | INFO     |  Verificando heartbeat:
2026-01-04 20:57:17.511 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:57:17.512 | INFO     |    Timestamp: 1767560237.4543488
2026-01-04 20:57:17.513 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b50b5d140d
2026-01-04 20:57:17.514 | INFO     |  Verificando assinatura:
2026-01-04 20:57:17.516 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b50b5d140d...
2026-01-04 20:57:17.518 | INFO     |    Signature: 138 bytes | 308187024201f35b4a88b5a2be81004e3fd6e702969fce7172207cd9c5f25f82...
2026-01-04 20:57:17.523 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:57:17.524 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:57:17.524 | DEBUG    |  Heartbeat recebido (seq=26, age=0.07s)
2026-01-04 20:57:27.814 | WARNING  |   Sem heartbeat há 10.3s (último seq=26)
2026-01-04 20:57:28.816 | WARNING  |   Sem heartbeat há 11.3s (último seq=26)
2026-01-04 20:57:29.816 | WARNING  |   Sem heartbeat há 12.3s (último seq=26)
2026-01-04 20:57:30.818 | WARNING  |   Sem heartbeat há 13.3s (último seq=26)
2026-01-04 20:57:31.818 | WARNING  |   Sem heartbeat há 14.3s (último seq=26)
2026-01-04 20:57:32.820 | ERROR    |  Timeout de heartbeat! Sem heartbeat há 15.3s (último seq=26)
2026-01-04 20:57:32.821 | WARNING  |   Desconectando do uplink devido a timeout de heartbeat...
2026-01-04 20:57:32.838 | INFO     | Desconectado de E0:D3:62:D7:47:03
2026-01-04 20:57:32.839 | INFO     | [OP-20260104_205504-0066] DISCONNECT | Remote: E0:D3:62:D7:47:03 | Reason: normal
2026-01-04 20:57:32.841 | DEBUG    | Nenhum downlink para desconectar
2026-01-04 20:57:33.841 | WARNING  |   Conexão perdida com Sink
2026-01-04 20:57:33.842 | DEBUG    | Nenhum downlink para desconectar
2026-01-04 20:58:26.138 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:58:26.140 | INFO     | [OP-20260104_205504-0067] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:58:31.350 | INFO     | Scan concluído: 0 dispositivos encontrados
2026-01-04 20:58:31.352 | INFO     | [OP-20260104_205504-0068] SCAN_RESULT | Devices_Found: 0
2026-01-04 20:58:31.354 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:58:31.356 | INFO     | [OP-20260104_205504-0069] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:58:36.403 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -72 dBm
2026-01-04 20:58:36.404 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:58:36.405 | INFO     | [OP-20260104_205504-0070] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:58:36.406 | DEBUG    | [OP-20260104_205504-0070]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -72 dBm | Services: 1
2026-01-04 20:58:39.774 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:58:39.776 | INFO     | [OP-20260104_205504-0071] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:58:44.908 | INFO     | Scan concluído: 0 dispositivos encontrados
2026-01-04 20:58:44.909 | INFO     | [OP-20260104_205504-0072] SCAN_RESULT | Devices_Found: 0
2026-01-04 20:58:44.911 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:58:44.913 | INFO     | [OP-20260104_205504-0073] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:58:49.947 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -54 dBm
2026-01-04 20:58:49.948 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:58:49.950 | INFO     | [OP-20260104_205504-0074] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:58:49.952 | DEBUG    | [OP-20260104_205504-0074]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -54 dBm | Services: 1
2026-01-04 20:58:53.139 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:58:53.140 | INFO     | [OP-20260104_205504-0075] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:58:58.282 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -52 dBm
2026-01-04 20:58:58.283 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:58:58.284 | INFO     | [OP-20260104_205504-0076] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:58:58.285 | DEBUG    | [OP-20260104_205504-0076]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -52 dBm | Services: 1
2026-01-04 20:58:58.285 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:58:58.287 | INFO     | [OP-20260104_205504-0077] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:59:03.316 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -52 dBm
2026-01-04 20:59:03.317 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:59:03.318 | INFO     | [OP-20260104_205504-0078] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:59:03.320 | DEBUG    | [OP-20260104_205504-0078]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -52 dBm | Services: 1
2026-01-04 20:59:06.512 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:59:06.514 | INFO     | [OP-20260104_205504-0079] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:59:11.637 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -54 dBm
2026-01-04 20:59:11.638 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:59:11.639 | INFO     | [OP-20260104_205504-0080] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:59:11.640 | DEBUG    | [OP-20260104_205504-0080]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -54 dBm | Services: 1
2026-01-04 20:59:11.641 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 20:59:11.643 | INFO     | [OP-20260104_205504-0081] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 20:59:16.675 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -56 dBm
2026-01-04 20:59:16.675 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 20:59:16.677 | INFO     | [OP-20260104_205504-0082] SCAN_RESULT | Devices_Found: 1
2026-01-04 20:59:16.679 | DEBUG    | [OP-20260104_205504-0082]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -56 dBm | Services: 1
2026-01-04 20:59:19.106 | INFO     | A conectar ao Sink E0:D3:62:D7:47:03...
2026-01-04 20:59:19.107 | DEBUG    | BLEConnection criada para E0:D3:62:D7:47:03
2026-01-04 20:59:19.107 | INFO     | A conectar a E0:D3:62:D7:47:03...
2026-01-04 20:59:19.108 | INFO     | [OP-20260104_205504-0083] CONNECT_ATTEMPT | Local: E0:D3:62:D6:EE:A0 | Remote: E0:D3:62:D7:47:03
2026-01-04 20:59:23.075 | INFO     |  Conectado a E0:D3:62:D7:47:03
2026-01-04 20:59:23.076 | INFO     | [OP-20260104_205504-0084] CONNECT_SUCCESS | Remote: E0:D3:62:D7:47:03 | Time: 3964.06ms
2026-01-04 20:59:23.077 | DEBUG    |  Conexão estabelecida. Operações GATT usarão D-Bus se necessário.
2026-01-04 20:59:23.078 | INFO     |  Conectado ao Sink via GATT
2026-01-04 20:59:23.081 | DEBUG    | Descobertos 4 serviços
2026-01-04 20:59:23.085 | DEBUG    | Serviço 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 20:59:23.086 | INFO     |  Serviço IoT Network encontrado
2026-01-04 20:59:23.087 | DEBUG    |  Timestamp de heartbeat resetado para nova conexão
2026-01-04 20:59:23.087 | INFO     | A subscrever a notificações...
2026-01-04 20:59:23.509 | INFO     |  Subscrito a notificações: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:23.510 | INFO     | [OP-20260104_205504-0085] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:23.512 | INFO     |  Subscrito a NETWORK_PACKET
2026-01-04 20:59:23.515 | DEBUG    | [OP-20260104_205504-0086] READ_REQUEST | Remote: E0:D3:62:D7:47:03 | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:23.599 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 20:59:23.600 | INFO     | [OP-20260104_205504-0087] READ_RESPONSE | Remote: E0:D3:62:D7:47:03 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b17ff01 | ASCII: N.rR..LP...].>{...
2026-01-04 20:59:23.602 | INFO     |  Conectado ao Sink - hop_count=0
2026-01-04 20:59:23.603 | INFO     |  A iniciar autenticação com Sink...
2026-01-04 20:59:23.604 | DEBUG    |  A subscrever a AUTH characteristic...
2026-01-04 20:59:23.688 | INFO     |  Subscrito a notificações: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:23.689 | INFO     | [OP-20260104_205504-0088] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:23.690 | DEBUG    |  Subscrito a AUTH indications
2026-01-04 20:59:23.690 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 20:59:23.691 | INFO     |  Enviando certificado...
2026-01-04 20:59:23.692 | INFO     |  Iniciando autenticação - enviando certificado...
2026-01-04 20:59:23.693 | INFO     |    Certificado: 887 bytes
2026-01-04 20:59:23.693 | DEBUG    |    Estado: IDLE → CERT_SENT
2026-01-04 20:59:23.694 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 20:59:23.694 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 20:59:23.695 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 20:59:23.695 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 20:59:23.695 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 20:59:23.696 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 20:59:23.696 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 20:59:23.698 | INFO     | [OP-20260104_205504-0089] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 20:59:23.777 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:59:23.778 | INFO     | [OP-20260104_205504-0090] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:23.779 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 20:59:23.880 | INFO     | [OP-20260104_205504-0091] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 20:59:23.957 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:59:23.958 | INFO     | [OP-20260104_205504-0092] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:23.958 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 20:59:24.060 | INFO     | [OP-20260104_205504-0093] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 20:59:24.137 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:59:24.138 | INFO     | [OP-20260104_205504-0094] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:24.138 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 20:59:24.240 | INFO     | [OP-20260104_205504-0095] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 20:59:24.317 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 20:59:24.318 | INFO     | [OP-20260104_205504-0096] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:24.318 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 20:59:24.420 | INFO     | [OP-20260104_205504-0097] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 20:59:24.589 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 20:59:24.590 | INFO     | [OP-20260104_205504-0098] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:24.591 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 20:59:24.592 | INFO     | [OP-20260104_205504-0099] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943634443434164476741774942416749554847374f5a74 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUHG7OZt [TRUNCATED]
2026-01-04 20:59:24.594 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:59:24.594 | DEBUG    | Fragmento recebido: seq=0, total=6, payload=180 bytes, flags=0x01
2026-01-04 20:59:24.594 | INFO     | Iniciando recepção de 6 fragmentos
2026-01-04 20:59:24.595 | DEBUG    | Fragmento 1/6 armazenado (1 de 6 recebidos)
2026-01-04 20:59:24.596 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:59:24.692 | DEBUG    | Autenticação round 1/10
2026-01-04 20:59:24.724 | INFO     | [OP-20260104_205504-0100] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e44517a4e466f580a44544d324d4445774d6a41 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNDQzNFoX.DTM2MDEwMjA [TRUNCATED]
2026-01-04 20:59:24.725 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:59:24.726 | DEBUG    | Fragmento recebido: seq=1, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:59:24.726 | DEBUG    | Fragmento 2/6 armazenado (2 de 6 recebidos)
2026-01-04 20:59:24.726 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:59:24.860 | INFO     | [OP-20260104_205504-0101] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064d5463784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241416965 | ASCII: ...MTcxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAie [TRUNCATED]
2026-01-04 20:59:24.861 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:59:24.861 | DEBUG    | Fragmento recebido: seq=2, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:59:24.862 | DEBUG    | Fragmento 3/6 armazenado (3 de 6 recebidos)
2026-01-04 20:59:24.862 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:59:24.994 | INFO     | [OP-20260104_205504-0102] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000306744e5338774d764f4b683338524e0a68474a6a584d4c4678794e3148747658795a6a6b546f6e452f454b6d542f4f2f676e544b3246515946364d344d44 | ASCII: ...tNS8wMvOKh38RN.hGJjXMLFxyN1HtvXyZjkTonE/EKmT/O/gnTK2FQYF6M4MD [TRUNCATED]
2026-01-04 20:59:24.996 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:59:24.997 | DEBUG    | Fragmento recebido: seq=3, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:59:24.997 | DEBUG    | Fragmento 4/6 armazenado (4 de 6 recebidos)
2026-01-04 20:59:24.997 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:59:25.129 | INFO     | [OP-20260104_205504-0103] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067147634b4e4f617968672f445975705336566f6269315549565972784e0a6b5258466b4e49746558616456426f6d324b326a397350446f307978766142 | ASCII: ...qGcKNOayhg/DYupS6Vobi1UIVYrxN.kRXFkNIteXadVBom2K2j9sPDo0yxvaB [TRUNCATED]
2026-01-04 20:59:25.130 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 20:59:25.131 | DEBUG    | Fragmento recebido: seq=4, total=6, payload=180 bytes, flags=0x00
2026-01-04 20:59:25.131 | DEBUG    | Fragmento 5/6 armazenado (5 de 6 recebidos)
2026-01-04 20:59:25.132 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 20:59:25.192 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 20:59:25.192 | DEBUG    | Autenticação round 2/10
2026-01-04 20:59:25.219 | INFO     | [OP-20260104_205504-0104] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0a441ee06dfb46ce08a440d736338c4ad8d43d7628b29a90f436b231441461f3d8 | ASCII: ...RTIFICATE-----.D..m.F...@.63.J..=v(....6.1D.a..
2026-01-04 20:59:25.219 | DEBUG    |  AUTH indication recebida: 50 bytes
2026-01-04 20:59:25.220 | DEBUG    | Fragmento recebido: seq=5, total=6, payload=47 bytes, flags=0x02
2026-01-04 20:59:25.220 | DEBUG    | Fragmento 6/6 armazenado (6 de 6 recebidos)
2026-01-04 20:59:25.220 | INFO     |  Mensagem reconstruída: 947 bytes (6 fragmentos)
2026-01-04 20:59:25.221 | DEBUG    | FragmentReassembler resetado
2026-01-04 20:59:25.221 | DEBUG    |  AUTH mensagem completa: 947 bytes
2026-01-04 20:59:25.692 | DEBUG    | Resposta auth lida do buffer: 947 bytes
2026-01-04 20:59:25.693 | DEBUG    |  Recebido: AuthMessage(type=CHALLENGE, payload=944 bytes)
2026-01-04 20:59:25.694 | INFO     |  Challenge recebido - processando certificado + challenge...
2026-01-04 20:59:25.695 | INFO     |  Extraindo certificado do peer do payload...
2026-01-04 20:59:25.699 | DEBUG    |  Assinatura da CA válida
2026-01-04 20:59:25.700 | DEBUG    |  Certificado válido temporalmente (expira em 2036-01-02 00:44:34+00:00)
2026-01-04 20:59:25.701 | INFO     |  Certificado validado com sucesso
2026-01-04 20:59:25.703 | INFO     |  Certificado do peer validado!
2026-01-04 20:59:25.704 | INFO     |    Peer NID: 4e127252...
2026-01-04 20:59:25.706 | INFO     |    Peer tipo: SINK
2026-01-04 20:59:25.708 | DEBUG    |    Challenge: 441ee06dfb46ce08a440d736338c4ad8...
2026-01-04 20:59:25.709 | INFO     |   Assinando dados:
2026-01-04 20:59:25.710 | INFO     |    Data: 32 bytes | 441ee06dfb46ce08a440d736338c4ad8d43d7628b29a90f436b231441461f3d8...
2026-01-04 20:59:25.712 | INFO     |    Signature: 138 bytes | 308187024106d7f6bda953758344287d9e5eb954b9574e0836dedc81cb198bc5...
2026-01-04 20:59:25.713 | INFO     |   Response gerada: 138 bytes
2026-01-04 20:59:25.713 | DEBUG    |    Estado: CHALLENGE_RECEIVED
2026-01-04 20:59:25.713 | DEBUG    |  Enviando resposta (141 bytes)
2026-01-04 20:59:25.713 | DEBUG    | Mensagem pequena (141 bytes), 1 fragmento
2026-01-04 20:59:25.714 | DEBUG    | Enviando mensagem auth: 141 bytes em 1 fragmento(s)
2026-01-04 20:59:25.716 | INFO     | [OP-20260104_205504-0105] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 144 bytes | Hex: 03000103008a308187024106d7f6bda953758344287d9e5eb954b9574e0836dedc81cb198bc55e1dac84e2d538ea97900e2c74e3a2c6bcb83b5512004790b523 | ASCII: ......0...A.....Su.D(}.^.T.WN.6.......^.....8....,t.....;U..G..# [TRUNCATED]
2026-01-04 20:59:25.802 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (144 bytes)
2026-01-04 20:59:25.803 | INFO     | [OP-20260104_205504-0106] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 20:59:25.804 | DEBUG    |   Fragmento 1/1 enviado
2026-01-04 20:59:25.805 | DEBUG    | Autenticação round 3/10
2026-01-04 20:59:25.804 | INFO     | [OP-20260104_205504-0107] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 20:59:25.805 | DEBUG    |  AUTH indication recebida: 6 bytes
2026-01-04 20:59:25.805 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 20:59:25.806 | INFO     | Iniciando recepção de 1 fragmentos
2026-01-04 20:59:25.806 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 20:59:25.806 | INFO     |  Mensagem reconstruída: 3 bytes (1 fragmentos)
2026-01-04 20:59:25.807 | DEBUG    | FragmentReassembler resetado
2026-01-04 20:59:25.807 | DEBUG    |  AUTH mensagem completa: 3 bytes
2026-01-04 20:59:26.305 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 20:59:26.306 | DEBUG    |  Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 20:59:26.306 | INFO     |  Peer confirmou autenticação bem sucedida!
2026-01-04 20:59:26.308 | INFO     |  Autenticação bem-sucedida!
2026-01-04 20:59:26.312 | DEBUG    |  Session key derivada: 32 bytes
2026-01-04 20:59:26.312 | INFO     |  Session key estabelecida
2026-01-04 20:59:26.313 | DEBUG    |  Session key configurada para porta uplink
2026-01-04 20:59:26.314 | INFO     |  Session key configurada no Router Daemon
2026-01-04 20:59:26.315 | INFO     |  Certificado do Sink armazenado para verificação de heartbeats
2026-01-04 20:59:26.316 | INFO     | DTLSChannel criado (client) com certificado node_0abd8260_cert.pem
2026-01-04 20:59:26.317 | INFO     | Estabelecendo canal DTLS...
2026-01-04 20:59:26.330 | INFO     |  Canal DTLS estabelecido com sucesso
2026-01-04 20:59:26.331 | INFO     |  Canal DTLS end-to-end estabelecido com Sink
2026-01-04 20:59:26.331 | INFO     |  Chave de encriptação end-to-end derivada (AES-256-GCM)
2026-01-04 20:59:26.332 | INFO     |  Chave de encriptação end-to-end derivada
2026-01-04 20:59:26.332 | DEBUG    |  Re-registando advertising após conexão uplink...
2026-01-04 20:59:26.338 | DEBUG    |  Advertisement desregistado
2026-01-04 20:59:26.639 | DEBUG    | RegisterAdvertisement chamado (tentativa 1, delay 0.3s)
2026-01-04 20:59:26.644 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 20:59:26.644 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 20:59:26.656 | INFO     | ✅ Advertising re-registado após conexão uplink (tentativa 1)
2026-01-04 20:59:27.558 | INFO     | [OP-20260104_205504-0108] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000340551cd06bdcfbfa8fd450d071f165f48a20078e5cc8bb4422e8b | ASCII: N.rR..LP...].>{.N.rR..LP...].>{......4.Q.......E...._H..x....B.. [TRUNCATED]
2026-01-04 20:59:27.559 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:59:27.559 | DEBUG    | Source 4e127252...: seq=52 (novo highest, window: 11 seqs)
2026-01-04 20:59:27.559 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:59:27.559 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:59:27.560 | DEBUG    | Source 4e127252...: seq=52 (novo highest, window: 11 seqs)
2026-01-04 20:59:27.560 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 20:59:27.560 | INFO     |  Verificando heartbeat:
2026-01-04 20:59:27.561 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:59:27.561 | INFO     |    Timestamp: 1767560367.4513264
2026-01-04 20:59:27.562 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b52bdce288
2026-01-04 20:59:27.563 | INFO     |  Verificando assinatura:
2026-01-04 20:59:27.565 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b52bdce288...
2026-01-04 20:59:27.568 | INFO     |    Signature: 139 bytes | 308188024201fb8982c90978b7e7e6c3bf3c6df99d3e9447aa8eb1629b2335a1...
2026-01-04 20:59:27.577 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:59:27.578 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:59:27.579 | DEBUG    |  Heartbeat recebido (seq=52, age=0.13s)
2026-01-04 20:59:32.553 | INFO     | [OP-20260104_205504-0109] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000035aba8d41fe48da171e1bdcb9ce03b2fcfadd77108ad94f24920a6 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{......5.......q.....;/...q....I . [TRUNCATED]
2026-01-04 20:59:32.554 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 20:59:32.554 | DEBUG    | Source 4e127252...: seq=53 (novo highest, window: 12 seqs)
2026-01-04 20:59:32.554 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 20:59:32.555 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 20:59:32.555 | DEBUG    | Source 4e127252...: seq=53 (novo highest, window: 12 seqs)
2026-01-04 20:59:32.556 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 20:59:32.556 | INFO     |  Verificando heartbeat:
2026-01-04 20:59:32.557 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 20:59:32.558 | INFO     |    Timestamp: 1767560372.454748
2026-01-04 20:59:32.560 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b52d1d1a97
2026-01-04 20:59:32.563 | INFO     |  Verificando assinatura:
2026-01-04 20:59:32.565 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b52d1d1a97...
2026-01-04 20:59:32.567 | INFO     |    Signature: 138 bytes | 308187024139a698385e80f6c4994de75d3ce84d397878e1c281854d26cef745...
2026-01-04 20:59:32.571 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 20:59:32.572 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 20:59:32.572 | DEBUG    |  Heartbeat recebido (seq=53, age=0.12s)
2026-01-04 20:59:34.891 | INFO     | A parar Node...
2026-01-04 20:59:34.893 | INFO     | A parar GATT Server...
2026-01-04 20:59:34.897 | INFO     |  GATT Server parado
2026-01-04 20:59:37.780 | INFO     | Desconectado de E0:D3:62:D7:47:03
2026-01-04 20:59:37.782 | INFO     | [OP-20260104_205504-0110] DISCONNECT | Remote: E0:D3:62:D7:47:03 | Reason: normal
2026-01-04 20:59:37.782 | WARNING  |   Conexão perdida com Sink
2026-01-04 20:59:37.784 | INFO     |  Node parado
2026-01-04 20:59:37.789 | DEBUG    | Nenhum downlink para desconectar
