2026-01-04 21:47:22.687 | INFO     | BLE Operation Logger iniciado: ble_operations_E0D362D6EEA0_20260104_214722.log
2026-01-04 21:47:22.688 | INFO     | Scanner BLE iniciado: hci0 (E0:D3:62:D6:EE:A0)
2026-01-04 21:47:22.689 | INFO     | BLE Client iniciado
2026-01-04 21:47:22.690 | DEBUG    | FragmentReassembler inicializado
2026-01-04 21:47:22.690 | INFO     | ReplayProtection iniciado (window_size=100)
2026-01-04 21:47:22.691 | INFO     |  Router Daemon inicializado para NID=0abd8260...
2026-01-04 21:47:22.692 | DEBUG    |  Send callback configurado
2026-01-04 21:47:22.692 | DEBUG    |  Handler registado para MessageType(1)
2026-01-04 21:47:22.693 | DEBUG    |  Handler registado para MessageType(2)
2026-01-04 21:47:22.693 | INFO     | IoT Node inicializado (adapter=hci0)
2026-01-04 21:47:22.693 | INFO     |  Router Daemon integrado
2026-01-04 21:47:22.695 | INFO     | A configurar GATT Server...
2026-01-04 21:47:22.698 | INFO     | Application criada: /
2026-01-04 21:47:22.698 | INFO     | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-04 21:47:22.699 | INFO     | A criar IoTNetworkService...
2026-01-04 21:47:22.700 | DEBUG    | Characteristic criada: /0/char0 (UUID: 12340001-0000-1000-8000-00805f9b34fb, flags: ['write', 'notify'])
2026-01-04 21:47:22.700 | INFO     | NetworkPacketCharacteristic criada
2026-01-04 21:47:22.701 | DEBUG    | Characteristic criada: /0/char1 (UUID: 12340002-0000-1000-8000-00805f9b34fb, flags: ['read'])
2026-01-04 21:47:22.701 | INFO     | DeviceInfoCharacteristic criada: NID=0abd8260..., type=node
2026-01-04 21:47:22.702 | DEBUG    | Characteristic criada: /0/char2 (UUID: 12340003-0000-1000-8000-00805f9b34fb, flags: ['read', 'notify'])
2026-01-04 21:47:22.702 | INFO     | NeighborTableCharacteristic criada
2026-01-04 21:47:22.702 | DEBUG    | Characteristic criada: /0/char3 (UUID: 12340004-0000-1000-8000-00805f9b34fb, flags: ['write', 'indicate'])
2026-01-04 21:47:22.703 | INFO     | AuthCharacteristic criada
2026-01-04 21:47:22.703 | DEBUG    | Characteristic adicionada a /0: /0/char0
2026-01-04 21:47:22.703 | DEBUG    | Characteristic adicionada a /0: /0/char1
2026-01-04 21:47:22.703 | DEBUG    | Characteristic adicionada a /0: /0/char2
2026-01-04 21:47:22.704 | DEBUG    | Characteristic adicionada a /0: /0/char3
2026-01-04 21:47:22.704 | INFO     |  IoTNetworkService criado com sucesso!
2026-01-04 21:47:22.704 | INFO     | Service adicionado à aplicação: /0
2026-01-04 21:47:22.705 | DEBUG    | Packet callback definido
2026-01-04 21:47:22.705 | DEBUG    | Auth callback definido
2026-01-04 21:47:22.705 | INFO     | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-04 21:47:22.706 | INFO     |  Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:22.706 | INFO     |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 21:47:22.707 | DEBUG    | Local name definido: IoT-Node-0abd8260
2026-01-04 21:47:22.707 | DEBUG    | Manufacturer data adicionado: ID=65535
2026-01-04 21:47:22.707 | INFO     |  Advertising contínuo configurado (duration=0)
2026-01-04 21:47:22.708 | INFO     |  GATT Server configurado
2026-01-04 21:47:22.709 | INFO     | A iniciar GATT Server...
2026-01-04 21:47:22.715 | DEBUG    | GetManagedObjects called
2026-01-04 21:47:22.715 | DEBUG    | GetManagedObjects returning 5 objects
2026-01-04 21:47:22.716 | INFO     |  GATT Server iniciado em thread separada
2026-01-04 21:47:22.718 | INFO     |  Node Device iniciado - CLI interativo pronto
2026-01-04 21:47:22.784 | INFO     |  GATT application registada!
2026-01-04 21:47:22.785 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 21:47:22.786 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 21:47:22.797 | INFO     |  Advertisement registado!
2026-01-04 21:47:27.048 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:47:27.049 | INFO     | [OP-20260104_214722-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:47:32.083 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -42 dBm
2026-01-04 21:47:32.084 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 21:47:32.086 | INFO     | [OP-20260104_214722-0002] SCAN_RESULT | Devices_Found: 1
2026-01-04 21:47:32.087 | DEBUG    | [OP-20260104_214722-0002]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -42 dBm | Services: 4
2026-01-04 21:47:32.087 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:47:32.088 | INFO     | [OP-20260104_214722-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:47:37.118 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -52 dBm
2026-01-04 21:47:37.128 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -50 dBm
2026-01-04 21:47:37.129 | INFO     | Scan concluído: 2 dispositivos encontrados
2026-01-04 21:47:37.130 | INFO     | [OP-20260104_214722-0004] SCAN_RESULT | Devices_Found: 2
2026-01-04 21:47:37.131 | DEBUG    | [OP-20260104_214722-0004]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -52 dBm | Services: 1
2026-01-04 21:47:37.131 | DEBUG    | [OP-20260104_214722-0004]   Device_2: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -50 dBm | Services: 4
2026-01-04 21:47:41.561 | INFO     | A conectar ao Sink E0:D3:62:D7:47:03...
2026-01-04 21:47:41.562 | DEBUG    | BLEConnection criada para E0:D3:62:D7:47:03
2026-01-04 21:47:41.563 | INFO     | A conectar a E0:D3:62:D7:47:03...
2026-01-04 21:47:41.564 | INFO     | [OP-20260104_214722-0005] CONNECT_ATTEMPT | Local: E0:D3:62:D6:EE:A0 | Remote: E0:D3:62:D7:47:03
2026-01-04 21:47:41.576 | INFO     |  Conectado a E0:D3:62:D7:47:03
2026-01-04 21:47:41.577 | INFO     | [OP-20260104_214722-0006] CONNECT_SUCCESS | Remote: E0:D3:62:D7:47:03 | Time: 8.40ms
2026-01-04 21:47:41.579 | DEBUG    |  Conexão estabelecida. Operações GATT usarão D-Bus se necessário.
2026-01-04 21:47:41.580 | INFO     |  Conectado ao Sink via GATT
2026-01-04 21:47:41.584 | DEBUG    | Descobertos 4 serviços
2026-01-04 21:47:41.589 | DEBUG    | Serviço 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 21:47:41.590 | INFO     |  Serviço IoT Network encontrado
2026-01-04 21:47:41.591 | DEBUG    |  Timestamp de heartbeat resetado para nova conexão
2026-01-04 21:47:41.591 | INFO     | A subscrever a notificações...
2026-01-04 21:47:41.690 | INFO     |  Subscrito a notificações: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:41.691 | INFO     | [OP-20260104_214722-0007] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:41.691 | INFO     |  Subscrito a NETWORK_PACKET
2026-01-04 21:47:41.692 | DEBUG    | [OP-20260104_214722-0008] READ_REQUEST | Remote: E0:D3:62:D7:47:03 | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:41.780 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 21:47:41.780 | INFO     | [OP-20260104_214722-0009] READ_RESPONSE | Remote: E0:D3:62:D7:47:03 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b17ff01 | ASCII: N.rR..LP...].>{...
2026-01-04 21:47:41.781 | INFO     |  Conectado ao Sink - hop_count=0
2026-01-04 21:47:41.781 | INFO     |  A iniciar autenticação com Sink...
2026-01-04 21:47:41.782 | DEBUG    |  A subscrever a AUTH characteristic...
2026-01-04 21:47:41.870 | INFO     |  Subscrito a notificações: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:41.871 | INFO     | [OP-20260104_214722-0010] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:41.871 | DEBUG    |  Subscrito a AUTH indications
2026-01-04 21:47:41.872 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 21:47:41.872 | INFO     |  Enviando certificado...
2026-01-04 21:47:41.872 | INFO     |  Iniciando autenticação - enviando certificado...
2026-01-04 21:47:41.874 | INFO     |    Certificado: 887 bytes
2026-01-04 21:47:41.874 | DEBUG    |    Estado: IDLE → CERT_SENT
2026-01-04 21:47:41.874 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 21:47:41.875 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 21:47:41.875 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 21:47:41.876 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 21:47:41.876 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 21:47:41.876 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 21:47:41.876 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 21:47:41.878 | INFO     | [OP-20260104_214722-0011] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 21:47:41.959 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:47:41.960 | INFO     | [OP-20260104_214722-0012] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:41.960 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 21:47:42.062 | INFO     | [OP-20260104_214722-0013] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 21:47:42.139 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:47:42.140 | INFO     | [OP-20260104_214722-0014] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:42.140 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 21:47:42.242 | INFO     | [OP-20260104_214722-0015] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 21:47:42.319 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:47:42.320 | INFO     | [OP-20260104_214722-0016] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:42.320 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 21:47:42.422 | INFO     | [OP-20260104_214722-0017] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 21:47:42.499 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:47:42.500 | INFO     | [OP-20260104_214722-0018] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:42.500 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 21:47:42.602 | INFO     | [OP-20260104_214722-0019] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 21:47:42.723 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 21:47:42.723 | INFO     | [OP-20260104_214722-0020] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:42.724 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 21:47:42.725 | INFO     | [OP-20260104_214722-0021] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943634443434164476741774942416749554847374f5a74 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUHG7OZt [TRUNCATED]
2026-01-04 21:47:42.725 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:47:42.726 | DEBUG    | Fragmento recebido: seq=0, total=6, payload=180 bytes, flags=0x01
2026-01-04 21:47:42.726 | INFO     | Iniciando recepção de 6 fragmentos
2026-01-04 21:47:42.727 | DEBUG    | Fragmento 1/6 armazenado (1 de 6 recebidos)
2026-01-04 21:47:42.727 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:47:42.815 | INFO     | [OP-20260104_214722-0022] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e44517a4e466f580a44544d324d4445774d6a41 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNDQzNFoX.DTM2MDEwMjA [TRUNCATED]
2026-01-04 21:47:42.816 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:47:42.816 | DEBUG    | Fragmento recebido: seq=1, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:47:42.816 | DEBUG    | Fragmento 2/6 armazenado (2 de 6 recebidos)
2026-01-04 21:47:42.816 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:47:42.824 | DEBUG    | Autenticação round 1/10
2026-01-04 21:47:42.907 | INFO     | [OP-20260104_214722-0023] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064d5463784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241416965 | ASCII: ...MTcxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAie [TRUNCATED]
2026-01-04 21:47:42.907 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:47:42.908 | DEBUG    | Fragmento recebido: seq=2, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:47:42.908 | DEBUG    | Fragmento 3/6 armazenado (3 de 6 recebidos)
2026-01-04 21:47:42.908 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:47:42.998 | INFO     | [OP-20260104_214722-0024] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000306744e5338774d764f4b683338524e0a68474a6a584d4c4678794e3148747658795a6a6b546f6e452f454b6d542f4f2f676e544b3246515946364d344d44 | ASCII: ...tNS8wMvOKh38RN.hGJjXMLFxyN1HtvXyZjkTonE/EKmT/O/gnTK2FQYF6M4MD [TRUNCATED]
2026-01-04 21:47:42.999 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:47:42.999 | DEBUG    | Fragmento recebido: seq=3, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:47:42.999 | DEBUG    | Fragmento 4/6 armazenado (4 de 6 recebidos)
2026-01-04 21:47:42.999 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:47:43.087 | INFO     | [OP-20260104_214722-0025] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067147634b4e4f617968672f445975705336566f6269315549565972784e0a6b5258466b4e49746558616456426f6d324b326a397350446f307978766142 | ASCII: ...qGcKNOayhg/DYupS6Vobi1UIVYrxN.kRXFkNIteXadVBom2K2j9sPDo0yxvaB [TRUNCATED]
2026-01-04 21:47:43.088 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:47:43.088 | DEBUG    | Fragmento recebido: seq=4, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:47:43.088 | DEBUG    | Fragmento 5/6 armazenado (5 de 6 recebidos)
2026-01-04 21:47:43.088 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:47:43.175 | INFO     | [OP-20260104_214722-0026] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0abd363b15dbdac6e08e0493346d2cc715f43e6891e28fbe8021bc32cf9fbdb3d5 | ASCII: ...RTIFICATE-----..6;........4m,...>h.....!.2.....
2026-01-04 21:47:43.176 | DEBUG    |  AUTH indication recebida: 50 bytes
2026-01-04 21:47:43.176 | DEBUG    | Fragmento recebido: seq=5, total=6, payload=47 bytes, flags=0x02
2026-01-04 21:47:43.176 | DEBUG    | Fragmento 6/6 armazenado (6 de 6 recebidos)
2026-01-04 21:47:43.176 | INFO     |  Mensagem reconstruída: 947 bytes (6 fragmentos)
2026-01-04 21:47:43.176 | DEBUG    | FragmentReassembler resetado
2026-01-04 21:47:43.177 | DEBUG    |  AUTH mensagem completa: 947 bytes
2026-01-04 21:47:43.325 | DEBUG    | Resposta auth lida do buffer: 947 bytes
2026-01-04 21:47:43.326 | DEBUG    |  Recebido: AuthMessage(type=CHALLENGE, payload=944 bytes)
2026-01-04 21:47:43.326 | INFO     |  Challenge recebido - processando certificado + challenge...
2026-01-04 21:47:43.328 | INFO     |  Extraindo certificado do peer do payload...
2026-01-04 21:47:43.339 | DEBUG    |  Assinatura da CA válida
2026-01-04 21:47:43.340 | DEBUG    |  Certificado válido temporalmente (expira em 2036-01-02 00:44:34+00:00)
2026-01-04 21:47:43.343 | INFO     |  Certificado validado com sucesso
2026-01-04 21:47:43.344 | INFO     |  Certificado do peer validado!
2026-01-04 21:47:43.345 | INFO     |    Peer NID: 4e127252...
2026-01-04 21:47:43.345 | INFO     |    Peer tipo: SINK
2026-01-04 21:47:43.347 | DEBUG    |    Challenge: bd363b15dbdac6e08e0493346d2cc715...
2026-01-04 21:47:43.347 | INFO     |   Assinando dados:
2026-01-04 21:47:43.347 | INFO     |    Data: 32 bytes | bd363b15dbdac6e08e0493346d2cc715f43e6891e28fbe8021bc32cf9fbdb3d5...
2026-01-04 21:47:43.350 | INFO     |    Signature: 139 bytes | 308188024200c782cb8799762ab47eb52c22ede1f2485bb58891fcbd7be8263f...
2026-01-04 21:47:43.351 | INFO     |   Response gerada: 139 bytes
2026-01-04 21:47:43.352 | DEBUG    |    Estado: CHALLENGE_RECEIVED
2026-01-04 21:47:43.352 | DEBUG    |  Enviando resposta (142 bytes)
2026-01-04 21:47:43.352 | DEBUG    | Mensagem pequena (142 bytes), 1 fragmento
2026-01-04 21:47:43.352 | DEBUG    | Enviando mensagem auth: 142 bytes em 1 fragmento(s)
2026-01-04 21:47:43.353 | INFO     | [OP-20260104_214722-0027] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 145 bytes | Hex: 03000103008b308188024200c782cb8799762ab47eb52c22ede1f2485bb58891fcbd7be8263f2d4c5ecd54a02eb969a0f25b271953111c8ccabb064810db1d24 | ASCII: ......0...B......v*.~.,"...H[.....{.&?-L^.T...i..['.S......H...$ [TRUNCATED]
2026-01-04 21:47:43.444 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (145 bytes)
2026-01-04 21:47:43.445 | INFO     | [OP-20260104_214722-0028] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:47:43.445 | DEBUG    |   Fragmento 1/1 enviado
2026-01-04 21:47:43.446 | DEBUG    | Autenticação round 2/10
2026-01-04 21:47:43.446 | INFO     | [OP-20260104_214722-0029] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 21:47:43.446 | DEBUG    |  AUTH indication recebida: 6 bytes
2026-01-04 21:47:43.446 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 21:47:43.447 | INFO     | Iniciando recepção de 1 fragmentos
2026-01-04 21:47:43.447 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 21:47:43.447 | INFO     |  Mensagem reconstruída: 3 bytes (1 fragmentos)
2026-01-04 21:47:43.447 | DEBUG    | FragmentReassembler resetado
2026-01-04 21:47:43.447 | DEBUG    |  AUTH mensagem completa: 3 bytes
2026-01-04 21:47:43.946 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 21:47:43.947 | DEBUG    |  Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 21:47:43.947 | INFO     |  Peer confirmou autenticação bem sucedida!
2026-01-04 21:47:43.949 | INFO     |  Autenticação bem-sucedida!
2026-01-04 21:47:43.954 | DEBUG    |  Session key derivada: 32 bytes
2026-01-04 21:47:43.955 | INFO     |  Session key estabelecida
2026-01-04 21:47:43.956 | DEBUG    |  Session key configurada para porta uplink
2026-01-04 21:47:43.957 | INFO     |  Session key configurada no Router Daemon
2026-01-04 21:47:43.960 | INFO     |  Certificado do Sink armazenado para verificação de heartbeats
2026-01-04 21:47:43.962 | INFO     | DTLSChannel criado (client) com certificado node_0abd8260_cert.pem
2026-01-04 21:47:43.964 | INFO     | Estabelecendo canal DTLS...
2026-01-04 21:47:43.973 | INFO     |  Canal DTLS estabelecido com sucesso
2026-01-04 21:47:43.974 | INFO     |  Canal DTLS end-to-end estabelecido com Sink
2026-01-04 21:47:43.975 | INFO     |  Chave de encriptação end-to-end derivada (AES-256-GCM)
2026-01-04 21:47:43.976 | INFO     |  Chave de encriptação end-to-end derivada
2026-01-04 21:47:43.977 | DEBUG    |  Re-registando advertising após conexão uplink...
2026-01-04 21:47:43.982 | DEBUG    |  Advertisement desregistado
2026-01-04 21:47:44.283 | DEBUG    | RegisterAdvertisement chamado (tentativa 1, delay 0.3s)
2026-01-04 21:47:44.289 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 21:47:44.290 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 21:47:44.303 | INFO     | ✅ Advertising re-registado após conexão uplink (tentativa 1)
2026-01-04 21:47:44.527 | INFO     | [OP-20260104_214722-0030] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000056e6dbda6224e85b0a12a9f388d719157c2156b18171adf28c09e | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......nm.."N...*.8.q.W..k....(.. [TRUNCATED]
2026-01-04 21:47:44.528 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:47:44.528 | DEBUG    | Novo source 4e127252...: seq=5 (primeiro pacote)
2026-01-04 21:47:44.529 | DEBUG    | Learning new route: 4e127252... → uplink
2026-01-04 21:47:44.529 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:47:44.530 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:47:44.531 | DEBUG    | Novo source 4e127252...: seq=5 (primeiro pacote)
2026-01-04 21:47:44.531 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:47:44.532 | INFO     |  Verificando heartbeat:
2026-01-04 21:47:44.532 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:47:44.533 | INFO     |    Timestamp: 1767563264.450179
2026-01-04 21:47:44.535 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8001ccfbc
2026-01-04 21:47:44.536 | INFO     |  Verificando assinatura:
2026-01-04 21:47:44.537 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8001ccfbc...
2026-01-04 21:47:44.539 | INFO     |    Signature: 139 bytes | 308188024201e2e5180ccdca0cd0915e6c7068f077fef3654a49e54f4f48e39e...
2026-01-04 21:47:44.547 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:47:44.548 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:47:44.549 | DEBUG    |  Heartbeat recebido (seq=5, age=0.10s)
2026-01-04 21:47:49.505 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:47:49.506 | INFO     | [OP-20260104_214722-0031] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:47:49.565 | INFO     | [OP-20260104_214722-0032] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000065f1ebe36840ffaa01fe8cdf4f6739de3e0d0c6fe5de4caed9293 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{......._..6.........s......]..... [TRUNCATED]
2026-01-04 21:47:49.565 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:47:49.566 | DEBUG    | Source 4e127252...: seq=6 (novo highest, window: 2 seqs)
2026-01-04 21:47:49.566 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:47:49.566 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:47:49.566 | DEBUG    | Source 4e127252...: seq=6 (novo highest, window: 2 seqs)
2026-01-04 21:47:49.567 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 21:47:49.567 | INFO     |  Verificando heartbeat:
2026-01-04 21:47:49.567 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:47:49.567 | INFO     |    Timestamp: 1767563269.4548736
2026-01-04 21:47:49.568 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8015d1ca6
2026-01-04 21:47:49.568 | INFO     |  Verificando assinatura:
2026-01-04 21:47:49.568 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8015d1ca6...
2026-01-04 21:47:49.568 | INFO     |    Signature: 138 bytes | 3081870242013b85b573f492a1b08f17cd3745fda80788df08703a8ad0d96672...
2026-01-04 21:47:49.570 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:47:49.570 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:47:49.570 | DEBUG    |  Heartbeat recebido (seq=6, age=0.12s)
2026-01-04 21:47:54.526 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -62 dBm
2026-01-04 21:47:54.528 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -54 dBm
2026-01-04 21:47:54.528 | INFO     | Scan concluído: 2 dispositivos encontrados
2026-01-04 21:47:54.528 | INFO     | [OP-20260104_214722-0033] SCAN_RESULT | Devices_Found: 2
2026-01-04 21:47:54.529 | DEBUG    | [OP-20260104_214722-0033]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -62 dBm | Services: 1
2026-01-04 21:47:54.529 | DEBUG    | [OP-20260104_214722-0033]   Device_2: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -54 dBm | Services: 4
2026-01-04 21:47:54.529 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:47:54.530 | INFO     | [OP-20260104_214722-0034] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:47:54.560 | INFO     | [OP-20260104_214722-0035] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000007549e5f38234dc58a9226182f9d8ca8ef26717bde9ba6b4d957e0 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......T._8#M...&./....&q{.....W. [TRUNCATED]
2026-01-04 21:47:54.561 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:47:54.561 | DEBUG    | Source 4e127252...: seq=7 (novo highest, window: 3 seqs)
2026-01-04 21:47:54.562 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:47:54.562 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:47:54.563 | DEBUG    | Source 4e127252...: seq=7 (novo highest, window: 3 seqs)
2026-01-04 21:47:54.563 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:47:54.563 | INFO     |  Verificando heartbeat:
2026-01-04 21:47:54.563 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:47:54.564 | INFO     |    Timestamp: 1767563274.452252
2026-01-04 21:47:54.565 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8029cf1b2
2026-01-04 21:47:54.566 | INFO     |  Verificando assinatura:
2026-01-04 21:47:54.566 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8029cf1b2...
2026-01-04 21:47:54.567 | INFO     |    Signature: 139 bytes | 30818802420177431937dbea360ffad54baa25c579227a3f0741f8c8904a15de...
2026-01-04 21:47:54.570 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:47:54.570 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:47:54.570 | DEBUG    |  Heartbeat recebido (seq=7, age=0.12s)
2026-01-04 21:47:59.563 | INFO     | [OP-20260104_214722-0036] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000008f27194a3878c91a386fa988d80aac4b0936f7785e4199e577f77 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{........q...............ow....W.w [TRUNCATED]
2026-01-04 21:47:59.564 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:47:59.564 | DEBUG    | Source 4e127252...: seq=8 (novo highest, window: 4 seqs)
2026-01-04 21:47:59.565 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:47:59.565 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:47:59.566 | DEBUG    | Source 4e127252...: seq=8 (novo highest, window: 4 seqs)
2026-01-04 21:47:59.567 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:47:59.567 | INFO     |  Verificando heartbeat:
2026-01-04 21:47:59.568 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:47:59.571 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -54 dBm
2026-01-04 21:47:59.569 | INFO     |    Timestamp: 1767563279.454856
2026-01-04 21:47:59.572 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 21:47:59.573 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b803dd1c5c
2026-01-04 21:47:59.577 | INFO     | [OP-20260104_214722-0037] SCAN_RESULT | Devices_Found: 1
2026-01-04 21:47:59.581 | DEBUG    | [OP-20260104_214722-0037]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -54 dBm | Services: 4
2026-01-04 21:47:59.578 | INFO     |  Verificando assinatura:
2026-01-04 21:47:59.584 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b803dd1c5c...
2026-01-04 21:47:59.585 | INFO     |    Signature: 139 bytes | 30818802420124c5ebe129891f5bbbdd4593aa3bd1c2469224a49dbc8c4c7f3e...
2026-01-04 21:47:59.593 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:47:59.593 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:47:59.594 | DEBUG    |  Heartbeat recebido (seq=8, age=0.14s)
2026-01-04 21:48:04.551 | INFO     | [OP-20260104_214722-0038] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000091133955db42734db67d9b5b0bb2189898fa48610dd1591e233e8 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{........3.].'4.g....!..........3. [TRUNCATED]
2026-01-04 21:48:04.553 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:04.553 | DEBUG    | Source 4e127252...: seq=9 (novo highest, window: 5 seqs)
2026-01-04 21:48:04.554 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:04.554 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:04.555 | DEBUG    | Source 4e127252...: seq=9 (novo highest, window: 5 seqs)
2026-01-04 21:48:04.556 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:04.556 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:04.557 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:04.558 | INFO     |    Timestamp: 1767563284.4531949
2026-01-04 21:48:04.559 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8051d0125
2026-01-04 21:48:04.562 | INFO     |  Verificando assinatura:
2026-01-04 21:48:04.563 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8051d0125...
2026-01-04 21:48:04.564 | INFO     |    Signature: 139 bytes | 308188024201e79094facfb555e2b4e5f79e8f2d6f762613f7b7796d0f6b64de...
2026-01-04 21:48:04.569 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:04.572 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:04.572 | DEBUG    |  Heartbeat recebido (seq=9, age=0.12s)
2026-01-04 21:48:09.546 | INFO     | [OP-20260104_214722-0039] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000000a04ee263c3d461053a1c17e73f0c3a76c77fbeabc18cd85e0492c | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.........&<=F.S..~s...lw.......I, [TRUNCATED]
2026-01-04 21:48:09.547 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:09.548 | DEBUG    | Source 4e127252...: seq=10 (novo highest, window: 6 seqs)
2026-01-04 21:48:09.549 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:09.549 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:09.550 | DEBUG    | Source 4e127252...: seq=10 (novo highest, window: 6 seqs)
2026-01-04 21:48:09.550 | DEBUG    |  Verificando assinatura: sig_len=137, signature_raw_len=137
2026-01-04 21:48:09.551 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:09.552 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:09.552 | INFO     |    Timestamp: 1767563289.4546661
2026-01-04 21:48:09.553 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8065d1940
2026-01-04 21:48:09.554 | INFO     |  Verificando assinatura:
2026-01-04 21:48:09.556 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8065d1940...
2026-01-04 21:48:09.557 | INFO     |    Signature: 137 bytes | 308186024110648377b2281c69878b411a73ccedf08197db98b03fc5d0d1dd9a...
2026-01-04 21:48:09.562 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:09.567 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:09.567 | DEBUG    |  Heartbeat recebido (seq=10, age=0.11s)
2026-01-04 21:48:11.598 | INFO     | A conectar ao Sink 58:00:E3:66:74:7C...
2026-01-04 21:48:11.598 | DEBUG    | Peripheral 58:00:E3:66:74:7C não está em cache, fazendo scan rápido...
2026-01-04 21:48:13.609 | ERROR    | Dispositivo 58:00:E3:66:74:7C não encontrado mesmo após scan
2026-01-04 21:48:13.611 | ERROR    |  Falha ao conectar ao Sink
2026-01-04 21:48:13.725 | WARNING  |   Conexão perdida com Sink
2026-01-04 21:48:13.727 | DEBUG    | Nenhum downlink para desconectar
2026-01-04 21:48:14.542 | INFO     | [OP-20260104_214722-0040] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000000b2ec3e523d7bc620db60dc951f2e17f6c4ddd3eb0e2f1cec1d197 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{..........#..b....Q...lM.>....... [TRUNCATED]
2026-01-04 21:48:14.543 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:14.543 | DEBUG    | Source 4e127252...: seq=11 (novo highest, window: 7 seqs)
2026-01-04 21:48:14.544 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:14.544 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:14.545 | INFO     | Sink NID identificado: 4e127252...
2026-01-04 21:48:14.546 | DEBUG    | Source 4e127252...: seq=11 (novo highest, window: 7 seqs)
2026-01-04 21:48:14.547 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:14.547 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:14.548 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:14.549 | INFO     |    Timestamp: 1767563294.4548032
2026-01-04 21:48:14.550 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8079d1b7f
2026-01-04 21:48:14.551 | INFO     |  Verificando assinatura:
2026-01-04 21:48:14.552 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8079d1b7f...
2026-01-04 21:48:14.556 | INFO     |    Signature: 139 bytes | 3081880242012398d5ead47a386cf07c9065b27a7c0e962f6ffcdfb390ef7747...
2026-01-04 21:48:14.562 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:14.562 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:14.563 | DEBUG    |  Heartbeat recebido (seq=11, age=0.11s)
2026-01-04 21:48:19.537 | INFO     | [OP-20260104_214722-0041] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000000c418201596fe811c73cdab73d756b0e953b14662c67e15aeab48d | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......A..Yo...<..=uk..;.f,g.Z... [TRUNCATED]
2026-01-04 21:48:19.538 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:19.539 | DEBUG    | Source 4e127252...: seq=12 (novo highest, window: 8 seqs)
2026-01-04 21:48:19.540 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:19.540 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:19.541 | DEBUG    | Source 4e127252...: seq=12 (novo highest, window: 8 seqs)
2026-01-04 21:48:19.542 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:19.542 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:19.543 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:19.545 | INFO     |    Timestamp: 1767563299.4543588
2026-01-04 21:48:19.548 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b808dd1437
2026-01-04 21:48:19.549 | INFO     |  Verificando assinatura:
2026-01-04 21:48:19.552 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b808dd1437...
2026-01-04 21:48:19.556 | INFO     |    Signature: 139 bytes | 308188024201a6788b2534772b153e1fb07fcc5f6ef7f53cda584dc2a31294c1...
2026-01-04 21:48:19.560 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:19.560 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:19.561 | DEBUG    |  Heartbeat recebido (seq=12, age=0.11s)
2026-01-04 21:48:21.580 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:48:21.581 | INFO     | [OP-20260104_214722-0042] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:48:24.576 | INFO     | [OP-20260104_214722-0043] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000000df771c29ae177934854c85791e7969d8639974fd104144a2c2074 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{........q...w.HT.W.....9.O...J, t [TRUNCATED]
2026-01-04 21:48:24.578 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:24.578 | DEBUG    | Source 4e127252...: seq=13 (novo highest, window: 9 seqs)
2026-01-04 21:48:24.579 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:24.579 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:24.580 | DEBUG    | Source 4e127252...: seq=13 (novo highest, window: 9 seqs)
2026-01-04 21:48:24.581 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:24.581 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:24.582 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:24.583 | INFO     |    Timestamp: 1767563304.4547913
2026-01-04 21:48:24.584 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b80a1d1b4d
2026-01-04 21:48:24.586 | INFO     |  Verificando assinatura:
2026-01-04 21:48:24.588 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b80a1d1b4d...
2026-01-04 21:48:24.589 | INFO     |    Signature: 139 bytes | 30818802420199291e7d9c299c9bf07c2459ce4610bd9a725e24aeb865e88f28...
2026-01-04 21:48:24.594 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:24.595 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:24.596 | DEBUG    |  Heartbeat recebido (seq=13, age=0.14s)
2026-01-04 21:48:26.607 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -62 dBm
2026-01-04 21:48:26.614 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -52 dBm
2026-01-04 21:48:26.614 | INFO     | Scan concluído: 2 dispositivos encontrados
2026-01-04 21:48:26.615 | INFO     | [OP-20260104_214722-0044] SCAN_RESULT | Devices_Found: 2
2026-01-04 21:48:26.618 | DEBUG    | [OP-20260104_214722-0044]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -62 dBm | Services: 1
2026-01-04 21:48:26.619 | DEBUG    | [OP-20260104_214722-0044]   Device_2: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -52 dBm | Services: 4
2026-01-04 21:48:26.619 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:48:26.620 | INFO     | [OP-20260104_214722-0045] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:48:29.572 | INFO     | [OP-20260104_214722-0046] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000000eaefa651391b0d6ba9cce3eb02b0e447e9f9bbab94563a18ad028 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.........e.......>.+.D~....Ec...( [TRUNCATED]
2026-01-04 21:48:29.573 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:29.574 | DEBUG    | Source 4e127252...: seq=14 (novo highest, window: 10 seqs)
2026-01-04 21:48:29.574 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:29.575 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:29.576 | DEBUG    | Source 4e127252...: seq=14 (novo highest, window: 10 seqs)
2026-01-04 21:48:29.576 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:29.576 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:29.577 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:29.578 | INFO     |    Timestamp: 1767563309.4513972
2026-01-04 21:48:29.579 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b80b5ce3b1
2026-01-04 21:48:29.582 | INFO     |  Verificando assinatura:
2026-01-04 21:48:29.583 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b80b5ce3b1...
2026-01-04 21:48:29.584 | INFO     |    Signature: 139 bytes | 3081880242017ea5d43cf7430e2c1ad23646998e18a1aa0a2ffb907f8261169a...
2026-01-04 21:48:29.590 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:29.592 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:29.593 | DEBUG    |  Heartbeat recebido (seq=14, age=0.14s)
2026-01-04 21:48:31.647 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -56 dBm
2026-01-04 21:48:31.652 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -52 dBm
2026-01-04 21:48:31.653 | INFO     | Scan concluído: 2 dispositivos encontrados
2026-01-04 21:48:31.654 | INFO     | [OP-20260104_214722-0047] SCAN_RESULT | Devices_Found: 2
2026-01-04 21:48:31.656 | DEBUG    | [OP-20260104_214722-0047]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -56 dBm | Services: 1
2026-01-04 21:48:31.656 | DEBUG    | [OP-20260104_214722-0047]   Device_2: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -52 dBm | Services: 4
2026-01-04 21:48:34.522 | INFO     | [OP-20260104_214722-0048] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000000f6982f9e5dac6a15c373faa5c1286ea433b852f8053d5b87958a3 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......i......\7?.\...C;./.S..yX. [TRUNCATED]
2026-01-04 21:48:34.523 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:34.523 | DEBUG    | Source 4e127252...: seq=15 (novo highest, window: 11 seqs)
2026-01-04 21:48:34.524 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:34.524 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:34.525 | DEBUG    | Source 4e127252...: seq=15 (novo highest, window: 11 seqs)
2026-01-04 21:48:34.526 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:34.526 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:34.527 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:34.529 | INFO     |    Timestamp: 1767563314.4532013
2026-01-04 21:48:34.530 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b80c9d0140
2026-01-04 21:48:34.531 | INFO     |  Verificando assinatura:
2026-01-04 21:48:34.532 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b80c9d0140...
2026-01-04 21:48:34.533 | INFO     |    Signature: 139 bytes | 3081880242010911dc25d852005acd3910fbcafac1f405173f0d3650f7c238aa...
2026-01-04 21:48:34.538 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:34.541 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:34.541 | DEBUG    |  Heartbeat recebido (seq=15, age=0.09s)
2026-01-04 21:48:35.456 | INFO     | A conectar ao Sink E0:D3:62:D7:47:03...
2026-01-04 21:48:35.458 | INFO     | Já conectado a E0:D3:62:D7:47:03
2026-01-04 21:48:35.459 | INFO     |  Conectado ao Sink via GATT
2026-01-04 21:48:35.461 | DEBUG    | Descobertos 4 serviços
2026-01-04 21:48:35.462 | DEBUG    | Serviço 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 21:48:35.463 | INFO     |  Serviço IoT Network encontrado
2026-01-04 21:48:35.463 | DEBUG    |  Timestamp de heartbeat resetado para nova conexão
2026-01-04 21:48:35.463 | INFO     | A subscrever a notificações...
2026-01-04 21:48:35.465 | INFO     |  Subscrito a notificações: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:35.466 | INFO     | [OP-20260104_214722-0049] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:35.467 | INFO     |  Subscrito a NETWORK_PACKET
2026-01-04 21:48:35.468 | DEBUG    | [OP-20260104_214722-0050] READ_REQUEST | Remote: E0:D3:62:D7:47:03 | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:35.555 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 21:48:35.556 | INFO     | [OP-20260104_214722-0051] READ_RESPONSE | Remote: E0:D3:62:D7:47:03 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b17ff01 | ASCII: N.rR..LP...].>{...
2026-01-04 21:48:35.556 | INFO     |  Conectado ao Sink - hop_count=0
2026-01-04 21:48:35.557 | INFO     |  A iniciar autenticação com Sink...
2026-01-04 21:48:35.558 | DEBUG    |  A subscrever a AUTH characteristic...
2026-01-04 21:48:35.560 | INFO     |  Subscrito a notificações: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:35.560 | INFO     | [OP-20260104_214722-0052] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:35.561 | DEBUG    |  Subscrito a AUTH indications
2026-01-04 21:48:35.561 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 21:48:35.563 | INFO     |  Enviando certificado...
2026-01-04 21:48:35.564 | INFO     |  Iniciando autenticação - enviando certificado...
2026-01-04 21:48:35.565 | INFO     |    Certificado: 887 bytes
2026-01-04 21:48:35.566 | DEBUG    |    Estado: IDLE → CERT_SENT
2026-01-04 21:48:35.566 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 21:48:35.566 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 21:48:35.566 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 21:48:35.567 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 21:48:35.567 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 21:48:35.567 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 21:48:35.567 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 21:48:35.568 | INFO     | [OP-20260104_214722-0053] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 21:48:35.644 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:35.645 | INFO     | [OP-20260104_214722-0054] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:35.645 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 21:48:35.747 | INFO     | [OP-20260104_214722-0055] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 21:48:35.824 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:35.824 | INFO     | [OP-20260104_214722-0056] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:35.825 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 21:48:35.927 | INFO     | [OP-20260104_214722-0057] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 21:48:36.004 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:36.005 | INFO     | [OP-20260104_214722-0058] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:36.005 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 21:48:36.107 | INFO     | [OP-20260104_214722-0059] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 21:48:36.184 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:36.185 | INFO     | [OP-20260104_214722-0060] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:36.185 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 21:48:36.287 | INFO     | [OP-20260104_214722-0061] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 21:48:36.410 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 21:48:36.410 | INFO     | [OP-20260104_214722-0062] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:36.412 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 21:48:36.411 | INFO     | [OP-20260104_214722-0063] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943634443434164476741774942416749554847374f5a74 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUHG7OZt [TRUNCATED]
2026-01-04 21:48:36.413 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:48:36.414 | DEBUG    | Fragmento recebido: seq=0, total=6, payload=180 bytes, flags=0x01
2026-01-04 21:48:36.414 | INFO     | Iniciando recepção de 6 fragmentos
2026-01-04 21:48:36.415 | DEBUG    | Fragmento 1/6 armazenado (1 de 6 recebidos)
2026-01-04 21:48:36.415 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:48:36.500 | INFO     | [OP-20260104_214722-0064] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e44517a4e466f580a44544d324d4445774d6a41 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNDQzNFoX.DTM2MDEwMjA [TRUNCATED]
2026-01-04 21:48:36.501 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:48:36.501 | DEBUG    | Fragmento recebido: seq=1, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:48:36.501 | DEBUG    | Fragmento 2/6 armazenado (2 de 6 recebidos)
2026-01-04 21:48:36.501 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:48:36.512 | DEBUG    | Autenticação round 1/10
2026-01-04 21:48:36.592 | INFO     | [OP-20260104_214722-0065] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064d5463784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241416965 | ASCII: ...MTcxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAie [TRUNCATED]
2026-01-04 21:48:36.593 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:48:36.593 | DEBUG    | Fragmento recebido: seq=2, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:48:36.593 | DEBUG    | Fragmento 3/6 armazenado (3 de 6 recebidos)
2026-01-04 21:48:36.593 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:48:36.682 | INFO     | [OP-20260104_214722-0066] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000306744e5338774d764f4b683338524e0a68474a6a584d4c4678794e3148747658795a6a6b546f6e452f454b6d542f4f2f676e544b3246515946364d344d44 | ASCII: ...tNS8wMvOKh38RN.hGJjXMLFxyN1HtvXyZjkTonE/EKmT/O/gnTK2FQYF6M4MD [TRUNCATED]
2026-01-04 21:48:36.683 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:48:36.683 | DEBUG    | Fragmento recebido: seq=3, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:48:36.683 | DEBUG    | Fragmento 4/6 armazenado (4 de 6 recebidos)
2026-01-04 21:48:36.683 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:48:36.773 | INFO     | [OP-20260104_214722-0067] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067147634b4e4f617968672f445975705336566f6269315549565972784e0a6b5258466b4e49746558616456426f6d324b326a397350446f307978766142 | ASCII: ...qGcKNOayhg/DYupS6Vobi1UIVYrxN.kRXFkNIteXadVBom2K2j9sPDo0yxvaB [TRUNCATED]
2026-01-04 21:48:36.774 | DEBUG    |  AUTH indication recebida: 183 bytes
2026-01-04 21:48:36.774 | DEBUG    | Fragmento recebido: seq=4, total=6, payload=180 bytes, flags=0x00
2026-01-04 21:48:36.775 | DEBUG    | Fragmento 5/6 armazenado (5 de 6 recebidos)
2026-01-04 21:48:36.775 | DEBUG    |  Aguardando mais fragmentos AUTH...
2026-01-04 21:48:36.860 | INFO     | [OP-20260104_214722-0068] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0a20712ce9779b34cac12110519bb31e1812149284fddc9e3f0a89fe7ac38ed46b | ASCII: ...RTIFICATE-----. q,.w.4..!.Q...........?...z...k
2026-01-04 21:48:36.861 | DEBUG    |  AUTH indication recebida: 50 bytes
2026-01-04 21:48:36.861 | DEBUG    | Fragmento recebido: seq=5, total=6, payload=47 bytes, flags=0x02
2026-01-04 21:48:36.861 | DEBUG    | Fragmento 6/6 armazenado (6 de 6 recebidos)
2026-01-04 21:48:36.861 | INFO     |  Mensagem reconstruída: 947 bytes (6 fragmentos)
2026-01-04 21:48:36.862 | DEBUG    | FragmentReassembler resetado
2026-01-04 21:48:36.862 | DEBUG    |  AUTH mensagem completa: 947 bytes
2026-01-04 21:48:37.013 | DEBUG    | Resposta auth lida do buffer: 947 bytes
2026-01-04 21:48:37.014 | DEBUG    |  Recebido: AuthMessage(type=CHALLENGE, payload=944 bytes)
2026-01-04 21:48:37.014 | INFO     |  Challenge recebido - processando certificado + challenge...
2026-01-04 21:48:37.016 | INFO     |  Extraindo certificado do peer do payload...
2026-01-04 21:48:37.021 | DEBUG    |  Assinatura da CA válida
2026-01-04 21:48:37.021 | DEBUG    |  Certificado válido temporalmente (expira em 2036-01-02 00:44:34+00:00)
2026-01-04 21:48:37.024 | INFO     |  Certificado validado com sucesso
2026-01-04 21:48:37.026 | INFO     |  Certificado do peer validado!
2026-01-04 21:48:37.027 | INFO     |    Peer NID: 4e127252...
2026-01-04 21:48:37.028 | INFO     |    Peer tipo: SINK
2026-01-04 21:48:37.032 | DEBUG    |    Challenge: 20712ce9779b34cac12110519bb31e18...
2026-01-04 21:48:37.033 | INFO     |   Assinando dados:
2026-01-04 21:48:37.033 | INFO     |    Data: 32 bytes | 20712ce9779b34cac12110519bb31e1812149284fddc9e3f0a89fe7ac38ed46b...
2026-01-04 21:48:37.034 | INFO     |    Signature: 137 bytes | 3081860241626d293ced9d3f66f6069339fefa221d07064fbecfb74e1b2fe98c...
2026-01-04 21:48:37.038 | INFO     |   Response gerada: 137 bytes
2026-01-04 21:48:37.040 | DEBUG    |    Estado: CHALLENGE_RECEIVED
2026-01-04 21:48:37.040 | DEBUG    |  Enviando resposta (140 bytes)
2026-01-04 21:48:37.041 | DEBUG    | Mensagem pequena (140 bytes), 1 fragmento
2026-01-04 21:48:37.042 | DEBUG    | Enviando mensagem auth: 140 bytes em 1 fragmento(s)
2026-01-04 21:48:37.044 | INFO     | [OP-20260104_214722-0069] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 143 bytes | Hex: 0300010300893081860241626d293ced9d3f66f6069339fefa221d07064fbecfb74e1b2fe98c74123fa223685697287f807236e04253e6cad226f2a1db8d6d11 | ASCII: ......0...Abm)<..?f...9.."...O...N./..t.?.#hV.(..r6.BS...&....m. [TRUNCATED]
2026-01-04 21:48:37.129 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (143 bytes)
2026-01-04 21:48:37.130 | INFO     | [OP-20260104_214722-0070] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:37.130 | DEBUG    |   Fragmento 1/1 enviado
2026-01-04 21:48:37.131 | DEBUG    | Autenticação round 2/10
2026-01-04 21:48:37.131 | INFO     | [OP-20260104_214722-0071] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 21:48:37.131 | DEBUG    |  AUTH indication recebida: 6 bytes
2026-01-04 21:48:37.132 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 21:48:37.132 | INFO     | Iniciando recepção de 1 fragmentos
2026-01-04 21:48:37.132 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 21:48:37.132 | INFO     |  Mensagem reconstruída: 3 bytes (1 fragmentos)
2026-01-04 21:48:37.132 | DEBUG    | FragmentReassembler resetado
2026-01-04 21:48:37.133 | DEBUG    |  AUTH mensagem completa: 3 bytes
2026-01-04 21:48:37.631 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 21:48:37.631 | DEBUG    |  Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 21:48:37.632 | INFO     |  Peer confirmou autenticação bem sucedida!
2026-01-04 21:48:37.633 | INFO     |  Autenticação bem-sucedida!
2026-01-04 21:48:37.636 | DEBUG    |  Session key derivada: 32 bytes
2026-01-04 21:48:37.636 | INFO     |  Session key estabelecida
2026-01-04 21:48:37.637 | DEBUG    |  Session key configurada para porta uplink
2026-01-04 21:48:37.637 | INFO     |  Session key configurada no Router Daemon
2026-01-04 21:48:37.638 | INFO     |  Certificado do Sink armazenado para verificação de heartbeats
2026-01-04 21:48:37.638 | INFO     | DTLSChannel criado (client) com certificado node_0abd8260_cert.pem
2026-01-04 21:48:37.639 | INFO     | Estabelecendo canal DTLS...
2026-01-04 21:48:37.642 | INFO     |  Canal DTLS estabelecido com sucesso
2026-01-04 21:48:37.642 | INFO     |  Canal DTLS end-to-end estabelecido com Sink
2026-01-04 21:48:37.643 | INFO     |  Chave de encriptação end-to-end derivada (AES-256-GCM)
2026-01-04 21:48:37.645 | INFO     |  Chave de encriptação end-to-end derivada
2026-01-04 21:48:37.645 | DEBUG    |  Re-registando advertising após conexão uplink...
2026-01-04 21:48:37.653 | DEBUG    |  Advertisement desregistado
2026-01-04 21:48:37.954 | DEBUG    | RegisterAdvertisement chamado (tentativa 1, delay 0.3s)
2026-01-04 21:48:37.958 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 21:48:37.958 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 21:48:37.966 | INFO     | ✅ Advertising re-registado após conexão uplink (tentativa 1)
2026-01-04 21:48:39.516 | INFO     | [OP-20260104_214722-0072] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000010da59b135ec37cea5ff99135ba1a24d6de2cd9046a09cc0731ac4 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{........Y.5.7.....[..Mm...F...s.. [TRUNCATED]
2026-01-04 21:48:39.517 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:39.517 | DEBUG    | Source 4e127252...: seq=16 (novo highest, window: 12 seqs)
2026-01-04 21:48:39.517 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:39.517 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:39.518 | DEBUG    | Source 4e127252...: seq=16 (novo highest, window: 12 seqs)
2026-01-04 21:48:39.518 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 21:48:39.518 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:39.519 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:39.520 | INFO     |    Timestamp: 1767563319.4521925
2026-01-04 21:48:39.520 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b80ddcf0b9
2026-01-04 21:48:39.520 | INFO     |  Verificando assinatura:
2026-01-04 21:48:39.520 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b80ddcf0b9...
2026-01-04 21:48:39.521 | INFO     |    Signature: 138 bytes | 308187024135f3f3f0fddb13fb63c36f1e1c31e6c14213b1447503822560a375...
2026-01-04 21:48:39.525 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:39.526 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:39.526 | DEBUG    |  Heartbeat recebido (seq=16, age=0.07s)
2026-01-04 21:48:40.940 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:48:40.942 | INFO     | [OP-20260104_214722-0073] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:48:44.645 | INFO     | [OP-20260104_214722-0074] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000011cfa60b6228af3f1b708f0541e4a6e6454b3e11778671e0edf287 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{..........b(.?.p..A...EK>.w.q.... [TRUNCATED]
2026-01-04 21:48:44.645 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:44.646 | DEBUG    | Source 4e127252...: seq=17 (novo highest, window: 13 seqs)
2026-01-04 21:48:44.646 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:44.646 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:44.646 | DEBUG    | Source 4e127252...: seq=17 (novo highest, window: 13 seqs)
2026-01-04 21:48:44.646 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 21:48:44.646 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:44.647 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:44.647 | INFO     |    Timestamp: 1767563324.4548883
2026-01-04 21:48:44.647 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b80f1d1ce4
2026-01-04 21:48:44.648 | INFO     |  Verificando assinatura:
2026-01-04 21:48:44.648 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b80f1d1ce4...
2026-01-04 21:48:44.648 | INFO     |    Signature: 138 bytes | 308187024200e5638b76b3e24018b56fd4abb00f4295276a3aa771343c4254b0...
2026-01-04 21:48:44.649 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:44.650 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:44.650 | DEBUG    |  Heartbeat recebido (seq=17, age=0.20s)
2026-01-04 21:48:45.965 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -54 dBm
2026-01-04 21:48:45.971 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -52 dBm
2026-01-04 21:48:45.971 | INFO     | Scan concluído: 2 dispositivos encontrados
2026-01-04 21:48:45.974 | INFO     | [OP-20260104_214722-0075] SCAN_RESULT | Devices_Found: 2
2026-01-04 21:48:45.975 | DEBUG    | [OP-20260104_214722-0075]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -54 dBm | Services: 1
2026-01-04 21:48:45.975 | DEBUG    | [OP-20260104_214722-0075]   Device_2: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -52 dBm | Services: 4
2026-01-04 21:48:45.976 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 21:48:45.977 | INFO     | [OP-20260104_214722-0076] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 21:48:49.552 | INFO     | [OP-20260104_214722-0077] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000012f1b01eaf6f25abd00d5d438158891deed58c294ba18d41da6eef | ASCII: N.rR..LP...].>{.N.rR..LP...].>{...........o%...]C.X.....)K..A.n. [TRUNCATED]
2026-01-04 21:48:49.553 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:49.554 | DEBUG    | Source 4e127252...: seq=18 (novo highest, window: 14 seqs)
2026-01-04 21:48:49.554 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:49.555 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:49.556 | DEBUG    | Source 4e127252...: seq=18 (novo highest, window: 14 seqs)
2026-01-04 21:48:49.556 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:49.557 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:49.557 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:49.559 | INFO     |    Timestamp: 1767563329.454329
2026-01-04 21:48:49.560 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8105d13ba
2026-01-04 21:48:49.562 | INFO     |  Verificando assinatura:
2026-01-04 21:48:49.564 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8105d13ba...
2026-01-04 21:48:49.565 | INFO     |    Signature: 139 bytes | 308188024201ac8b6071ebd7c433a5ecc135b3bb5ab4c9e1acc3cc8124af6003...
2026-01-04 21:48:49.571 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:49.574 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:49.574 | DEBUG    |  Heartbeat recebido (seq=18, age=0.12s)
2026-01-04 21:48:51.006 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -62 dBm
2026-01-04 21:48:51.011 | INFO     | Scan concluído: 1 dispositivos encontrados
2026-01-04 21:48:51.012 | INFO     | [OP-20260104_214722-0078] SCAN_RESULT | Devices_Found: 1
2026-01-04 21:48:51.013 | DEBUG    | [OP-20260104_214722-0078]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -62 dBm | Services: 1
2026-01-04 21:48:54.547 | INFO     | [OP-20260104_214722-0079] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000136367810adade3eabfa46771c78bc96e92c71683ec9370a6387bc | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......cg....>..Fw.x...,qh>.7.c.. [TRUNCATED]
2026-01-04 21:48:54.548 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:54.549 | DEBUG    | Source 4e127252...: seq=19 (novo highest, window: 15 seqs)
2026-01-04 21:48:54.549 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:54.550 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:54.551 | DEBUG    | Source 4e127252...: seq=19 (novo highest, window: 15 seqs)
2026-01-04 21:48:54.551 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:54.552 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:54.553 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:54.554 | INFO     |    Timestamp: 1767563334.4503636
2026-01-04 21:48:54.555 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8119cd2c2
2026-01-04 21:48:54.556 | INFO     |  Verificando assinatura:
2026-01-04 21:48:54.558 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8119cd2c2...
2026-01-04 21:48:54.560 | INFO     |    Signature: 139 bytes | 308188024201424387a68a34485eed2f0e2dfd479deef5b1737cfa3416270139...
2026-01-04 21:48:54.568 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:54.570 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:54.571 | DEBUG    |  Heartbeat recebido (seq=19, age=0.12s)
2026-01-04 21:48:54.626 | INFO     | A conectar ao Sink 58:00:E3:66:74:7C...
2026-01-04 21:48:54.627 | DEBUG    | BLEConnection criada para 58:00:E3:66:74:7C
2026-01-04 21:48:54.627 | INFO     | A conectar a 58:00:E3:66:74:7C...
2026-01-04 21:48:54.628 | INFO     | [OP-20260104_214722-0080] CONNECT_ATTEMPT | Local: E0:D3:62:D6:EE:A0 | Remote: 58:00:E3:66:74:7C
2026-01-04 21:48:58.130 | INFO     |  Conectado a 58:00:E3:66:74:7C
2026-01-04 21:48:58.130 | INFO     | [OP-20260104_214722-0081] CONNECT_SUCCESS | Remote: 58:00:E3:66:74:7C | Time: 3500.21ms
2026-01-04 21:48:58.131 | DEBUG    |  Conexão estabelecida. Operações GATT usarão D-Bus se necessário.
2026-01-04 21:48:58.131 | INFO     |  Conectado ao Sink via GATT
2026-01-04 21:48:58.132 | DEBUG    | Descobertos 3 serviços
2026-01-04 21:48:58.133 | DEBUG    | Serviço 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 21:48:58.133 | INFO     |  Serviço IoT Network encontrado
2026-01-04 21:48:58.134 | DEBUG    |  Timestamp de heartbeat resetado para nova conexão
2026-01-04 21:48:58.134 | INFO     | A subscrever a notificações...
2026-01-04 21:48:58.585 | INFO     |  Subscrito a notificações: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:58.587 | INFO     | [OP-20260104_214722-0082] SUBSCRIBE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:58.588 | INFO     |  Subscrito a NETWORK_PACKET
2026-01-04 21:48:58.591 | DEBUG    | [OP-20260104_214722-0083] READ_REQUEST | Remote: 58:00:E3:66:74:7C | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:58.674 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 21:48:58.675 | INFO     | [OP-20260104_214722-0084] READ_RESPONSE | Remote: 58:00:E3:66:74:7C | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: a40543face324331ad8d4798037bfbc7ff00 | ASCII: ..C..2C1..G..{....
2026-01-04 21:48:58.676 | INFO     |  Conectado ao Sink - hop_count=0
2026-01-04 21:48:58.676 | INFO     |  A iniciar autenticação com Sink...
2026-01-04 21:48:58.677 | DEBUG    |  A subscrever a AUTH characteristic...
2026-01-04 21:48:58.764 | INFO     |  Subscrito a notificações: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:58.765 | INFO     | [OP-20260104_214722-0085] SUBSCRIBE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:58.766 | DEBUG    |  Subscrito a AUTH indications
2026-01-04 21:48:58.766 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 21:48:58.767 | INFO     |  Enviando certificado...
2026-01-04 21:48:58.769 | INFO     |  Iniciando autenticação - enviando certificado...
2026-01-04 21:48:58.770 | INFO     |    Certificado: 887 bytes
2026-01-04 21:48:58.771 | DEBUG    |    Estado: IDLE → CERT_SENT
2026-01-04 21:48:58.771 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 21:48:58.774 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 21:48:58.775 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 21:48:58.776 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 21:48:58.777 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 21:48:58.777 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 21:48:58.778 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 21:48:58.782 | INFO     | [OP-20260104_214722-0086] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 21:48:58.853 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:58.854 | INFO     | [OP-20260104_214722-0087] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:58.855 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 21:48:58.956 | INFO     | [OP-20260104_214722-0088] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 21:48:59.033 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:59.034 | INFO     | [OP-20260104_214722-0089] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:59.034 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 21:48:59.136 | INFO     | [OP-20260104_214722-0090] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 21:48:59.213 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:59.214 | INFO     | [OP-20260104_214722-0091] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:59.214 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 21:48:59.316 | INFO     | [OP-20260104_214722-0092] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 21:48:59.393 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 21:48:59.394 | INFO     | [OP-20260104_214722-0093] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:59.394 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 21:48:59.496 | INFO     | [OP-20260104_214722-0094] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 21:48:59.573 | DEBUG    |  Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 21:48:59.573 | INFO     | [OP-20260104_214722-0095] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 21:48:59.574 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 21:48:59.574 | INFO     | [OP-20260104_214722-0096] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b1702010000001477025236d71e88fa997e71690da51c8db74a14f7df03184a5128 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......w.R6.....~qi.....J.....JQ( [TRUNCATED]
2026-01-04 21:48:59.575 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:48:59.575 | DEBUG    | Source 4e127252...: seq=20 (novo highest, window: 16 seqs)
2026-01-04 21:48:59.575 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:48:59.575 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:48:59.576 | DEBUG    | Source 4e127252...: seq=20 (novo highest, window: 16 seqs)
2026-01-04 21:48:59.576 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:48:59.576 | INFO     |  Verificando heartbeat:
2026-01-04 21:48:59.576 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:48:59.576 | INFO     |    Timestamp: 1767563339.4548042
2026-01-04 21:48:59.577 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b812dd1b83
2026-01-04 21:48:59.577 | INFO     |  Verificando assinatura:
2026-01-04 21:48:59.578 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b812dd1b83...
2026-01-04 21:48:59.578 | INFO     |    Signature: 139 bytes | 308188024201dd686a1f06aeeca15cf7301531350db88db74fc9b23707dc9c1c...
2026-01-04 21:48:59.580 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:48:59.580 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:48:59.581 | DEBUG    |  Heartbeat recebido (seq=20, age=0.13s)
2026-01-04 21:48:59.581 | INFO     | [OP-20260104_214722-0097] NOTIFICATION | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 21:48:59.582 | DEBUG    |  AUTH indication recebida: 6 bytes
2026-01-04 21:48:59.583 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 21:48:59.583 | INFO     | Iniciando recepção de 1 fragmentos
2026-01-04 21:48:59.584 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 21:48:59.584 | INFO     |  Mensagem reconstruída: 3 bytes (1 fragmentos)
2026-01-04 21:48:59.584 | DEBUG    | FragmentReassembler resetado
2026-01-04 21:48:59.584 | DEBUG    |  AUTH mensagem completa: 3 bytes
2026-01-04 21:48:59.674 | DEBUG    | Autenticação round 1/10
2026-01-04 21:49:00.175 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 21:49:00.176 | DEBUG    |  Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 21:49:00.176 | INFO     |  Peer confirmou autenticação bem sucedida!
2026-01-04 21:49:00.177 | INFO     |  Autenticação bem-sucedida!
2026-01-04 21:49:00.179 | ERROR    | Certificados não disponíveis para derivar session key
2026-01-04 21:49:00.181 | INFO     | DTLSChannel criado (client) com certificado node_0abd8260_cert.pem
2026-01-04 21:49:00.182 | INFO     | Estabelecendo canal DTLS...
2026-01-04 21:49:00.192 | INFO     |  Canal DTLS estabelecido com sucesso
2026-01-04 21:49:00.193 | INFO     |  Canal DTLS end-to-end estabelecido com Sink
2026-01-04 21:49:00.193 | DEBUG    |  Re-registando advertising após conexão uplink...
2026-01-04 21:49:00.197 | DEBUG    |  Advertisement desregistado
2026-01-04 21:49:00.499 | DEBUG    | RegisterAdvertisement chamado (tentativa 1, delay 0.3s)
2026-01-04 21:49:00.505 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 21:49:00.505 | INFO     |  Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 21:49:00.516 | INFO     | ✅ Advertising re-registado após conexão uplink (tentativa 1)
2026-01-04 21:49:04.537 | INFO     | [OP-20260104_214722-0098] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000159bbb6e701ded3bd126f8dff2deb3be1de3bd38fd95a8930d4465 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.........np..;.&.........8.....De [TRUNCATED]
2026-01-04 21:49:04.539 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:49:04.539 | DEBUG    | Source 4e127252...: seq=21 (novo highest, window: 17 seqs)
2026-01-04 21:49:04.540 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:49:04.540 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:49:04.542 | INFO     | Sink NID identificado: 4e127252...
2026-01-04 21:49:04.545 | DEBUG    | Source 4e127252...: seq=21 (novo highest, window: 17 seqs)
2026-01-04 21:49:04.546 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:49:04.546 | INFO     |  Verificando heartbeat:
2026-01-04 21:49:04.550 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:49:04.552 | INFO     |    Timestamp: 1767563344.4548182
2026-01-04 21:49:04.553 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8141d1bbe
2026-01-04 21:49:04.554 | INFO     |  Verificando assinatura:
2026-01-04 21:49:04.555 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8141d1bbe...
2026-01-04 21:49:04.556 | INFO     |    Signature: 139 bytes | 308188024200a894590d94c0fd6f6ddeedb099e54329e1ff0d17d9b6a8b9e70a...
2026-01-04 21:49:04.561 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:49:04.562 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:49:04.563 | DEBUG    |  Heartbeat recebido (seq=21, age=0.11s)
2026-01-04 21:49:09.531 | INFO     | [OP-20260104_214722-0099] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000016364c9b0e5d3a265739780d0ae35cdb2b469b207968b435abe5b2 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......6L..]:&W9x...\.+F. yh.5... [TRUNCATED]
2026-01-04 21:49:09.533 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:49:09.534 | DEBUG    | Source 4e127252...: seq=22 (novo highest, window: 18 seqs)
2026-01-04 21:49:09.534 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:49:09.535 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:49:09.536 | DEBUG    | Source 4e127252...: seq=22 (novo highest, window: 18 seqs)
2026-01-04 21:49:09.536 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:49:09.536 | INFO     |  Verificando heartbeat:
2026-01-04 21:49:09.537 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:49:09.543 | INFO     |    Timestamp: 1767563349.4548016
2026-01-04 21:49:09.544 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8155d1b78
2026-01-04 21:49:09.545 | INFO     |  Verificando assinatura:
2026-01-04 21:49:09.546 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8155d1b78...
2026-01-04 21:49:09.547 | INFO     |    Signature: 139 bytes | 30818802420124f5dc91407e1a377f258b1fcbc4b063cc6ab55b74fd90d827d9...
2026-01-04 21:49:09.553 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:49:09.555 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:49:09.555 | DEBUG    |  Heartbeat recebido (seq=22, age=0.10s)
2026-01-04 21:49:14.526 | INFO     | [OP-20260104_214722-0100] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000173fbb926369958e0711818c1652599f75802a92839ba1f4efab10 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......?..ci.......RY.u.*........ [TRUNCATED]
2026-01-04 21:49:14.528 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:49:14.528 | DEBUG    | Source 4e127252...: seq=23 (novo highest, window: 19 seqs)
2026-01-04 21:49:14.529 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:49:14.529 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:49:14.530 | DEBUG    | Source 4e127252...: seq=23 (novo highest, window: 19 seqs)
2026-01-04 21:49:14.530 | DEBUG    |  Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 21:49:14.530 | INFO     |  Verificando heartbeat:
2026-01-04 21:49:14.531 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:49:14.531 | INFO     |    Timestamp: 1767563354.4548442
2026-01-04 21:49:14.531 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b8169d1c2b
2026-01-04 21:49:14.532 | INFO     |  Verificando assinatura:
2026-01-04 21:49:14.536 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b8169d1c2b...
2026-01-04 21:49:14.537 | INFO     |    Signature: 139 bytes | 308188024201cb2de92af34e0fb507a3a386ebfe8b65c3ac0316538ba044af46...
2026-01-04 21:49:14.542 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:49:14.543 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:49:14.543 | DEBUG    |  Heartbeat recebido (seq=23, age=0.09s)
2026-01-04 21:49:19.521 | INFO     | [OP-20260104_214722-0101] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000018c358b6463acc220aee0a8de1cf0dc0cb638e6d1f3dbb9a9ec175 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{........X.F:.".........c.m.=....u [TRUNCATED]
2026-01-04 21:49:19.522 | DEBUG    |  Pacote recebido de uplink: 4e127252... → 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 21:49:19.522 | DEBUG    | Source 4e127252...: seq=24 (novo highest, window: 20 seqs)
2026-01-04 21:49:19.522 | DEBUG    |  Aprendido: 4e127252... → uplink
2026-01-04 21:49:19.522 | INFO     |  Entregando localmente: 4e127252... → 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 21:49:19.523 | DEBUG    | Source 4e127252...: seq=24 (novo highest, window: 20 seqs)
2026-01-04 21:49:19.523 | DEBUG    |  Verificando assinatura: sig_len=138, signature_raw_len=138
2026-01-04 21:49:19.523 | INFO     |  Verificando heartbeat:
2026-01-04 21:49:19.524 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 21:49:19.525 | INFO     |    Timestamp: 1767563359.4548085
2026-01-04 21:49:19.525 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da56b817dd1b95
2026-01-04 21:49:19.526 | INFO     |  Verificando assinatura:
2026-01-04 21:49:19.526 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da56b817dd1b95...
2026-01-04 21:49:19.527 | INFO     |    Signature: 138 bytes | 308187024127381cc4c7c98b787ad821b3eeba9c6188869612d01351d3e4bb86...
2026-01-04 21:49:19.529 | INFO     |  Assinatura verificada com sucesso!
2026-01-04 21:49:19.530 | DEBUG    |  Assinatura de heartbeat válida
2026-01-04 21:49:19.530 | DEBUG    |  Heartbeat recebido (seq=24, age=0.08s)
2026-01-04 21:49:21.818 | INFO     | A parar Node...
2026-01-04 21:49:21.819 | INFO     | A parar GATT Server...
2026-01-04 21:49:21.821 | INFO     |  GATT Server parado
2026-01-04 21:49:23.787 | INFO     | Desconectado de 58:00:E3:66:74:7C
2026-01-04 21:49:23.789 | INFO     | [OP-20260104_214722-0102] DISCONNECT | Remote: 58:00:E3:66:74:7C | Reason: normal
