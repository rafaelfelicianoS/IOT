2025-12-31 01:35:53.192 | INFO     | __main__:__init__:82 | A carregar certificados...
2025-12-31 01:35:53.194 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para c5c55ab2...
2025-12-31 01:35:53.195 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafael/repos/iot/certs
2025-12-31 01:35:53.195 | INFO     | __main__:__init__:112 | ‚úÖ Certificados carregados com sucesso
2025-12-31 01:35:53.195 | INFO     | __main__:__init__:120 | Sink NID: c5c55ab2...
2025-12-31 01:35:53.195 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2025-12-31 01:35:53.195 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2025-12-31 01:35:53.195 | INFO     | __main__:__init__:143 | Sink Device inicializado (adapter=hci0)
2025-12-31 01:35:53.195 | INFO     | __main__:start:388 | ============================================================
2025-12-31 01:35:53.195 | INFO     | __main__:start:389 |   A iniciar Sink Device
2025-12-31 01:35:53.195 | INFO     | __main__:start:390 | ============================================================
2025-12-31 01:35:53.195 | INFO     | __main__:setup_gatt_server:147 | A configurar GATT Server...
2025-12-31 01:35:53.196 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2025-12-31 01:35:53.196 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2025-12-31 01:35:53.197 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2025-12-31 01:35:53.197 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2025-12-31 01:35:53.197 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=c5c55ab2..., type=sink
2025-12-31 01:35:53.197 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2025-12-31 01:35:53.197 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2025-12-31 01:35:53.197 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2025-12-31 01:35:53.197 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2025-12-31 01:35:53.198 | INFO     | __main__:setup_gatt_server:185 | ‚úÖ GATT Server configurado
2025-12-31 01:35:53.198 | INFO     | __main__:start:397 | A registar GATT application no adaptador hci0...
2025-12-31 01:35:53.198 | INFO     | __main__:setup_advertising:189 | A configurar BLE Advertising...
2025-12-31 01:35:53.198 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2025-12-31 01:35:53.198 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2025-12-31 01:35:53.199 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2025-12-31 01:35:53.199 | INFO     | __main__:setup_advertising:200 | ‚úÖ BLE Advertising configurado
2025-12-31 01:35:53.199 | INFO     | __main__:start:413 | A registar advertisement no adaptador hci0...
2025-12-31 01:35:53.199 | INFO     | __main__:start_heartbeat_service:354 | üíì A iniciar servi√ßo de heartbeat...
2025-12-31 01:35:53.200 | INFO     | __main__:start_heartbeat_service:384 | ‚úÖ Servi√ßo de heartbeat iniciado
2025-12-31 01:35:53.200 | INFO     | __main__:start:430 | ‚úÖ Sink Device iniciado - a aguardar conex√µes...
2025-12-31 01:35:53.205 | INFO     | __main__:<lambda>:405 | ‚úÖ GATT application registada!
2025-12-31 01:35:53.205 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2025-12-31 01:35:53.308 | INFO     | __main__:<lambda>:419 | ‚úÖ Advertisement registado!
2025-12-31 01:36:09.637 | INFO     | common.ble.gatt_services:StartNotify:120 | Cliente :1.1891 subscreveu notifica√ß√µes de pacotes
2025-12-31 01:36:09.888 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 5 fragmentos
2025-12-31 01:36:10.841 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 890 bytes (5 fragmentos)
2025-12-31 01:36:10.842 | INFO     | common.ble.gatt_services:WriteValue:455 | Mensagem completa recebida de :1.1891: 890 bytes
2025-12-31 01:36:10.842 | INFO     | __main__:_on_auth_message:261 | üîê Mensagem de autentica√ß√£o recebida de :1.1891: 890 bytes
2025-12-31 01:36:10.843 | INFO     | common.security.auth_handler:handle_auth_message:89 | üì® Mensagem de autentica√ß√£o de :1.1891: 890 bytes
2025-12-31 01:36:10.844 | INFO     | common.security.auth_handler:get_or_create_session:71 | Nova sess√£o de autentica√ß√£o para cliente: :1.1891
2025-12-31 01:36:10.844 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para c5c55ab2...
2025-12-31 01:36:10.845 | INFO     | common.security.authentication:handle_cert_offer:163 | üìú Certificado do peer recebido - validando...
2025-12-31 01:36:10.847 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2025-12-31 01:36:10.848 | INFO     | common.security.authentication:handle_cert_offer:181 | ‚úÖ Certificado v√°lido!
2025-12-31 01:36:10.848 | INFO     | common.security.authentication:handle_cert_offer:182 |    Peer NID: 53a84472...
2025-12-31 01:36:10.848 | INFO     | common.security.authentication:handle_cert_offer:183 |    Peer tipo: NODE
2025-12-31 01:36:10.849 | INFO     | common.security.authentication:handle_cert_offer:192 | üé≤ Enviando challenge: d0ad837562ba0be25994d49ba45c80cf...
2025-12-31 01:36:17.038 | INFO     | common.ble.gatt_services:StopNotify:137 | Cliente :1.1891 cancelou subscri√ß√£o de pacotes
2025-12-31 01:46:02.136 | INFO     | __main__:signal_handler:524 | 
Sinal 2 recebido, a parar...
2025-12-31 01:46:02.136 | INFO     | __main__:stop:442 | A parar Sink Device...
2025-12-31 01:46:02.137 | INFO     | __main__:stop:454 | ‚úÖ Sink Device parado
2026-01-02 02:20:27.617 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 02:20:27.622 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 02:20:27.623 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 02:20:27.623 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 02:20:27.624 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 02:20:27.624 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 02:20:27.625 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 02:20:27.649 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_022027.log
2026-01-02 02:20:27.649 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:20:27.650 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 02:20:27.650 | INFO     | __main__:__init__:160 | IoT Node inicializado (adapter=hci0)
2026-01-02 02:20:27.651 | INFO     | __main__:run:738 | ============================================================
2026-01-02 02:20:27.652 | INFO     | __main__:run:739 |   A iniciar IoT Node (dual-mode)
2026-01-02 02:20:27.653 | INFO     | __main__:run:740 | ============================================================
2026-01-02 02:20:27.653 | INFO     | __main__:setup_gatt_server:164 | A configurar GATT Server...
2026-01-02 02:20:27.658 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 02:20:27.660 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:20:27.661 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 02:20:27.664 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 02:20:27.668 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:20:27.669 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 02:20:27.669 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 02:20:27.671 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:20:27.672 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:20:27.674 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:20:27.675 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:20:27.676 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:20:27.676 | INFO     | __main__:setup_gatt_server:207 | ‚úÖ GATT Server configurado
2026-01-02 02:20:27.677 | INFO     | __main__:start_gatt_server:211 | A iniciar GATT Server...
2026-01-02 02:20:27.680 | INFO     | __main__:start_gatt_server:240 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:20:27.681 | INFO     | __main__:run:748 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:20:27.681 | INFO     | __main__:discover_sink:312 | üîç A procurar Sink...
2026-01-02 02:20:27.681 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:20:27.682 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022027-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:20:27.756 | INFO     | __main__:<lambda>:223 | ‚úÖ GATT application registada!
2026-01-02 02:20:27.757 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:20:27.868 | INFO     | __main__:<lambda>:231 | ‚úÖ Advertisement registado!
2026-01-02 02:20:32.866 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:20:32.867 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022027-0002] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:20:32.868 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:20:32.869 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:20:32.870 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022027-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:20:37.979 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:20:37.979 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022027-0004] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:20:37.980 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:20:37.980 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:20:37.980 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022027-0005] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:20:43.091 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:20:43.093 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022027-0006] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:20:43.095 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:20:43.097 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:20:43.099 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022027-0007] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:20:48.208 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:20:48.210 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022027-0008] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:20:48.212 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:20:48.213 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:20:48.214 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022027-0009] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:20:53.321 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:20:53.323 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022027-0010] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:20:53.325 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:20:53.326 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:20:53.328 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022027-0011] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:20:58.437 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:20:58.438 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022027-0012] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:20:58.440 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:20:58.441 | WARNING  | __main__:discover_sink:342 | ‚ö†Ô∏è  Sink n√£o encontrado ap√≥s timeout
2026-01-02 02:20:58.443 | ERROR    | __main__:run:753 | ‚ùå Falha ao descobrir uplink
2026-01-02 02:20:58.447 | WARNING  | __main__:run:755 | ‚ö†Ô∏è  Sem uplink - operando apenas como server
2026-01-02 02:21:21.463 | INFO     | __main__:signal_handler:861 | 
Sinal 2 recebido, a parar...
2026-01-02 02:21:21.464 | INFO     | __main__:stop:807 | A parar Node...
2026-01-02 02:21:21.465 | INFO     | __main__:stop_gatt_server:244 | A parar GATT Server...
2026-01-02 02:21:21.467 | INFO     | __main__:stop_gatt_server:252 | ‚úÖ GATT Server parado
2026-01-02 02:21:21.467 | INFO     | __main__:stop:820 | ‚úÖ Node parado
2026-01-02 02:21:22.451 | INFO     | __main__:stop:807 | A parar Node...
2026-01-02 02:21:22.452 | INFO     | __main__:stop_gatt_server:244 | A parar GATT Server...
2026-01-02 02:21:22.454 | INFO     | __main__:stop_gatt_server:252 | ‚úÖ GATT Server parado
2026-01-02 02:21:22.454 | INFO     | __main__:stop:820 | ‚úÖ Node parado
2026-01-02 02:21:26.251 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 02:21:26.255 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 02:21:26.255 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 02:21:26.255 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 02:21:26.256 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 02:21:26.256 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 02:21:26.256 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 02:21:26.271 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_022126.log
2026-01-02 02:21:26.272 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:21:26.273 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 02:21:26.273 | INFO     | __main__:__init__:160 | IoT Node inicializado (adapter=hci0)
2026-01-02 02:21:26.274 | INFO     | __main__:run:738 | ============================================================
2026-01-02 02:21:26.274 | INFO     | __main__:run:739 |   A iniciar IoT Node (dual-mode)
2026-01-02 02:21:26.274 | INFO     | __main__:run:740 | ============================================================
2026-01-02 02:21:26.275 | INFO     | __main__:setup_gatt_server:164 | A configurar GATT Server...
2026-01-02 02:21:26.277 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 02:21:26.277 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:21:26.278 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 02:21:26.280 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 02:21:26.280 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:21:26.281 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 02:21:26.281 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 02:21:26.284 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:21:26.284 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:21:26.287 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:21:26.287 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:26.287 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:21:26.288 | INFO     | __main__:setup_gatt_server:207 | ‚úÖ GATT Server configurado
2026-01-02 02:21:26.289 | INFO     | __main__:start_gatt_server:211 | A iniciar GATT Server...
2026-01-02 02:21:26.293 | INFO     | __main__:start_gatt_server:240 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:21:26.294 | INFO     | __main__:run:748 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:21:26.295 | INFO     | __main__:discover_sink:312 | üîç A procurar Sink...
2026-01-02 02:21:26.296 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:21:26.299 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022126-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:21:26.377 | INFO     | __main__:<lambda>:223 | ‚úÖ GATT application registada!
2026-01-02 02:21:26.378 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:21:26.490 | INFO     | __main__:<lambda>:231 | ‚úÖ Advertisement registado!
2026-01-02 02:21:31.577 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:21:31.578 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022126-0002] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:21:31.578 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:21:31.579 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:21:31.580 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022126-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:21:36.686 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:21:36.688 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022126-0004] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:21:36.689 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:21:36.690 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:21:36.691 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022126-0005] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:21:41.800 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:21:41.801 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022126-0006] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:21:41.803 | INFO     | __main__:discover_sink:319 | Encontrados 0 dispositivos IoT
2026-01-02 02:21:41.805 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:21:41.807 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022126-0007] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:21:46.926 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 02:21:46.927 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022126-0008] SCAN_RESULT | Devices_Found: 1
2026-01-02 02:21:46.929 | INFO     | __main__:discover_sink:319 | Encontrados 1 dispositivos IoT
2026-01-02 02:21:46.931 | INFO     | __main__:discover_sink:336 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -44 dBm
2026-01-02 02:21:46.932 | INFO     | __main__:connect_to_sink:356 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 02:21:46.936 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 02:21:46.937 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_022126-0009] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 02:21:51.141 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 02:21:51.143 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_022126-0010] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 4201.06ms
2026-01-02 02:21:51.144 | INFO     | __main__:connect_to_sink:369 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 02:21:51.153 | INFO     | __main__:connect_to_sink:382 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 02:21:51.154 | INFO     | __main__:_subscribe_to_notifications:391 | A subscrever a notifica√ß√µes...
2026-01-02 02:21:51.662 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:51.663 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_022126-0011] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:51.664 | INFO     | __main__:_subscribe_to_notifications:400 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 02:21:51.762 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_022126-0013] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 02:21:51.763 | INFO     | __main__:_update_hop_count_from_uplink:723 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 02:21:51.765 | INFO     | __main__:authenticate_with_sink:503 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 02:21:51.766 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 02:21:51.767 | INFO     | __main__:authenticate_with_sink:516 | üì§ Enviando certificado...
2026-01-02 02:21:51.769 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 02:21:51.771 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 02:21:51.774 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 02:21:51.784 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022126-0014] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 02:21:51.910 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022126-0015] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:52.012 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022126-0016] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 02:21:52.161 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022126-0017] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:52.265 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022126-0018] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 02:21:52.411 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022126-0019] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:52.513 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022126-0020] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 02:21:52.661 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022126-0021] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:52.765 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022126-0022] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 02:21:52.860 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022126-0023] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:53.560 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[166] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:53.562 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0025] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:53.716 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_022126-0026] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000007152d0cb382d1b9b157f0ce567c1ee9f8ff081d7132783a8b20bc | ASCII: ..Z..iB}...Q......Z..iB}...Q...........-......W..V|......q2x:. . [TRUNCATED]
2026-01-02 02:21:53.718 | INFO     | __main__:_handle_heartbeat:440 | Sink NID identificado: c5c55ab2...
2026-01-02 02:21:54.160 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[172] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:54.161 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0028] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:54.760 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[177] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:54.761 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0030] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:55.360 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[182] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:55.362 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0032] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:55.960 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[187] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:55.961 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0034] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:56.561 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[192] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:56.564 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0036] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:57.160 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[197] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:57.161 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0038] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:57.760 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[202] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:57.761 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0040] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:58.410 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[207] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:58.411 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0042] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:58.716 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_022126-0043] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000008b096f38a7eb2765c90041cd0dfca8390bfc36294ec35ee93a293 | ASCII: ..Z..iB}...Q......Z..iB}...Q..............~.v\..........b..5.... [TRUNCATED]
2026-01-02 02:21:59.010 | ERROR    | common.ble.gatt_client:read_characteristic:458 | Erro ao ler 12340004-0000-1000-8000-00805f9b34fb: org.bluez.Error.NotPermitted: Read not permitted
[213] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service001a/char0023 org.bluez.GattCharacteristic1 ReadValue
2026-01-02 02:21:59.012 | ERROR    | common.utils.ble_logger:log_read_response:243 | [OP-20260102_022126-0045] READ_FAILED | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:21:59.014 | ERROR    | __main__:authenticate_with_sink:566 | ‚ùå Autentica√ß√£o expirou (timeout)
2026-01-02 02:21:59.015 | ERROR    | __main__:run:775 | ‚ùå Falha na autentica√ß√£o
2026-01-02 02:21:59.016 | INFO     | __main__:stop:807 | A parar Node...
2026-01-02 02:21:59.017 | INFO     | __main__:stop_gatt_server:244 | A parar GATT Server...
2026-01-02 02:21:59.020 | INFO     | __main__:stop_gatt_server:252 | ‚úÖ GATT Server parado
2026-01-02 02:22:01.020 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 02:22:01.022 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_022126-0046] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 02:22:01.025 | INFO     | __main__:stop:820 | ‚úÖ Node parado
2026-01-02 02:28:30.496 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 02:28:30.500 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 02:28:30.501 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 02:28:30.501 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 02:28:30.501 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 02:28:30.501 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 02:28:30.502 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 02:28:30.519 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_022830.log
2026-01-02 02:28:30.520 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:28:30.521 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 02:28:30.521 | INFO     | __main__:__init__:164 | IoT Node inicializado (adapter=hci0)
2026-01-02 02:28:30.522 | INFO     | __main__:run:765 | ============================================================
2026-01-02 02:28:30.522 | INFO     | __main__:run:766 |   A iniciar IoT Node (dual-mode)
2026-01-02 02:28:30.523 | INFO     | __main__:run:767 | ============================================================
2026-01-02 02:28:30.525 | INFO     | __main__:setup_gatt_server:168 | A configurar GATT Server...
2026-01-02 02:28:30.527 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 02:28:30.528 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:28:30.528 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 02:28:30.531 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 02:28:30.532 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:28:30.533 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 02:28:30.534 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 02:28:30.538 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:28:30.539 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:28:30.540 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:28:30.542 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:30.543 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:28:30.546 | INFO     | __main__:setup_gatt_server:211 | ‚úÖ GATT Server configurado
2026-01-02 02:28:30.547 | INFO     | __main__:start_gatt_server:215 | A iniciar GATT Server...
2026-01-02 02:28:30.551 | INFO     | __main__:start_gatt_server:244 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:28:30.551 | INFO     | __main__:run:775 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:28:30.553 | INFO     | __main__:discover_sink:316 | üîç A procurar Sink...
2026-01-02 02:28:30.555 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:28:30.556 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_022830-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:28:30.631 | INFO     | __main__:<lambda>:227 | ‚úÖ GATT application registada!
2026-01-02 02:28:30.633 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:28:30.745 | INFO     | __main__:<lambda>:235 | ‚úÖ Advertisement registado!
2026-01-02 02:28:35.836 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 02:28:35.836 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_022830-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 02:28:35.837 | INFO     | __main__:discover_sink:323 | Encontrados 1 dispositivos IoT
2026-01-02 02:28:35.838 | INFO     | __main__:discover_sink:340 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -60 dBm
2026-01-02 02:28:35.839 | INFO     | __main__:connect_to_sink:360 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 02:28:35.839 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 02:28:35.840 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_022830-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 02:28:39.042 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 02:28:39.043 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_022830-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 3199.40ms
2026-01-02 02:28:39.045 | INFO     | __main__:connect_to_sink:373 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 02:28:39.053 | INFO     | __main__:connect_to_sink:386 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 02:28:39.054 | INFO     | __main__:_subscribe_to_notifications:395 | A subscrever a notifica√ß√µes...
2026-01-02 02:28:39.562 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.565 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_022830-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.566 | INFO     | __main__:_subscribe_to_notifications:404 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 02:28:39.663 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_022830-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 02:28:39.664 | INFO     | __main__:_update_hop_count_from_uplink:750 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 02:28:39.666 | INFO     | __main__:authenticate_with_sink:519 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 02:28:39.761 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.762 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_022830-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.762 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 02:28:39.763 | INFO     | __main__:authenticate_with_sink:550 | üì§ Enviando certificado...
2026-01-02 02:28:39.763 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 02:28:39.763 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 02:28:39.764 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 02:28:39.766 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022830-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 02:28:39.767 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_022830-0010] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000003f72cddbfce556c6bb0474f7203fc157338a84b90110a9a1f252c | ASCII: ..Z..iB}...Q......Z..iB}...Q...........,...Ulk.GOr...s8.K.....%, [TRUNCATED]
2026-01-02 02:28:39.769 | INFO     | __main__:_handle_heartbeat:444 | Sink NID identificado: c5c55ab2...
2026-01-02 02:28:39.911 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022830-0011] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.014 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022830-0012] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 02:28:40.161 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022830-0013] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.265 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022830-0014] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 02:28:40.413 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022830-0015] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.517 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022830-0016] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 02:28:40.662 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022830-0017] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.765 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022830-0018] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 02:28:40.861 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022830-0019] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.863 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_022830-0020] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 38 bytes | Hex: 03000102002006b591f9df30b41cd63acda27b12a7154061c2a940bb5240017471a1248523b5 | ASCII: ..... .....0...:..{...@a..@.R@.tq.$.#.
2026-01-02 02:28:41.464 | INFO     | common.security.authentication:handle_response:248 | üîç Response recebida - verificando assinatura...
2026-01-02 02:28:41.465 | ERROR    | common.security.authentication:handle_response:251 | ‚ùå Nenhum challenge foi enviado!
2026-01-02 02:28:41.470 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_022830-0021] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 23 bytes | Hex: 0300010500114e6f206368616c6c656e67652073656e74 | ASCII: ......No challenge sent
2026-01-02 02:28:41.561 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_022830-0022] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:44.766 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_022830-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000000458de169dd01a56b5ebb6a6296f37d0bba1ed54d26fdb09b5841c | ASCII: ..Z..iB}...Q......Z..iB}...Q..........X.....V....)o7....T.o..... [TRUNCATED]
2026-01-02 02:28:46.073 | ERROR    | __main__:authenticate_with_sink:600 | ‚ùå Autentica√ß√£o expirou (timeout)
2026-01-02 02:28:46.074 | ERROR    | __main__:run:802 | ‚ùå Falha na autentica√ß√£o
2026-01-02 02:28:46.075 | INFO     | __main__:stop:834 | A parar Node...
2026-01-02 02:28:46.076 | INFO     | __main__:stop_gatt_server:248 | A parar GATT Server...
2026-01-02 02:28:46.079 | INFO     | __main__:stop_gatt_server:256 | ‚úÖ GATT Server parado
2026-01-02 02:28:48.023 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 02:28:48.026 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_022830-0024] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 02:28:48.027 | INFO     | __main__:stop:847 | ‚úÖ Node parado
2026-01-02 02:32:38.128 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 02:32:38.132 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 02:32:38.132 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 02:32:38.132 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 02:32:38.133 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 02:32:38.133 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 02:32:38.133 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 02:32:38.149 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_023238.log
2026-01-02 02:32:38.149 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:32:38.150 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 02:32:38.152 | INFO     | __main__:__init__:168 | IoT Node inicializado (adapter=hci0)
2026-01-02 02:32:38.153 | INFO     | __main__:run:776 | ============================================================
2026-01-02 02:32:38.154 | INFO     | __main__:run:777 |   A iniciar IoT Node (dual-mode)
2026-01-02 02:32:38.155 | INFO     | __main__:run:778 | ============================================================
2026-01-02 02:32:38.156 | INFO     | __main__:setup_gatt_server:172 | A configurar GATT Server...
2026-01-02 02:32:38.159 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 02:32:38.160 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:32:38.161 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 02:32:38.162 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 02:32:38.162 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:32:38.163 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 02:32:38.165 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 02:32:38.167 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:32:38.167 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:32:38.168 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:32:38.169 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:38.169 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:32:38.171 | INFO     | __main__:setup_gatt_server:215 | ‚úÖ GATT Server configurado
2026-01-02 02:32:38.171 | INFO     | __main__:start_gatt_server:219 | A iniciar GATT Server...
2026-01-02 02:32:38.173 | INFO     | __main__:start_gatt_server:248 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:32:38.174 | INFO     | __main__:run:786 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:32:38.175 | INFO     | __main__:discover_sink:320 | üîç A procurar Sink...
2026-01-02 02:32:38.178 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:32:38.179 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_023238-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:32:38.246 | INFO     | __main__:<lambda>:231 | ‚úÖ GATT application registada!
2026-01-02 02:32:38.248 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:32:38.296 | INFO     | __main__:<lambda>:239 | ‚úÖ Advertisement registado!
2026-01-02 02:32:43.391 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 02:32:43.392 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_023238-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 02:32:43.393 | INFO     | __main__:discover_sink:327 | Encontrados 1 dispositivos IoT
2026-01-02 02:32:43.395 | INFO     | __main__:discover_sink:344 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -58 dBm
2026-01-02 02:32:43.395 | INFO     | __main__:connect_to_sink:364 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 02:32:43.397 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 02:32:43.400 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_023238-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 02:32:46.499 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 02:32:46.500 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_023238-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 3096.39ms
2026-01-02 02:32:46.502 | INFO     | __main__:connect_to_sink:377 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 02:32:46.510 | INFO     | __main__:connect_to_sink:390 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 02:32:46.513 | INFO     | __main__:_subscribe_to_notifications:399 | A subscrever a notifica√ß√µes...
2026-01-02 02:32:47.031 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:47.032 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_023238-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:47.032 | INFO     | __main__:_subscribe_to_notifications:408 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 02:32:47.114 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_023238-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 02:32:47.114 | INFO     | __main__:_update_hop_count_from_uplink:761 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 02:32:47.117 | INFO     | __main__:authenticate_with_sink:530 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 02:32:47.212 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:47.213 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_023238-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:47.214 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 02:32:47.214 | INFO     | __main__:authenticate_with_sink:561 | üì§ Enviando certificado...
2026-01-02 02:32:47.214 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 02:32:47.215 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 02:32:47.215 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 02:32:47.217 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_023238-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 02:32:47.362 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_023238-0010] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:47.464 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_023238-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 02:32:47.612 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_023238-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:47.714 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_023238-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 02:32:47.863 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_023238-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:47.965 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_023238-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 02:32:48.112 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_023238-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:48.215 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_023238-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 02:32:48.312 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_023238-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:48.312 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_023238-0019] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 38 bytes | Hex: 030001020020330c774d44b33abca467820f0a7bf05f2c566deffb5828489a3f2a290d70f886 | ASCII: ..... 3.wMD.:..g...{._,Vm..X(H.?*).p..
2026-01-02 02:32:48.314 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 02:32:48.315 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 35 bytes (1 fragmentos)
2026-01-02 02:32:48.915 | INFO     | common.security.authentication:handle_challenge:214 | üé≤ Challenge recebido - gerando response...
2026-01-02 02:32:48.926 | INFO     | common.security.authentication:handle_challenge:230 | ‚úçÔ∏è  Response gerada: 139 bytes
2026-01-02 02:32:48.932 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_023238-0020] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 145 bytes | Hex: 03000103008b30818802420114e803c140cc1c314f1cdae4ef2d1c8e652a80468f99109ee6e0e8f9af96dad8bff1f7cad3cba7f1e62dc32d1e606fc905913efe | ASCII: ......0...B.....@..1O....-..e*.F.....................-.-.`o...>. [TRUNCATED]
2026-01-02 02:32:49.013 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_023238-0021] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:32:49.014 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_023238-0022] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-02 02:32:49.015 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 02:32:49.015 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-02 02:32:49.515 | INFO     | common.security.authentication:handle_auth_success:290 | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-02 02:32:49.516 | INFO     | __main__:authenticate_with_sink:593 | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-02 02:32:49.517 | ERROR    | common.security.authentication:derive_session_key:404 | Certificados n√£o dispon√≠veis para derivar session key
2026-01-02 02:32:49.518 | INFO     | __main__:run:816 | ============================================================
2026-01-02 02:32:49.522 | INFO     | __main__:run:817 | ‚úÖ Node pronto! Uplink conectado (hop=0)
2026-01-02 02:32:49.523 | INFO     | __main__:run:818 | ============================================================
2026-01-02 02:32:49.767 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_023238-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000003041e85338ce1e8b8327b0283c8229b860d6a0344f8a852176fb8 | ASCII: ..Z..iB}...Q......Z..iB}...Q.............3....2{..."...j.D..R.o. [TRUNCATED]
2026-01-02 02:32:49.768 | INFO     | __main__:_handle_heartbeat:448 | Sink NID identificado: c5c55ab2...
2026-01-02 02:32:54.768 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_023238-0024] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000000403d7cd7b40ad969dd6ce6c1bf2a7a8e415b61b32e9b2a98f39dd | ASCII: ..Z..iB}...Q......Z..iB}...Q.............{@.....l........2....9. [TRUNCATED]
2026-01-02 02:32:59.768 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_023238-0025] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000005c463aceb7a6261553a70db3d08f93942ad3c777b91dd779b1cdb | ASCII: ..Z..iB}...Q......Z..iB}...Q...........c..zbaU:p.=..9B.<w{..w... [TRUNCATED]
2026-01-02 02:33:02.971 | INFO     | __main__:signal_handler:899 | 
Sinal 2 recebido, a parar...
2026-01-02 02:33:02.971 | INFO     | __main__:stop:845 | A parar Node...
2026-01-02 02:33:02.972 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 02:33:02.972 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 02:33:05.023 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 02:33:05.024 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_023238-0026] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 02:33:05.026 | INFO     | __main__:stop:858 | ‚úÖ Node parado
2026-01-02 02:33:05.028 | WARNING  | __main__:run:826 | ‚ö†Ô∏è  Conex√£o perdida com Sink
2026-01-02 02:33:05.029 | INFO     | __main__:stop:845 | A parar Node...
2026-01-02 02:33:05.030 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 02:33:05.030 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 02:33:05.034 | INFO     | __main__:stop:858 | ‚úÖ Node parado
2026-01-02 02:49:17.709 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 02:49:17.713 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 02:49:17.713 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 02:49:17.714 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 02:49:17.714 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 02:49:17.714 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 02:49:17.714 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 02:49:17.733 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_024917.log
2026-01-02 02:49:17.734 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:49:17.734 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 02:49:17.735 | INFO     | __main__:__init__:168 | IoT Node inicializado (adapter=hci0)
2026-01-02 02:49:17.735 | INFO     | __main__:run:776 | ============================================================
2026-01-02 02:49:17.737 | INFO     | __main__:run:777 |   A iniciar IoT Node (dual-mode)
2026-01-02 02:49:17.739 | INFO     | __main__:run:778 | ============================================================
2026-01-02 02:49:17.739 | INFO     | __main__:setup_gatt_server:172 | A configurar GATT Server...
2026-01-02 02:49:17.743 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 02:49:17.743 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:49:17.744 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 02:49:17.746 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 02:49:17.747 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:49:17.749 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 02:49:17.752 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 02:49:17.753 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:49:17.754 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:49:17.756 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:49:17.756 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:17.758 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:49:17.759 | INFO     | __main__:setup_gatt_server:215 | ‚úÖ GATT Server configurado
2026-01-02 02:49:17.760 | INFO     | __main__:start_gatt_server:219 | A iniciar GATT Server...
2026-01-02 02:49:17.763 | INFO     | __main__:start_gatt_server:248 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:49:17.763 | INFO     | __main__:run:786 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:49:17.764 | INFO     | __main__:discover_sink:320 | üîç A procurar Sink...
2026-01-02 02:49:17.765 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:49:17.765 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_024917-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:49:17.837 | INFO     | __main__:<lambda>:231 | ‚úÖ GATT application registada!
2026-01-02 02:49:17.838 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:49:17.884 | INFO     | __main__:<lambda>:239 | ‚úÖ Advertisement registado!
2026-01-02 02:49:22.975 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 02:49:22.976 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_024917-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 02:49:22.977 | INFO     | __main__:discover_sink:327 | Encontrados 1 dispositivos IoT
2026-01-02 02:49:22.978 | INFO     | __main__:discover_sink:344 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -48 dBm
2026-01-02 02:49:22.978 | INFO     | __main__:connect_to_sink:364 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 02:49:22.981 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 02:49:22.982 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_024917-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 02:49:26.330 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 02:49:26.331 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_024917-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 3342.57ms
2026-01-02 02:49:26.331 | INFO     | __main__:connect_to_sink:377 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 02:49:26.334 | INFO     | __main__:connect_to_sink:390 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 02:49:26.334 | INFO     | __main__:_subscribe_to_notifications:399 | A subscrever a notifica√ß√µes...
2026-01-02 02:49:27.023 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:27.024 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_024917-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:27.025 | INFO     | __main__:_subscribe_to_notifications:408 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 02:49:27.113 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_024917-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 02:49:27.114 | INFO     | __main__:_update_hop_count_from_uplink:761 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 02:49:27.115 | INFO     | __main__:authenticate_with_sink:530 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 02:49:27.212 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:27.213 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_024917-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:27.214 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 02:49:27.214 | INFO     | __main__:authenticate_with_sink:561 | üì§ Enviando certificado...
2026-01-02 02:49:27.214 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 02:49:27.215 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 02:49:27.215 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 02:49:27.218 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_024917-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 02:49:27.362 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_024917-0010] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:27.466 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_024917-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 02:49:27.662 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_024917-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:27.765 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_024917-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 02:49:27.912 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_024917-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:28.014 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_024917-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 02:49:28.162 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_024917-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:28.265 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_024917-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 02:49:28.362 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_024917-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:49:28.363 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_024917-0019] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 38 bytes | Hex: 030001020020ddecc5195a46f5080f236ea26f5fc6ce42fbc78536a182dd7bafd3ecdfff077a | ASCII: ..... ....ZF...#n.o_..B...6...{......z
2026-01-02 02:49:28.365 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 02:49:28.368 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 35 bytes (1 fragmentos)
2026-01-02 02:49:28.967 | INFO     | common.security.authentication:handle_challenge:221 | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-02 02:49:28.969 | ERROR    | common.security.authentication:handle_challenge:227 | ‚ùå Payload muito curto: 32 bytes
2026-01-02 02:49:28.970 | ERROR    | common.security.authentication:handle_challenge:262 | ‚ùå Erro ao processar payload: Payload deve ter pelo menos 36 bytes
2026-01-02 02:49:28.971 | ERROR    | common.security.authentication:process_message:393 | ‚ùå Erro ao processar mensagem: Payload deve ter pelo menos 36 bytes
2026-01-02 02:49:28.971 | ERROR    | __main__:authenticate_with_sink:608 | ‚ùå Autentica√ß√£o falhou: FAILED
2026-01-02 02:49:28.972 | ERROR    | __main__:run:813 | ‚ùå Falha na autentica√ß√£o
2026-01-02 02:49:28.973 | INFO     | __main__:stop:845 | A parar Node...
2026-01-02 02:49:28.976 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 02:49:28.980 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 02:49:31.276 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 02:49:31.280 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_024917-0020] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 02:49:31.283 | INFO     | __main__:stop:858 | ‚úÖ Node parado
2026-01-02 02:51:21.128 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 02:51:21.132 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 02:51:21.132 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 02:51:21.133 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 02:51:21.133 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 02:51:21.133 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 02:51:21.133 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 02:51:21.149 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_025121.log
2026-01-02 02:51:21.150 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:51:21.151 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 02:51:21.152 | INFO     | __main__:__init__:168 | IoT Node inicializado (adapter=hci0)
2026-01-02 02:51:21.153 | INFO     | __main__:run:776 | ============================================================
2026-01-02 02:51:21.153 | INFO     | __main__:run:777 |   A iniciar IoT Node (dual-mode)
2026-01-02 02:51:21.154 | INFO     | __main__:run:778 | ============================================================
2026-01-02 02:51:21.154 | INFO     | __main__:setup_gatt_server:172 | A configurar GATT Server...
2026-01-02 02:51:21.156 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 02:51:21.157 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:51:21.159 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 02:51:21.159 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 02:51:21.160 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:51:21.161 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 02:51:21.161 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 02:51:21.163 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:51:21.164 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:51:21.165 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:51:21.166 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:21.167 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:51:21.167 | INFO     | __main__:setup_gatt_server:215 | ‚úÖ GATT Server configurado
2026-01-02 02:51:21.168 | INFO     | __main__:start_gatt_server:219 | A iniciar GATT Server...
2026-01-02 02:51:21.171 | INFO     | __main__:start_gatt_server:248 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:51:21.173 | INFO     | __main__:run:786 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:51:21.174 | INFO     | __main__:discover_sink:320 | üîç A procurar Sink...
2026-01-02 02:51:21.174 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:51:21.178 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_025121-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:51:21.242 | INFO     | __main__:<lambda>:231 | ‚úÖ GATT application registada!
2026-01-02 02:51:21.243 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:51:21.354 | INFO     | __main__:<lambda>:239 | ‚úÖ Advertisement registado!
2026-01-02 02:51:26.351 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:51:26.352 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_025121-0002] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:51:26.353 | INFO     | __main__:discover_sink:327 | Encontrados 0 dispositivos IoT
2026-01-02 02:51:26.353 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:51:26.353 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_025121-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:51:31.465 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 02:51:31.466 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_025121-0004] SCAN_RESULT | Devices_Found: 1
2026-01-02 02:51:31.468 | INFO     | __main__:discover_sink:327 | Encontrados 1 dispositivos IoT
2026-01-02 02:51:31.469 | INFO     | __main__:discover_sink:344 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -51 dBm
2026-01-02 02:51:31.470 | INFO     | __main__:connect_to_sink:364 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 02:51:31.472 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 02:51:31.473 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_025121-0005] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 02:51:35.127 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 02:51:35.129 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_025121-0006] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 3648.93ms
2026-01-02 02:51:35.131 | INFO     | __main__:connect_to_sink:377 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 02:51:35.139 | INFO     | __main__:connect_to_sink:390 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 02:51:35.140 | INFO     | __main__:_subscribe_to_notifications:399 | A subscrever a notifica√ß√µes...
2026-01-02 02:51:35.663 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:35.665 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_025121-0007] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:35.666 | INFO     | __main__:_subscribe_to_notifications:408 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 02:51:35.763 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_025121-0009] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 02:51:35.764 | INFO     | __main__:_update_hop_count_from_uplink:761 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 02:51:35.766 | INFO     | __main__:authenticate_with_sink:530 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 02:51:35.863 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:35.864 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_025121-0010] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:35.864 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 02:51:35.865 | INFO     | __main__:authenticate_with_sink:561 | üì§ Enviando certificado...
2026-01-02 02:51:35.866 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 02:51:35.866 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 02:51:35.867 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 02:51:35.869 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025121-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 02:51:36.012 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025121-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:36.114 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025121-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 02:51:36.262 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025121-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:36.365 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025121-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 02:51:36.512 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025121-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:36.614 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025121-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 02:51:36.762 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025121-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:36.865 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025121-0019] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 02:51:37.012 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025121-0020] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:37.013 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0021] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949436344434341644767417749424167495558355a615754 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUX5ZaWT [TRUNCATED]
2026-01-02 02:51:37.014 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 6 fragmentos
2026-01-02 02:51:37.063 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0022] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af3800201000000053e82bd13714e410772a40ca5a39820ee59182ed13f422f0028ba | ASCII: ..Z..iB}...Q......Z..iB}...Q..........>...qNA.r..... .Y...?B/.(. [TRUNCATED]
2026-01-02 02:51:37.064 | INFO     | __main__:_handle_heartbeat:448 | Sink NID identificado: c5c55ab2...
2026-01-02 02:51:37.113 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449314d54497a4d4441784e446b794e466f580a44544d314d5449794f4441 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI1MTIzMDAxNDkyNFoX.DTM1MTIyODA [TRUNCATED]
2026-01-02 02:51:37.220 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0024] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064f4441784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241423243 | ASCII: ...ODAxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAB2C [TRUNCATED]
2026-01-02 02:51:37.318 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0025] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003064569796e614b424c72536939516e0a695050563154362b33326e30466d39562b30376a33567052686c5941467a615036443374536d386647364d344d44 | ASCII: ...EiynaKBLrSi9Qn.iPPV1T6+32n0Fm9V+07j3VpRhlYAFzaP6D3tSm8fG6M4MD [TRUNCATED]
2026-01-02 02:51:37.417 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0026] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067a3743426962455851666c4c564a2b47464b772f37666f5935637655610a6d4c435933457041355152552f3439457676693132312b346c556c4361684d | ASCII: ...z7CBibEXQflLVJ+GFKw/7foY5cvUa.mLCY3EpA5QRU/49Evvi121+4lUlCahM [TRUNCATED]
2026-01-02 02:51:37.513 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0027] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0a7495c327f64fc9fc7c72c6eb1de84a9f8238d25f67e86eff2d887dc41c1ad832 | ASCII: ...RTIFICATE-----.t..'.O..|r....J..8._g.n.-.}....2
2026-01-02 02:51:37.517 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 947 bytes (6 fragmentos)
2026-01-02 02:51:37.616 | INFO     | common.security.authentication:handle_challenge:221 | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-02 02:51:37.617 | INFO     | common.security.authentication:handle_challenge:240 | üìú Extraindo certificado do peer do payload...
2026-01-02 02:51:37.625 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2026-01-02 02:51:37.627 | INFO     | common.security.authentication:handle_challenge:253 | ‚úÖ Certificado do peer validado!
2026-01-02 02:51:37.630 | INFO     | common.security.authentication:handle_challenge:254 |    Peer NID: c5c55ab2...
2026-01-02 02:51:37.633 | INFO     | common.security.authentication:handle_challenge:255 |    Peer tipo: SINK
2026-01-02 02:51:37.639 | INFO     | common.security.authentication:handle_challenge:271 | ‚úçÔ∏è  Response gerada: 139 bytes
2026-01-02 02:51:37.643 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025121-0028] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 145 bytes | Hex: 03000103008b3081880242010dfa8b2ba34763a2f7e773c45d83e082bf08af4b3789e5eadfa7a2386a77f3b883e74c79ddc8f5f745773da84dc9ceface092f42 | ASCII: ......0...B....+.Gc...s.]......K7......8jw....Ly....Ew=.M...../B [TRUNCATED]
2026-01-02 02:51:37.716 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025121-0029] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:51:37.716 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0030] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-02 02:51:37.724 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 02:51:37.724 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-02 02:51:38.223 | INFO     | common.security.authentication:handle_auth_success:331 | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-02 02:51:38.224 | INFO     | __main__:authenticate_with_sink:593 | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-02 02:51:38.263 | INFO     | __main__:authenticate_with_sink:600 | üîë Session key estabelecida
2026-01-02 02:51:38.264 | INFO     | __main__:run:816 | ============================================================
2026-01-02 02:51:38.265 | INFO     | __main__:run:817 | ‚úÖ Node pronto! Uplink conectado (hop=0)
2026-01-02 02:51:38.265 | INFO     | __main__:run:818 | ============================================================
2026-01-02 02:51:42.019 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0031] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000000699d1c75811824460a3f956a91d9329b6b78d346e917b1caf374d | ASCII: ..Z..iB}...Q......Z..iB}...Q.............X..D`..V...)...4n.{..7M [TRUNCATED]
2026-01-02 02:51:42.021 | ERROR    | __main__:_handle_heartbeat:459 | ‚ùå MAC inv√°lido em heartbeat!
2026-01-02 02:51:47.018 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0032] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000007d56d34945a65b99607a8d50a026f46a8c77cd00835b8a025e2ee | ASCII: ..Z..iB}...Q......Z..iB}...Q...........m4.Ze.......oF..|..5..%.. [TRUNCATED]
2026-01-02 02:51:47.020 | ERROR    | __main__:_handle_heartbeat:459 | ‚ùå MAC inv√°lido em heartbeat!
2026-01-02 02:51:47.267 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 10.2s (√∫ltimo seq=5)
2026-01-02 02:51:48.268 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 11.2s (√∫ltimo seq=5)
2026-01-02 02:51:49.269 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 12.2s (√∫ltimo seq=5)
2026-01-02 02:51:50.270 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 13.2s (√∫ltimo seq=5)
2026-01-02 02:51:51.271 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 14.2s (√∫ltimo seq=5)
2026-01-02 02:51:52.021 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025121-0033] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000008ce6ca50d7012633be2e97ce453276defddfc03820350a6146782 | ASCII: ..Z..iB}...Q......Z..iB}...Q...........l..p.c;..|.S'm......P..g. [TRUNCATED]
2026-01-02 02:51:52.025 | ERROR    | __main__:_handle_heartbeat:459 | ‚ùå MAC inv√°lido em heartbeat!
2026-01-02 02:51:52.272 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 15.2s (√∫ltimo seq=5)
2026-01-02 02:51:53.273 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 16.2s (√∫ltimo seq=5)
2026-01-02 02:51:54.275 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 17.2s (√∫ltimo seq=5)
2026-01-02 02:51:55.276 | WARNING  | __main__:run:833 | ‚ö†Ô∏è  Sem heartbeat h√° 18.2s (√∫ltimo seq=5)
2026-01-02 02:51:55.984 | INFO     | __main__:signal_handler:899 | 
Sinal 2 recebido, a parar...
2026-01-02 02:51:55.985 | INFO     | __main__:stop:845 | A parar Node...
2026-01-02 02:51:55.986 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 02:51:55.987 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 02:51:58.273 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 02:51:58.274 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_025121-0034] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 02:51:58.276 | INFO     | __main__:stop:858 | ‚úÖ Node parado
2026-01-02 02:51:58.278 | WARNING  | __main__:run:826 | ‚ö†Ô∏è  Conex√£o perdida com Sink
2026-01-02 02:51:58.279 | INFO     | __main__:stop:845 | A parar Node...
2026-01-02 02:51:58.280 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 02:51:58.281 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 02:51:58.283 | INFO     | __main__:stop:858 | ‚úÖ Node parado
2026-01-02 02:58:33.752 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 02:58:33.756 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 02:58:33.756 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 02:58:33.756 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 02:58:33.757 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 02:58:33.757 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 02:58:33.757 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 02:58:33.773 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_025833.log
2026-01-02 02:58:33.773 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:58:33.774 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 02:58:33.775 | INFO     | __main__:__init__:168 | IoT Node inicializado (adapter=hci0)
2026-01-02 02:58:33.775 | INFO     | __main__:run:775 | ============================================================
2026-01-02 02:58:33.776 | INFO     | __main__:run:776 |   A iniciar IoT Node (dual-mode)
2026-01-02 02:58:33.777 | INFO     | __main__:run:777 | ============================================================
2026-01-02 02:58:33.778 | INFO     | __main__:setup_gatt_server:172 | A configurar GATT Server...
2026-01-02 02:58:33.781 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 02:58:33.781 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:58:33.782 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 02:58:33.783 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 02:58:33.784 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:58:33.784 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 02:58:33.785 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 02:58:33.788 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:58:33.788 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:58:33.789 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:58:33.789 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:33.789 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:58:33.790 | INFO     | __main__:setup_gatt_server:215 | ‚úÖ GATT Server configurado
2026-01-02 02:58:33.792 | INFO     | __main__:start_gatt_server:219 | A iniciar GATT Server...
2026-01-02 02:58:33.794 | INFO     | __main__:start_gatt_server:248 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:58:33.795 | INFO     | __main__:run:785 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:58:33.795 | INFO     | __main__:discover_sink:320 | üîç A procurar Sink...
2026-01-02 02:58:33.796 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:58:33.797 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_025833-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:58:33.885 | INFO     | __main__:<lambda>:231 | ‚úÖ GATT application registada!
2026-01-02 02:58:33.887 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:58:33.912 | INFO     | __main__:<lambda>:239 | ‚úÖ Advertisement registado!
2026-01-02 02:58:38.915 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 02:58:38.915 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_025833-0002] SCAN_RESULT | Devices_Found: 0
2026-01-02 02:58:38.916 | INFO     | __main__:discover_sink:327 | Encontrados 0 dispositivos IoT
2026-01-02 02:58:38.916 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 02:58:38.916 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_025833-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:58:43.930 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 02:58:43.932 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_025833-0004] SCAN_RESULT | Devices_Found: 1
2026-01-02 02:58:43.933 | INFO     | __main__:discover_sink:327 | Encontrados 1 dispositivos IoT
2026-01-02 02:58:43.934 | INFO     | __main__:discover_sink:344 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -56 dBm
2026-01-02 02:58:43.935 | INFO     | __main__:connect_to_sink:364 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 02:58:43.939 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 02:58:43.940 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_025833-0005] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 02:58:48.204 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 02:58:48.205 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_025833-0006] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 4261.36ms
2026-01-02 02:58:48.207 | INFO     | __main__:connect_to_sink:377 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 02:58:48.219 | INFO     | __main__:connect_to_sink:390 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 02:58:48.221 | INFO     | __main__:_subscribe_to_notifications:399 | A subscrever a notifica√ß√µes...
2026-01-02 02:58:48.719 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:48.720 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_025833-0007] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:48.720 | INFO     | __main__:_subscribe_to_notifications:408 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 02:58:48.819 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_025833-0009] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 02:58:48.820 | INFO     | __main__:_update_hop_count_from_uplink:760 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 02:58:48.821 | INFO     | __main__:authenticate_with_sink:529 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 02:58:48.917 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:48.918 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_025833-0010] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:48.919 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 02:58:48.920 | INFO     | __main__:authenticate_with_sink:560 | üì§ Enviando certificado...
2026-01-02 02:58:48.920 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 02:58:48.921 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 02:58:48.922 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 02:58:48.925 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025833-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 02:58:49.067 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025833-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:49.171 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025833-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 02:58:49.319 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025833-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:49.421 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025833-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 02:58:49.567 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025833-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:49.671 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025833-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 02:58:49.819 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025833-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:49.921 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025833-0019] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 02:58:50.067 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0020] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949436344434341644767417749424167495558355a615754 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUX5ZaWT [TRUNCATED]
2026-01-02 02:58:50.067 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025833-0021] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:50.069 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 6 fragmentos
2026-01-02 02:58:50.168 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0022] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449314d54497a4d4441784e446b794e466f580a44544d314d5449794f4441 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI1MTIzMDAxNDkyNFoX.DTM1MTIyODA [TRUNCATED]
2026-01-02 02:58:50.274 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064f4441784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241423243 | ASCII: ...ODAxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAB2C [TRUNCATED]
2026-01-02 02:58:50.373 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0024] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003064569796e614b424c72536939516e0a695050563154362b33326e30466d39562b30376a33567052686c5941467a615036443374536d386647364d344d44 | ASCII: ...EiynaKBLrSi9Qn.iPPV1T6+32n0Fm9V+07j3VpRhlYAFzaP6D3tSm8fG6M4MD [TRUNCATED]
2026-01-02 02:58:50.474 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0025] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067a3743426962455851666c4c564a2b47464b772f37666f5935637655610a6d4c435933457041355152552f3439457676693132312b346c556c4361684d | ASCII: ...z7CBibEXQflLVJ+GFKw/7foY5cvUa.mLCY3EpA5QRU/49Evvi121+4lUlCahM [TRUNCATED]
2026-01-02 02:58:50.570 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0026] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0a5352f37724f5c1e488b5437a97245d7b46e554a6aefa2359f7a82dcbea89b243 | ASCII: ...RTIFICATE-----.SR.w$.....Cz.$]{F.T...#Y..-....C
2026-01-02 02:58:50.572 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 947 bytes (6 fragmentos)
2026-01-02 02:58:50.670 | INFO     | common.security.authentication:handle_challenge:221 | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-02 02:58:50.672 | INFO     | common.security.authentication:handle_challenge:240 | üìú Extraindo certificado do peer do payload...
2026-01-02 02:58:50.680 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2026-01-02 02:58:50.682 | INFO     | common.security.authentication:handle_challenge:253 | ‚úÖ Certificado do peer validado!
2026-01-02 02:58:50.683 | INFO     | common.security.authentication:handle_challenge:254 |    Peer NID: c5c55ab2...
2026-01-02 02:58:50.685 | INFO     | common.security.authentication:handle_challenge:255 |    Peer tipo: SINK
2026-01-02 02:58:50.688 | INFO     | common.security.authentication:handle_challenge:271 | ‚úçÔ∏è  Response gerada: 139 bytes
2026-01-02 02:58:50.697 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_025833-0027] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 145 bytes | Hex: 03000103008b308188024201796cfb082b2f7c72083eebd4baa330d09a19c874ba8b0182b6d14d1b9018e8280a12a92a5b6f9bb2625def732ebb936dc76a0247 | ASCII: ......0...B.yl..+/|r.>....0....t......M....(...*[o..b].s...m.j.G [TRUNCATED]
2026-01-02 02:58:50.767 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_025833-0028] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:58:50.769 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0029] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-02 02:58:50.769 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 02:58:50.770 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-02 02:58:51.269 | INFO     | common.security.authentication:handle_auth_success:331 | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-02 02:58:51.271 | INFO     | __main__:authenticate_with_sink:592 | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-02 02:58:51.279 | INFO     | __main__:authenticate_with_sink:599 | üîë Session key estabelecida
2026-01-02 02:58:51.280 | INFO     | __main__:run:815 | ============================================================
2026-01-02 02:58:51.281 | INFO     | __main__:run:816 | ‚úÖ Node pronto! Uplink conectado (hop=0)
2026-01-02 02:58:51.282 | INFO     | __main__:run:817 | ============================================================
2026-01-02 02:58:51.973 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0030] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000006f90791d78489e237f76719728d3e88924e3e41ec4fd68ad74133 | ASCII: ..Z..iB}...Q......Z..iB}...Q.................7.g.r.>..N>A.O...A3 [TRUNCATED]
2026-01-02 02:58:56.972 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0031] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af3800201000000075922a02316931bb4eb30fc0e6c42b3a0e56601d0c6542957418b | ASCII: ..Z..iB}...Q......Z..iB}...Q..........Y".#.....0..lB...f...T)WA. [TRUNCATED]
2026-01-02 02:59:01.974 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0032] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000008a0743230450d5fcd509c861b86aece9b1b5e32ae029308c59202 | ASCII: ..Z..iB}...Q......Z..iB}...Q...........t20E._.P........^2....... [TRUNCATED]
2026-01-02 02:59:06.974 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0033] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000009826791bdc865b03717bbbc8fa9d1d7460bc1817a60397df3299c | ASCII: ..Z..iB}...Q......Z..iB}...Q...........g...e.7.......F...z`9}.). [TRUNCATED]
2026-01-02 02:59:11.973 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_025833-0034] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000000afa96a88a5d95d3d458ef22313a2e5547964b76a419bd72fd8824 | ASCII: ..Z..iB}...Q......Z..iB}...Q..............]...X."1:.UG.Kv...r..$ [TRUNCATED]
2026-01-02 02:59:13.796 | INFO     | __main__:signal_handler:898 | 
Sinal 2 recebido, a parar...
2026-01-02 02:59:13.797 | INFO     | __main__:stop:844 | A parar Node...
2026-01-02 02:59:13.797 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 02:59:13.800 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 02:59:16.279 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 02:59:16.281 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_025833-0035] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 02:59:16.285 | INFO     | __main__:stop:857 | ‚úÖ Node parado
2026-01-02 02:59:16.288 | WARNING  | __main__:run:825 | ‚ö†Ô∏è  Conex√£o perdida com Sink
2026-01-02 02:59:16.289 | INFO     | __main__:stop:844 | A parar Node...
2026-01-02 02:59:16.291 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 02:59:16.292 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 02:59:16.292 | INFO     | __main__:stop:857 | ‚úÖ Node parado
2026-01-02 03:10:12.409 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 03:10:12.413 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 03:10:12.413 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 03:10:12.413 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 03:10:12.413 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 03:10:12.414 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 03:10:12.414 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 03:10:12.433 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_031012.log
2026-01-02 03:10:12.434 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 03:10:12.435 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 03:10:12.435 | INFO     | __main__:__init__:168 | IoT Node inicializado (adapter=hci0)
2026-01-02 03:10:12.436 | INFO     | __main__:run:785 | ============================================================
2026-01-02 03:10:12.437 | INFO     | __main__:run:786 |   A iniciar IoT Node (dual-mode)
2026-01-02 03:10:12.438 | INFO     | __main__:run:787 | ============================================================
2026-01-02 03:10:12.438 | INFO     | __main__:setup_gatt_server:172 | A configurar GATT Server...
2026-01-02 03:10:12.441 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 03:10:12.444 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 03:10:12.445 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 03:10:12.446 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 03:10:12.448 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 03:10:12.449 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 03:10:12.449 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 03:10:12.450 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 03:10:12.452 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 03:10:12.453 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 03:10:12.453 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:12.454 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 03:10:12.456 | INFO     | __main__:setup_gatt_server:215 | ‚úÖ GATT Server configurado
2026-01-02 03:10:12.456 | INFO     | __main__:start_gatt_server:219 | A iniciar GATT Server...
2026-01-02 03:10:12.460 | INFO     | __main__:start_gatt_server:248 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 03:10:12.462 | INFO     | __main__:run:795 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 03:10:12.462 | INFO     | __main__:discover_sink:320 | üîç A procurar Sink...
2026-01-02 03:10:12.462 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 03:10:12.464 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_031012-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 03:10:12.517 | INFO     | __main__:<lambda>:231 | ‚úÖ GATT application registada!
2026-01-02 03:10:12.518 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 03:10:12.579 | INFO     | __main__:<lambda>:239 | ‚úÖ Advertisement registado!
2026-01-02 03:10:17.576 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 03:10:17.577 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_031012-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 03:10:17.578 | INFO     | __main__:discover_sink:327 | Encontrados 1 dispositivos IoT
2026-01-02 03:10:17.578 | INFO     | __main__:discover_sink:344 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -53 dBm
2026-01-02 03:10:17.579 | INFO     | __main__:connect_to_sink:364 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 03:10:17.580 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 03:10:17.581 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_031012-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 03:10:21.457 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 03:10:21.458 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_031012-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 3870.26ms
2026-01-02 03:10:21.459 | INFO     | __main__:connect_to_sink:377 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 03:10:21.463 | INFO     | __main__:connect_to_sink:390 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 03:10:21.464 | INFO     | __main__:_subscribe_to_notifications:399 | A subscrever a notifica√ß√µes...
2026-01-02 03:10:21.986 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:21.987 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_031012-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:21.987 | INFO     | __main__:_subscribe_to_notifications:408 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 03:10:22.086 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_031012-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 03:10:22.087 | INFO     | __main__:_update_hop_count_from_uplink:770 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 03:10:22.088 | INFO     | __main__:authenticate_with_sink:534 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 03:10:22.188 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:22.189 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_031012-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:22.190 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 03:10:22.190 | INFO     | __main__:authenticate_with_sink:565 | üì§ Enviando certificado...
2026-01-02 03:10:22.191 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 03:10:22.192 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 03:10:22.193 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 03:10:22.198 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031012-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 03:10:22.335 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031012-0010] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:22.438 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031012-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 03:10:22.585 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031012-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:22.687 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031012-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 03:10:22.835 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031012-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:22.937 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031012-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 03:10:23.087 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031012-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:23.189 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031012-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 03:10:23.335 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031012-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:23.340 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0019] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949436344434341644767417749424167495558355a615754 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUX5ZaWT [TRUNCATED]
2026-01-02 03:10:23.341 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 6 fragmentos
2026-01-02 03:10:23.439 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0020] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449314d54497a4d4441784e446b794e466f580a44544d314d5449794f4441 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI1MTIzMDAxNDkyNFoX.DTM1MTIyODA [TRUNCATED]
2026-01-02 03:10:23.541 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0021] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064f4441784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241423243 | ASCII: ...ODAxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAB2C [TRUNCATED]
2026-01-02 03:10:23.641 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0022] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003064569796e614b424c72536939516e0a695050563154362b33326e30466d39562b30376a33567052686c5941467a615036443374536d386647364d344d44 | ASCII: ...EiynaKBLrSi9Qn.iPPV1T6+32n0Fm9V+07j3VpRhlYAFzaP6D3tSm8fG6M4MD [TRUNCATED]
2026-01-02 03:10:23.741 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067a3743426962455851666c4c564a2b47464b772f37666f5935637655610a6d4c435933457041355152552f3439457676693132312b346c556c4361684d | ASCII: ...z7CBibEXQflLVJ+GFKw/7foY5cvUa.mLCY3EpA5QRU/49Evvi121+4lUlCahM [TRUNCATED]
2026-01-02 03:10:23.838 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0024] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0a6fc96350c5a6ed915e091887672bdec4274207e7c10733af61cd5fea1c6f2a02 | ASCII: ...RTIFICATE-----.o.cP....^...g+..'B....3.a._..o*.
2026-01-02 03:10:23.839 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 947 bytes (6 fragmentos)
2026-01-02 03:10:23.941 | INFO     | common.security.authentication:handle_challenge:221 | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-02 03:10:23.942 | INFO     | common.security.authentication:handle_challenge:240 | üìú Extraindo certificado do peer do payload...
2026-01-02 03:10:23.945 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2026-01-02 03:10:23.946 | INFO     | common.security.authentication:handle_challenge:253 | ‚úÖ Certificado do peer validado!
2026-01-02 03:10:23.947 | INFO     | common.security.authentication:handle_challenge:254 |    Peer NID: c5c55ab2...
2026-01-02 03:10:23.947 | INFO     | common.security.authentication:handle_challenge:255 |    Peer tipo: SINK
2026-01-02 03:10:23.950 | INFO     | common.security.authentication:handle_challenge:271 | ‚úçÔ∏è  Response gerada: 138 bytes
2026-01-02 03:10:23.955 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031012-0025] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 144 bytes | Hex: 03000103008a30818702416e7479a956a6a78393b613d0082db13d4f5929aad434f1b1a54e279c43e87150078432fcb04a8c03ef684fd14127a5a969ff8acda6 | ASCII: ......0...Anty.V........-.=OY)..4...N'.C.qP..2..J...hO.A'..i.... [TRUNCATED]
2026-01-02 03:10:24.037 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0026] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000000fe61712ff18a10c42134d82d919ea882779a9292ad4bbe18fe130 | ASCII: ..Z..iB}...Q......Z..iB}...Q.................B.M.....'y.)*.....0 [TRUNCATED]
2026-01-02 03:10:24.038 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031012-0027] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:10:24.039 | INFO     | __main__:_handle_heartbeat:448 | Sink NID identificado: c5c55ab2...
2026-01-02 03:10:24.041 | WARNING  | common.protocol.heartbeat:verify_signature:177 | ‚ö†Ô∏è  Certificado do Sink n√£o dispon√≠vel para verifica√ß√£o
2026-01-02 03:10:24.041 | ERROR    | __main__:_handle_heartbeat:463 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 03:10:24.043 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0028] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-02 03:10:24.043 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 03:10:24.045 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-02 03:10:24.541 | INFO     | common.security.authentication:handle_auth_success:331 | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-02 03:10:24.542 | INFO     | __main__:authenticate_with_sink:597 | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-02 03:10:24.546 | INFO     | __main__:authenticate_with_sink:604 | üîë Session key estabelecida
2026-01-02 03:10:24.548 | INFO     | __main__:run:825 | ============================================================
2026-01-02 03:10:24.549 | INFO     | __main__:run:826 | ‚úÖ Node pronto! Uplink conectado (hop=0)
2026-01-02 03:10:24.549 | INFO     | __main__:run:827 | ============================================================
2026-01-02 03:10:28.990 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0029] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000010f7ee1aa38779044fdb74eb21a5188cfd9418d8d2b3a42cecb18a | ASCII: ..Z..iB}...Q......Z..iB}...Q...............y.O.t.!..........,... [TRUNCATED]
2026-01-02 03:10:28.993 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 03:10:28.994 | WARNING  | common.protocol.heartbeat:verify_signature:193 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 03:10:28.995 | ERROR    | __main__:_handle_heartbeat:463 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 03:10:33.992 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0030] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000001170a904e40d2028ba96900b2563367e6e260e76657dda7c33f780 | ASCII: ..Z..iB}...Q......Z..iB}...Q..........p.... (....%c6~n&.ve}.|3.. [TRUNCATED]
2026-01-02 03:10:33.993 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 03:10:33.993 | WARNING  | common.protocol.heartbeat:verify_signature:193 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 03:10:33.994 | ERROR    | __main__:_handle_heartbeat:463 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 03:10:38.992 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0031] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000012bb823dd210a3526d136a8c60f3409e2c8a86a4b1e610f387b769 | ASCII: ..Z..iB}...Q......Z..iB}...Q............=...Rm.j.`.@.,.........i [TRUNCATED]
2026-01-02 03:10:38.994 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 03:10:38.995 | WARNING  | common.protocol.heartbeat:verify_signature:193 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 03:10:38.996 | ERROR    | __main__:_handle_heartbeat:463 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 03:10:43.992 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0032] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000001304b523b5b22e43457522ea037b5791100383df2bddd975f3935a | ASCII: ..Z..iB}...Q......Z..iB}...Q............#...CEu"..{W.....+..u..Z [TRUNCATED]
2026-01-02 03:10:43.995 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 03:10:43.996 | WARNING  | common.protocol.heartbeat:verify_signature:193 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 03:10:43.997 | ERROR    | __main__:_handle_heartbeat:463 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 03:10:48.992 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031012-0033] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af3800201000000143b48c8e07597004f27586c965d02105a87744381d56988346849 | ASCII: ..Z..iB}...Q......Z..iB}...Q..........;H..u..O'Xl.]..Z.tC..i.4hI [TRUNCATED]
2026-01-02 03:10:48.995 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 03:10:48.996 | WARNING  | common.protocol.heartbeat:verify_signature:193 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 03:10:48.996 | ERROR    | __main__:_handle_heartbeat:463 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 03:10:53.287 | INFO     | __main__:signal_handler:908 | 
Sinal 2 recebido, a parar...
2026-01-02 03:10:53.288 | INFO     | __main__:stop:854 | A parar Node...
2026-01-02 03:10:53.289 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 03:10:53.291 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 03:10:55.248 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 03:10:55.249 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_031012-0034] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 03:10:55.251 | INFO     | __main__:stop:867 | ‚úÖ Node parado
2026-01-02 03:10:55.253 | WARNING  | __main__:run:835 | ‚ö†Ô∏è  Conex√£o perdida com Sink
2026-01-02 03:10:55.254 | INFO     | __main__:stop:854 | A parar Node...
2026-01-02 03:10:55.255 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 03:10:55.257 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 03:10:55.258 | INFO     | __main__:stop:867 | ‚úÖ Node parado
2026-01-02 03:13:58.903 | INFO     | __main__:__init__:78 | A carregar certificados...
2026-01-02 03:13:58.907 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 53a84472...
2026-01-02 03:13:58.907 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 03:13:58.907 | INFO     | __main__:__init__:108 | ‚úÖ Certificados carregados com sucesso
2026-01-02 03:13:58.907 | INFO     | __main__:__init__:116 | Node NID: 53a84472...
2026-01-02 03:13:58.907 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 03:13:58.908 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 03:13:58.923 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_031358.log
2026-01-02 03:13:58.924 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 03:13:58.925 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 03:13:58.925 | INFO     | __main__:__init__:168 | IoT Node inicializado (adapter=hci0)
2026-01-02 03:13:58.926 | INFO     | __main__:run:785 | ============================================================
2026-01-02 03:13:58.926 | INFO     | __main__:run:786 |   A iniciar IoT Node (dual-mode)
2026-01-02 03:13:58.927 | INFO     | __main__:run:787 | ============================================================
2026-01-02 03:13:58.927 | INFO     | __main__:setup_gatt_server:172 | A configurar GATT Server...
2026-01-02 03:13:58.929 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 03:13:58.930 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 03:13:58.930 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 03:13:58.932 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 03:13:58.933 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 03:13:58.934 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 03:13:58.935 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 03:13:58.936 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 03:13:58.937 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 03:13:58.938 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 03:13:58.938 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 03:13:58.939 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 03:13:58.940 | INFO     | __main__:setup_gatt_server:215 | ‚úÖ GATT Server configurado
2026-01-02 03:13:58.940 | INFO     | __main__:start_gatt_server:219 | A iniciar GATT Server...
2026-01-02 03:13:58.944 | INFO     | __main__:start_gatt_server:248 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 03:13:58.945 | INFO     | __main__:run:795 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 03:13:58.946 | INFO     | __main__:discover_sink:320 | üîç A procurar Sink...
2026-01-02 03:13:58.946 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 03:13:58.947 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_031358-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 03:13:59.002 | INFO     | __main__:<lambda>:231 | ‚úÖ GATT application registada!
2026-01-02 03:13:59.004 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 03:13:59.061 | INFO     | __main__:<lambda>:239 | ‚úÖ Advertisement registado!
2026-01-02 03:14:04.060 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 03:14:04.061 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_031358-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 03:14:04.064 | INFO     | __main__:discover_sink:327 | Encontrados 1 dispositivos IoT
2026-01-02 03:14:04.068 | INFO     | __main__:discover_sink:344 | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -47 dBm
2026-01-02 03:14:04.069 | INFO     | __main__:connect_to_sink:364 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 03:14:04.071 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 03:14:04.072 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_031358-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 03:14:07.520 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 03:14:07.522 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_031358-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 3445.26ms
2026-01-02 03:14:07.523 | INFO     | __main__:connect_to_sink:377 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 03:14:07.532 | INFO     | __main__:connect_to_sink:390 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 03:14:07.533 | INFO     | __main__:_subscribe_to_notifications:399 | A subscrever a notifica√ß√µes...
2026-01-02 03:14:08.042 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:08.043 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_031358-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:08.045 | INFO     | __main__:_subscribe_to_notifications:408 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 03:14:08.142 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_031358-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 03:14:08.142 | INFO     | __main__:_update_hop_count_from_uplink:770 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 03:14:08.143 | INFO     | __main__:authenticate_with_sink:534 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 03:14:08.241 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:08.242 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_031358-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:08.243 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 03:14:08.244 | INFO     | __main__:authenticate_with_sink:565 | üì§ Enviando certificado...
2026-01-02 03:14:08.244 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 03:14:08.245 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 887 bytes
2026-01-02 03:14:08.246 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 03:14:08.249 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031358-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 03:14:08.390 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031358-0010] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:08.492 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031358-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 03:14:08.640 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031358-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:08.743 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031358-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 03:14:08.890 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031358-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:08.993 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031358-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 03:14:09.140 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031358-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:09.243 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031358-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 03:14:09.390 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031358-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:09.391 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0019] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949436344434341644767417749424167495558355a615754 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUX5ZaWT [TRUNCATED]
2026-01-02 03:14:09.393 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 6 fragmentos
2026-01-02 03:14:09.491 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0020] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449314d54497a4d4441784e446b794e466f580a44544d314d5449794f4441 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI1MTIzMDAxNDkyNFoX.DTM1MTIyODA [TRUNCATED]
2026-01-02 03:14:09.594 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0021] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064f4441784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241423243 | ASCII: ...ODAxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAB2C [TRUNCATED]
2026-01-02 03:14:09.695 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0022] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003064569796e614b424c72536939516e0a695050563154362b33326e30466d39562b30376a33567052686c5941467a615036443374536d386647364d344d44 | ASCII: ...EiynaKBLrSi9Qn.iPPV1T6+32n0Fm9V+07j3VpRhlYAFzaP6D3tSm8fG6M4MD [TRUNCATED]
2026-01-02 03:14:09.795 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067a3743426962455851666c4c564a2b47464b772f37666f5935637655610a6d4c435933457041355152552f3439457676693132312b346c556c4361684d | ASCII: ...z7CBibEXQflLVJ+GFKw/7foY5cvUa.mLCY3EpA5QRU/49Evvi121+4lUlCahM [TRUNCATED]
2026-01-02 03:14:09.890 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0024] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0a6c405750d200847fd5b38daf9e9f4adacbc43f62cf36436348363618797670b0 | ASCII: ...RTIFICATE-----.l@WP..........J...?b.6CcH66.yvp.
2026-01-02 03:14:09.891 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 947 bytes (6 fragmentos)
2026-01-02 03:14:09.996 | INFO     | common.security.authentication:handle_challenge:221 | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-02 03:14:09.997 | INFO     | common.security.authentication:handle_challenge:240 | üìú Extraindo certificado do peer do payload...
2026-01-02 03:14:10.007 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2026-01-02 03:14:10.008 | INFO     | common.security.authentication:handle_challenge:253 | ‚úÖ Certificado do peer validado!
2026-01-02 03:14:10.011 | INFO     | common.security.authentication:handle_challenge:254 |    Peer NID: c5c55ab2...
2026-01-02 03:14:10.013 | INFO     | common.security.authentication:handle_challenge:255 |    Peer tipo: SINK
2026-01-02 03:14:10.016 | INFO     | common.security.authentication:handle_challenge:271 | ‚úçÔ∏è  Response gerada: 139 bytes
2026-01-02 03:14:10.022 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_031358-0025] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 145 bytes | Hex: 03000103008b308188024200be542e613ab0fbfdb7d32596750badb58e9bd9ef76d7fe0667af019c790eca76dc4d7401dd85251dab662c0c88c8d3939a235226 | ASCII: ......0...B..T.a:.....%.u.......v...g...y..v.Mt...%..f,......#R& [TRUNCATED]
2026-01-02 03:14:10.143 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_031358-0026] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 03:14:10.144 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0027] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-02 03:14:10.145 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 03:14:10.147 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-02 03:14:10.645 | INFO     | common.security.authentication:handle_auth_success:331 | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-02 03:14:10.646 | INFO     | __main__:authenticate_with_sink:597 | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-02 03:14:10.652 | INFO     | __main__:authenticate_with_sink:604 | üîë Session key estabelecida
2026-01-02 03:14:10.653 | INFO     | __main__:run:825 | ============================================================
2026-01-02 03:14:10.654 | INFO     | __main__:run:826 | ‚úÖ Node pronto! Uplink conectado (hop=0)
2026-01-02 03:14:10.655 | INFO     | __main__:run:827 | ============================================================
2026-01-02 03:14:11.042 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0028] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 234 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000007759e6d6dbf3b72670a2e8cca35f4e481af5b6c1e3a2159113f8f | ASCII: ..Z..iB}...Q......Z..iB}...Q..........u.mm.;rg....5....[l.:!Y.?. [TRUNCATED]
2026-01-02 03:14:21.658 | WARNING  | __main__:run:842 | ‚ö†Ô∏è  Sem heartbeat h√° 10.6s (√∫ltimo seq=7)
2026-01-02 03:14:22.659 | WARNING  | __main__:run:842 | ‚ö†Ô∏è  Sem heartbeat h√° 11.6s (√∫ltimo seq=7)
2026-01-02 03:14:23.660 | WARNING  | __main__:run:842 | ‚ö†Ô∏è  Sem heartbeat h√° 12.6s (√∫ltimo seq=7)
2026-01-02 03:14:24.660 | WARNING  | __main__:run:842 | ‚ö†Ô∏è  Sem heartbeat h√° 13.6s (√∫ltimo seq=7)
2026-01-02 03:14:25.661 | WARNING  | __main__:run:842 | ‚ö†Ô∏è  Sem heartbeat h√° 14.6s (√∫ltimo seq=7)
2026-01-02 03:14:26.041 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_031358-0029] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 234 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000000a371a6586d6f6b34c44bc74432f4394c0abd8c28cf4ef69097c3c | ASCII: ..Z..iB}...Q......Z..iB}...Q..........7.e....LD.tC/C........i.|< [TRUNCATED]
2026-01-02 03:14:29.659 | INFO     | __main__:signal_handler:908 | 
Sinal 2 recebido, a parar...
2026-01-02 03:14:29.660 | INFO     | __main__:stop:854 | A parar Node...
2026-01-02 03:14:29.661 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 03:14:29.664 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 03:14:32.243 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 03:14:32.244 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_031358-0030] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 03:14:32.245 | INFO     | __main__:stop:867 | ‚úÖ Node parado
2026-01-02 03:14:32.247 | WARNING  | __main__:run:835 | ‚ö†Ô∏è  Conex√£o perdida com Sink
2026-01-02 03:14:32.247 | INFO     | __main__:stop:854 | A parar Node...
2026-01-02 03:14:32.249 | INFO     | __main__:stop_gatt_server:252 | A parar GATT Server...
2026-01-02 03:14:32.249 | INFO     | __main__:stop_gatt_server:260 | ‚úÖ GATT Server parado
2026-01-02 03:14:32.250 | INFO     | __main__:stop:867 | ‚úÖ Node parado
2026-01-02 03:17:49.035 | INFO     | __main__:__init__:82 | A carregar certificados...
2026-01-02 03:17:49.037 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para c5c55ab2...
2026-01-02 03:17:49.037 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafael/repos/iot/certs
2026-01-02 03:17:49.037 | INFO     | __main__:__init__:112 | ‚úÖ Certificados carregados com sucesso
2026-01-02 03:17:49.038 | INFO     | __main__:__init__:120 | Sink NID: c5c55ab2...
2026-01-02 03:17:49.038 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 03:17:49.038 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 03:17:49.038 | INFO     | __main__:__init__:143 | Sink Device inicializado (adapter=hci1)
2026-01-02 03:17:49.038 | INFO     | __main__:start:389 | ============================================================
2026-01-02 03:17:49.038 | INFO     | __main__:start:390 |   A iniciar Sink Device
2026-01-02 03:17:49.038 | INFO     | __main__:start:391 | ============================================================
2026-01-02 03:17:49.038 | INFO     | __main__:setup_gatt_server:147 | A configurar GATT Server...
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=c5c55ab2..., type=sink
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 03:17:49.039 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 03:17:49.039 | INFO     | __main__:setup_gatt_server:185 | ‚úÖ GATT Server configurado
2026-01-02 03:17:49.039 | INFO     | __main__:start:398 | A registar GATT application no adaptador hci1...
2026-01-02 03:17:49.040 | INFO     | __main__:setup_advertising:189 | A configurar BLE Advertising...
2026-01-02 03:17:49.040 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 03:17:49.040 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 03:17:49.040 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 03:17:49.040 | INFO     | __main__:setup_advertising:200 | ‚úÖ BLE Advertising configurado
2026-01-02 03:17:49.040 | INFO     | __main__:start:414 | A registar advertisement no adaptador hci1...
2026-01-02 03:17:49.041 | INFO     | __main__:start_heartbeat_service:354 | üíì A iniciar servi√ßo de heartbeat...
2026-01-02 03:17:49.041 | INFO     | __main__:start_heartbeat_service:385 | ‚úÖ Servi√ßo de heartbeat iniciado
2026-01-02 03:17:49.041 | INFO     | __main__:start:431 | ‚úÖ Sink Device iniciado - a aguardar conex√µes...
2026-01-02 03:17:49.045 | INFO     | __main__:<lambda>:406 | ‚úÖ GATT application registada!
2026-01-02 03:17:49.046 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 03:17:49.148 | INFO     | __main__:<lambda>:420 | ‚úÖ Advertisement registado!
2026-01-02 03:18:26.025 | INFO     | common.ble.gatt_services:StartNotify:120 | Cliente :1.4 subscreveu notifica√ß√µes de pacotes
2026-01-02 03:18:26.224 | INFO     | common.ble.gatt_services:StartNotify:481 | Cliente :1.4 subscreveu auth indications
2026-01-02 03:18:26.373 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 5 fragmentos
2026-01-02 03:18:27.327 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 890 bytes (5 fragmentos)
2026-01-02 03:18:27.328 | INFO     | common.ble.gatt_services:WriteValue:455 | Mensagem completa recebida de :1.4: 890 bytes
2026-01-02 03:18:27.328 | INFO     | __main__:_on_auth_message:261 | üîê Mensagem de autentica√ß√£o recebida de :1.4: 890 bytes
2026-01-02 03:18:27.328 | INFO     | common.security.auth_handler:handle_auth_message:89 | üì® Mensagem de autentica√ß√£o de :1.4: 890 bytes
2026-01-02 03:18:27.328 | INFO     | common.security.auth_handler:get_or_create_session:71 | Nova sess√£o de autentica√ß√£o para cliente: :1.4
2026-01-02 03:18:27.329 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para c5c55ab2...
2026-01-02 03:18:27.329 | INFO     | common.security.authentication:handle_cert_offer:163 | üìú Certificado do peer recebido - validando...
2026-01-02 03:18:27.331 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2026-01-02 03:18:27.332 | INFO     | common.security.authentication:handle_cert_offer:181 | ‚úÖ Certificado v√°lido!
2026-01-02 03:18:27.332 | INFO     | common.security.authentication:handle_cert_offer:182 |    Peer NID: 53a84472...
2026-01-02 03:18:27.332 | INFO     | common.security.authentication:handle_cert_offer:183 |    Peer tipo: NODE
2026-01-02 03:18:27.333 | INFO     | common.security.authentication:handle_cert_offer:198 | üé≤ Enviando certificado + challenge: 84648342a7ef7f487234226cf8e86869...
2026-01-02 03:18:27.333 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 947 bytes em 6 fragmentos
2026-01-02 03:18:28.078 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 03:18:28.078 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 140 bytes (1 fragmentos)
2026-01-02 03:18:28.079 | INFO     | common.ble.gatt_services:WriteValue:455 | Mensagem completa recebida de :1.4: 140 bytes
2026-01-02 03:18:28.079 | INFO     | __main__:_on_auth_message:261 | üîê Mensagem de autentica√ß√£o recebida de :1.4: 140 bytes
2026-01-02 03:18:28.079 | INFO     | common.security.auth_handler:handle_auth_message:89 | üì® Mensagem de autentica√ß√£o de :1.4: 140 bytes
2026-01-02 03:18:28.079 | INFO     | common.security.authentication:handle_response:289 | üîç Response recebida - verificando assinatura...
2026-01-02 03:18:28.080 | INFO     | common.security.authentication:handle_response:311 | ‚úÖ Assinatura v√°lida - AUTENTICA√á√ÉO BEM SUCEDIDA!
2026-01-02 03:18:28.080 | INFO     | common.security.authentication:handle_response:312 |    Peer 53a84472... autenticado com sucesso
2026-01-02 03:18:28.080 | INFO     | common.security.auth_handler:handle_auth_message:102 | ‚úÖ Cliente :1.4 AUTENTICADO!
2026-01-02 03:18:28.080 | INFO     | __main__:_on_auth_message:269 | ‚úÖ Cliente :1.4 autenticado com sucesso!
2026-01-02 03:18:28.083 | INFO     | __main__:_on_auth_message:285 | üîë Session key armazenada para 53a84472...
2026-01-02 03:18:58.375 | INFO     | common.ble.gatt_services:StopNotify:137 | Cliente :1.4 cancelou subscri√ß√£o de pacotes
2026-01-02 03:18:58.472 | INFO     | common.ble.gatt_services:StopNotify:493 | Cliente :1.4 cancelou subscri√ß√£o de auth
2026-01-02 11:46:58.944 | INFO     | __main__:__init__:85 | A carregar certificados...
2026-01-02 11:46:58.947 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para af04ea89...
2026-01-02 11:46:58.947 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafael/repos/iot/certs
2026-01-02 11:46:58.947 | INFO     | __main__:__init__:115 | ‚úÖ Certificados carregados com sucesso
2026-01-02 11:46:58.947 | INFO     | __main__:__init__:123 | Sink NID: af04ea89...
2026-01-02 11:46:58.947 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 11:46:58.947 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 11:46:58.947 | INFO     | __main__:__init__:146 | Sink Device inicializado (adapter=hci1)
2026-01-02 11:46:58.947 | INFO     | __main__:start:392 | ============================================================
2026-01-02 11:46:58.947 | INFO     | __main__:start:393 |   A iniciar Sink Device
2026-01-02 11:46:58.947 | INFO     | __main__:start:394 | ============================================================
2026-01-02 11:46:58.948 | INFO     | __main__:setup_gatt_server:150 | A configurar GATT Server...
2026-01-02 11:46:58.948 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 11:46:58.948 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 11:46:58.949 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 11:46:58.949 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 11:46:58.949 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=af04ea89..., type=sink
2026-01-02 11:46:58.949 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 11:46:58.949 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 11:46:58.949 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 11:46:58.949 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 11:46:58.949 | INFO     | __main__:setup_gatt_server:188 | ‚úÖ GATT Server configurado
2026-01-02 11:46:58.949 | INFO     | __main__:start:401 | A registar GATT application no adaptador hci1...
2026-01-02 11:46:58.950 | INFO     | __main__:setup_advertising:192 | A configurar BLE Advertising...
2026-01-02 11:46:58.950 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 11:46:58.950 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 11:46:58.950 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:46:58.950 | INFO     | __main__:setup_advertising:203 | ‚úÖ BLE Advertising configurado
2026-01-02 11:46:58.951 | INFO     | __main__:start:417 | A registar advertisement no adaptador hci1...
2026-01-02 11:46:58.951 | INFO     | __main__:start_heartbeat_service:357 | üíì A iniciar servi√ßo de heartbeat...
2026-01-02 11:46:58.951 | INFO     | __main__:start_heartbeat_service:388 | ‚úÖ Servi√ßo de heartbeat iniciado
2026-01-02 11:46:58.951 | INFO     | __main__:start:434 | ‚úÖ Sink Device iniciado - a aguardar conex√µes...
2026-01-02 11:46:58.956 | INFO     | __main__:<lambda>:409 | ‚úÖ GATT application registada!
2026-01-02 11:46:58.957 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:46:59.060 | INFO     | __main__:<lambda>:423 | ‚úÖ Advertisement registado!
2026-01-02 11:47:11.149 | INFO     | __main__:signal_handler:528 | 
Sinal 2 recebido, a parar...
2026-01-02 11:47:11.149 | INFO     | __main__:stop:446 | A parar Sink Device...
2026-01-02 11:47:11.150 | INFO     | __main__:stop:458 | ‚úÖ Sink Device parado
2026-01-02 11:47:15.711 | INFO     | __main__:__init__:85 | A carregar certificados...
2026-01-02 11:47:15.713 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para af04ea89...
2026-01-02 11:47:15.713 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafael/repos/iot/certs
2026-01-02 11:47:15.713 | INFO     | __main__:__init__:115 | ‚úÖ Certificados carregados com sucesso
2026-01-02 11:47:15.713 | INFO     | __main__:__init__:123 | Sink NID: af04ea89...
2026-01-02 11:47:15.714 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 11:47:15.714 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 11:47:15.714 | INFO     | __main__:__init__:146 | Sink Device inicializado (adapter=hci1)
2026-01-02 11:47:15.714 | INFO     | __main__:start:392 | ============================================================
2026-01-02 11:47:15.714 | INFO     | __main__:start:393 |   A iniciar Sink Device
2026-01-02 11:47:15.714 | INFO     | __main__:start:394 | ============================================================
2026-01-02 11:47:15.714 | INFO     | __main__:setup_gatt_server:150 | A configurar GATT Server...
2026-01-02 11:47:15.715 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 11:47:15.715 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 11:47:15.716 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 11:47:15.716 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 11:47:15.716 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=af04ea89..., type=sink
2026-01-02 11:47:15.716 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 11:47:15.716 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 11:47:15.717 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 11:47:15.717 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 11:47:15.717 | INFO     | __main__:setup_gatt_server:188 | ‚úÖ GATT Server configurado
2026-01-02 11:47:15.717 | INFO     | __main__:start:401 | A registar GATT application no adaptador hci1...
2026-01-02 11:47:15.717 | INFO     | __main__:setup_advertising:192 | A configurar BLE Advertising...
2026-01-02 11:47:15.718 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 11:47:15.718 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 11:47:15.718 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:47:15.718 | INFO     | __main__:setup_advertising:203 | ‚úÖ BLE Advertising configurado
2026-01-02 11:47:15.719 | INFO     | __main__:start:417 | A registar advertisement no adaptador hci1...
2026-01-02 11:47:15.719 | INFO     | __main__:start_heartbeat_service:357 | üíì A iniciar servi√ßo de heartbeat...
2026-01-02 11:47:15.719 | INFO     | __main__:start_heartbeat_service:388 | ‚úÖ Servi√ßo de heartbeat iniciado
2026-01-02 11:47:15.719 | INFO     | __main__:start:434 | ‚úÖ Sink Device iniciado - a aguardar conex√µes...
2026-01-02 11:47:15.724 | INFO     | __main__:<lambda>:409 | ‚úÖ GATT application registada!
2026-01-02 11:47:15.724 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:47:15.827 | INFO     | __main__:<lambda>:423 | ‚úÖ Advertisement registado!
2026-01-02 11:47:59.476 | INFO     | __main__:signal_handler:528 | 
Sinal 2 recebido, a parar...
2026-01-02 11:47:59.476 | INFO     | __main__:stop:446 | A parar Sink Device...
2026-01-02 11:47:59.477 | INFO     | __main__:stop:458 | ‚úÖ Sink Device parado
2026-01-02 11:48:04.367 | INFO     | __main__:__init__:85 | A carregar certificados...
2026-01-02 11:48:04.370 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para af04ea89...
2026-01-02 11:48:04.370 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafael/repos/iot/certs
2026-01-02 11:48:04.370 | INFO     | __main__:__init__:115 | ‚úÖ Certificados carregados com sucesso
2026-01-02 11:48:04.370 | INFO     | __main__:__init__:123 | Sink NID: af04ea89...
2026-01-02 11:48:04.370 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 11:48:04.370 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 11:48:04.370 | INFO     | __main__:__init__:146 | Sink Device inicializado (adapter=hci0)
2026-01-02 11:48:04.370 | INFO     | __main__:start:392 | ============================================================
2026-01-02 11:48:04.370 | INFO     | __main__:start:393 |   A iniciar Sink Device
2026-01-02 11:48:04.370 | INFO     | __main__:start:394 | ============================================================
2026-01-02 11:48:04.370 | INFO     | __main__:setup_gatt_server:150 | A configurar GATT Server...
2026-01-02 11:48:04.371 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 11:48:04.371 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 11:48:04.372 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 11:48:04.372 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 11:48:04.372 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=af04ea89..., type=sink
2026-01-02 11:48:04.372 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 11:48:04.373 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 11:48:04.373 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 11:48:04.373 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 11:48:04.373 | INFO     | __main__:setup_gatt_server:188 | ‚úÖ GATT Server configurado
2026-01-02 11:48:04.373 | INFO     | __main__:start:401 | A registar GATT application no adaptador hci0...
2026-01-02 11:48:04.374 | INFO     | __main__:setup_advertising:192 | A configurar BLE Advertising...
2026-01-02 11:48:04.374 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 11:48:04.374 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 11:48:04.374 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:48:04.375 | INFO     | __main__:setup_advertising:203 | ‚úÖ BLE Advertising configurado
2026-01-02 11:48:04.375 | INFO     | __main__:start:417 | A registar advertisement no adaptador hci0...
2026-01-02 11:48:04.375 | INFO     | __main__:start_heartbeat_service:357 | üíì A iniciar servi√ßo de heartbeat...
2026-01-02 11:48:04.375 | INFO     | __main__:start_heartbeat_service:388 | ‚úÖ Servi√ßo de heartbeat iniciado
2026-01-02 11:48:04.375 | INFO     | __main__:start:434 | ‚úÖ Sink Device iniciado - a aguardar conex√µes...
2026-01-02 11:48:07.219 | INFO     | __main__:signal_handler:528 | 
Sinal 2 recebido, a parar...
2026-01-02 11:48:07.219 | INFO     | __main__:stop:446 | A parar Sink Device...
2026-01-02 11:48:07.220 | INFO     | __main__:stop:458 | ‚úÖ Sink Device parado
2026-01-02 11:48:12.402 | INFO     | __main__:__init__:85 | A carregar certificados...
2026-01-02 11:48:12.404 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para af04ea89...
2026-01-02 11:48:12.405 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafael/repos/iot/certs
2026-01-02 11:48:12.405 | INFO     | __main__:__init__:115 | ‚úÖ Certificados carregados com sucesso
2026-01-02 11:48:12.405 | INFO     | __main__:__init__:123 | Sink NID: af04ea89...
2026-01-02 11:48:12.405 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 11:48:12.405 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 11:48:12.405 | INFO     | __main__:__init__:146 | Sink Device inicializado (adapter=hci1)
2026-01-02 11:48:12.405 | INFO     | __main__:start:392 | ============================================================
2026-01-02 11:48:12.405 | INFO     | __main__:start:393 |   A iniciar Sink Device
2026-01-02 11:48:12.405 | INFO     | __main__:start:394 | ============================================================
2026-01-02 11:48:12.405 | INFO     | __main__:setup_gatt_server:150 | A configurar GATT Server...
2026-01-02 11:48:12.406 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 11:48:12.406 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 11:48:12.407 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 11:48:12.407 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 11:48:12.407 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=af04ea89..., type=sink
2026-01-02 11:48:12.407 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 11:48:12.408 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 11:48:12.408 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 11:48:12.408 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 11:48:12.408 | INFO     | __main__:setup_gatt_server:188 | ‚úÖ GATT Server configurado
2026-01-02 11:48:12.408 | INFO     | __main__:start:401 | A registar GATT application no adaptador hci1...
2026-01-02 11:48:12.409 | INFO     | __main__:setup_advertising:192 | A configurar BLE Advertising...
2026-01-02 11:48:12.409 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 11:48:12.409 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 11:48:12.409 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:48:12.410 | INFO     | __main__:setup_advertising:203 | ‚úÖ BLE Advertising configurado
2026-01-02 11:48:12.410 | INFO     | __main__:start:417 | A registar advertisement no adaptador hci1...
2026-01-02 11:48:12.410 | INFO     | __main__:start_heartbeat_service:357 | üíì A iniciar servi√ßo de heartbeat...
2026-01-02 11:48:12.410 | INFO     | __main__:start_heartbeat_service:388 | ‚úÖ Servi√ßo de heartbeat iniciado
2026-01-02 11:48:12.411 | INFO     | __main__:start:434 | ‚úÖ Sink Device iniciado - a aguardar conex√µes...
2026-01-02 11:48:12.415 | INFO     | __main__:<lambda>:409 | ‚úÖ GATT application registada!
2026-01-02 11:48:12.415 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:48:12.519 | INFO     | __main__:<lambda>:423 | ‚úÖ Advertisement registado!
2026-01-02 11:52:44.479 | INFO     | __main__:__init__:81 | A carregar certificados...
2026-01-02 11:52:44.562 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 69f0365f...
2026-01-02 11:52:44.562 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 11:52:44.563 | INFO     | __main__:__init__:111 | ‚úÖ Certificados carregados com sucesso
2026-01-02 11:52:44.563 | ERROR    | __main__:main:921 | Erro ao iniciar IoT Node: Certificado fornecido √© de um Sink, n√£o de um Node!
2026-01-02 11:53:03.937 | INFO     | __main__:__init__:81 | A carregar certificados...
2026-01-02 11:53:03.960 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 323b6aad...
2026-01-02 11:53:03.961 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 11:53:03.961 | INFO     | __main__:__init__:111 | ‚úÖ Certificados carregados com sucesso
2026-01-02 11:53:03.962 | INFO     | __main__:__init__:119 | Node NID: 323b6aad...
2026-01-02 11:53:03.962 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 11:53:03.962 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 11:53:04.071 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_115304.log
2026-01-02 11:53:04.071 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 11:53:04.072 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 11:53:04.072 | INFO     | __main__:__init__:171 | IoT Node inicializado (adapter=hci0)
2026-01-02 11:53:04.072 | INFO     | __main__:run:788 | ============================================================
2026-01-02 11:53:04.073 | INFO     | __main__:run:789 |   A iniciar IoT Node (dual-mode)
2026-01-02 11:53:04.073 | INFO     | __main__:run:790 | ============================================================
2026-01-02 11:53:04.074 | INFO     | __main__:setup_gatt_server:175 | A configurar GATT Server...
2026-01-02 11:53:04.076 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 11:53:04.076 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 11:53:04.077 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 11:53:04.078 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 11:53:04.078 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=323b6aad..., type=node
2026-01-02 11:53:04.079 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 11:53:04.079 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 11:53:04.080 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 11:53:04.080 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 11:53:04.082 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 11:53:04.082 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:04.083 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:53:04.085 | INFO     | __main__:setup_gatt_server:218 | ‚úÖ GATT Server configurado
2026-01-02 11:53:04.085 | INFO     | __main__:start_gatt_server:222 | A iniciar GATT Server...
2026-01-02 11:53:04.089 | INFO     | __main__:start_gatt_server:251 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 11:53:04.090 | INFO     | __main__:run:798 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 11:53:04.090 | INFO     | __main__:discover_sink:323 | üîç A procurar Sink...
2026-01-02 11:53:04.091 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 11:53:04.094 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_115304-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 11:53:04.244 | INFO     | __main__:<lambda>:234 | ‚úÖ GATT application registada!
2026-01-02 11:53:04.245 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:53:04.357 | INFO     | __main__:<lambda>:242 | ‚úÖ Advertisement registado!
2026-01-02 11:53:09.361 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 11:53:09.361 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_115304-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 11:53:09.362 | INFO     | __main__:discover_sink:330 | Encontrados 1 dispositivos IoT
2026-01-02 11:53:09.363 | INFO     | __main__:discover_sink:347 | ‚úÖ Sink encontrado: IoT-Sink-af04ea89 (E0:D3:62:D6:EE:A0) RSSI: -50 dBm
2026-01-02 11:53:09.364 | INFO     | __main__:connect_to_sink:367 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 11:53:09.365 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 11:53:09.365 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_115304-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 11:53:13.367 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 11:53:13.368 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_115304-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 4001.04ms
2026-01-02 11:53:13.371 | INFO     | __main__:connect_to_sink:380 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 11:53:13.382 | INFO     | __main__:connect_to_sink:393 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 11:53:13.384 | INFO     | __main__:_subscribe_to_notifications:402 | A subscrever a notifica√ß√µes...
2026-01-02 11:53:13.853 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:13.853 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_115304-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:13.855 | INFO     | __main__:_subscribe_to_notifications:411 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 11:53:13.954 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_115304-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: af04ea89a60e42f5b1e940dfed46b83aff01 | ASCII: ......B...@..F.:..
2026-01-02 11:53:13.955 | INFO     | __main__:_update_hop_count_from_uplink:773 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 11:53:13.956 | INFO     | __main__:authenticate_with_sink:537 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 11:53:14.053 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:14.053 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_115304-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:14.054 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 323b6aad...
2026-01-02 11:53:14.054 | INFO     | __main__:authenticate_with_sink:568 | üì§ Enviando certificado...
2026-01-02 11:53:14.055 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 11:53:14.068 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 883 bytes
2026-01-02 11:53:14.069 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 886 bytes em 5 fragmentos
2026-01-02 11:53:14.073 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115304-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103732d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435944434341634b674177494241674955486636554f3969687439 | ASCII: .....s-----BEGIN CERTIFICATE-----.MIICYDCCAcKgAwIBAgIUHf6UO9iht9 [TRUNCATED]
2026-01-02 11:53:14.203 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115304-0010] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:14.305 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115304-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 11:53:14.453 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115304-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:14.557 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115304-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d4467595941424142664245354466352f3950305a36666765433779695630392f510a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABABfBE5Df5/9P0Z6fgeC7yiV09/Q. [TRUNCATED]
2026-01-02 11:53:14.703 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115304-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:14.807 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115304-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003056d64736d77766d2b64490a68486d6a76306870486a314f74686b6f7172337052614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...mdsmwvm+dI.hHmjv0hpHj1Othkoqr3pRaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 11:53:14.953 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115304-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:15.056 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115304-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 169 bytes | Hex: 02040538354d77556f4c79796e386b772f3437496f7053317a75452f0a673277354b562f58494c575949335556555768706e7334435153564e44655563397764 | ASCII: ...85MwUoLyyn8kw/47IopS1zuE/.g2w5KV/XILWYI3UVUWhpns4CQSVNDeUc9wd [TRUNCATED]
2026-01-02 11:53:15.204 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115304-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:15.206 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0019] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203ac000003882d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943627a4343416447674177494241674955637a61794137 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICbzCCAdGgAwIBAgIUczayA7 [TRUNCATED]
2026-01-02 11:53:15.209 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 6 fragmentos
2026-01-02 11:53:15.306 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0020] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449314d54497a4d4441784d6a67314e566f580a44544d314d5449794f4441 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI1MTIzMDAxMjg1NVoX.DTM1MTIyODA [TRUNCATED]
2026-01-02 11:53:15.409 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0021] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064d3245784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d4467595941424146636c | ASCII: ...M2ExDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAFcl [TRUNCATED]
2026-01-02 11:53:15.507 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0022] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003066f72476e2f714162545a42442f720a4263547470423468635a7a494b78594d383269486d74724b6f504f754b6846564c625031655750704c714d344d44 | ASCII: ...orGn/qAbTZBD/r.BcTtpB4hcZzIKxYM82iHmtrKoPOuKhFVLbP1eWPpLqM4MD [TRUNCATED]
2026-01-02 11:53:15.608 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004064d706d5553774731624a48304b52784a504a614a554830782f694c364e0a6c5263765068685a66393737766d44433452333958354f2f44534e31736264 | ASCII: ...MpmUSwG1bJH0KRxJPJaJUH0x/iL6N.lRcvPhhZf977vmDC4R39X5O/DSN1sbd [TRUNCATED]
2026-01-02 11:53:15.705 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0024] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 46 bytes | Hex: 02050649434154452d2d2d2d2d0a35e52120436f99498ae828160332c0cae49b96c20bfb6dcc4f57ec73977a37f4 | ASCII: ...ICATE-----.5.! Co.I..(..2........m.OW.s.z7.
2026-01-02 11:53:15.707 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 943 bytes (6 fragmentos)
2026-01-02 11:53:15.811 | INFO     | common.security.authentication:handle_challenge:221 | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-02 11:53:15.812 | INFO     | common.security.authentication:handle_challenge:240 | üìú Extraindo certificado do peer do payload...
2026-01-02 11:53:15.833 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2026-01-02 11:53:15.834 | INFO     | common.security.authentication:handle_challenge:253 | ‚úÖ Certificado do peer validado!
2026-01-02 11:53:15.834 | INFO     | common.security.authentication:handle_challenge:254 |    Peer NID: af04ea89...
2026-01-02 11:53:15.835 | INFO     | common.security.authentication:handle_challenge:255 |    Peer tipo: SINK
2026-01-02 11:53:15.851 | INFO     | common.security.authentication:handle_challenge:271 | ‚úçÔ∏è  Response gerada: 139 bytes
2026-01-02 11:53:15.855 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115304-0025] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 145 bytes | Hex: 03000103008b308188024201cec77f87942429e657bf1dc8e6d02bef393a401319de56aa5badf862aaf925feaff49b137e0c3c8d671e5ecbca3441d847da1a86 | ASCII: ......0...B......$).W.....+.9:@...V.[..b..%.....~.<.g.^..4A.G... [TRUNCATED]
2026-01-02 11:53:15.953 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115304-0026] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:15.955 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0027] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-02 11:53:15.960 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 11:53:15.961 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-02 11:53:16.459 | INFO     | common.security.authentication:handle_auth_success:331 | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-02 11:53:16.460 | INFO     | __main__:authenticate_with_sink:600 | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-02 11:53:16.499 | INFO     | __main__:authenticate_with_sink:607 | üîë Session key estabelecida
2026-01-02 11:53:16.499 | INFO     | __main__:run:828 | ============================================================
2026-01-02 11:53:16.500 | INFO     | __main__:run:829 | ‚úÖ Node pronto! Uplink conectado (hop=0)
2026-01-02 11:53:16.500 | INFO     | __main__:run:830 | ============================================================
2026-01-02 11:53:17.354 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115304-0028] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: af04ea89a60e42f5b1e940dfed46b83aaf04ea89a60e42f5b1e940dfed46b83a02010000003da2c67165d78834fc6a95ee98d735dd421499336b432501693b61 | ASCII: ......B...@..F.:......B...@..F.:.....=..qe..4.j....5.B..3kC%.i;a [TRUNCATED]
2026-01-02 11:53:17.356 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 11:53:17.356 | WARNING  | common.protocol.heartbeat:verify_signature:214 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 11:53:17.356 | ERROR    | __main__:_handle_heartbeat:466 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 11:53:18.340 | INFO     | __main__:signal_handler:911 | 
Sinal 15 recebido, a parar...
2026-01-02 11:53:18.341 | INFO     | __main__:stop:857 | A parar Node...
2026-01-02 11:53:18.341 | INFO     | __main__:stop_gatt_server:255 | A parar GATT Server...
2026-01-02 11:53:18.344 | INFO     | __main__:stop_gatt_server:263 | ‚úÖ GATT Server parado
2026-01-02 11:53:20.965 | INFO     | common.ble.gatt_client:disconnect:297 | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 11:53:20.966 | INFO     | common.utils.ble_logger:log_disconnection:187 | [OP-20260102_115304-0029] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 11:53:20.966 | INFO     | __main__:stop:870 | ‚úÖ Node parado
2026-01-02 11:53:20.967 | WARNING  | __main__:run:838 | ‚ö†Ô∏è  Conex√£o perdida com Sink
2026-01-02 11:53:20.967 | INFO     | __main__:stop:857 | A parar Node...
2026-01-02 11:53:20.968 | INFO     | __main__:stop_gatt_server:255 | A parar GATT Server...
2026-01-02 11:53:20.968 | INFO     | __main__:stop_gatt_server:263 | ‚úÖ GATT Server parado
2026-01-02 11:53:20.968 | INFO     | __main__:stop:870 | ‚úÖ Node parado
2026-01-02 11:53:36.987 | INFO     | __main__:__init__:81 | A carregar certificados...
2026-01-02 11:53:36.991 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 323b6aad...
2026-01-02 11:53:36.992 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 11:53:36.992 | INFO     | __main__:__init__:111 | ‚úÖ Certificados carregados com sucesso
2026-01-02 11:53:36.992 | INFO     | __main__:__init__:119 | Node NID: 323b6aad...
2026-01-02 11:53:36.993 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 11:53:36.993 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 11:53:37.012 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_115336.log
2026-01-02 11:53:37.013 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 11:53:37.014 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 11:53:37.014 | INFO     | __main__:__init__:171 | IoT Node inicializado (adapter=hci0)
2026-01-02 11:53:37.014 | INFO     | __main__:run:788 | ============================================================
2026-01-02 11:53:37.015 | INFO     | __main__:run:789 |   A iniciar IoT Node (dual-mode)
2026-01-02 11:53:37.015 | INFO     | __main__:run:790 | ============================================================
2026-01-02 11:53:37.017 | INFO     | __main__:setup_gatt_server:175 | A configurar GATT Server...
2026-01-02 11:53:37.019 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 11:53:37.019 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 11:53:37.020 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 11:53:37.021 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 11:53:37.022 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=323b6aad..., type=node
2026-01-02 11:53:37.023 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 11:53:37.024 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 11:53:37.026 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 11:53:37.027 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 11:53:37.028 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 11:53:37.029 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:37.029 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:53:37.030 | INFO     | __main__:setup_gatt_server:218 | ‚úÖ GATT Server configurado
2026-01-02 11:53:37.031 | INFO     | __main__:start_gatt_server:222 | A iniciar GATT Server...
2026-01-02 11:53:37.033 | INFO     | __main__:start_gatt_server:251 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 11:53:37.036 | INFO     | __main__:run:798 | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 11:53:37.037 | INFO     | __main__:discover_sink:323 | üîç A procurar Sink...
2026-01-02 11:53:37.041 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 11:53:37.043 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_115336-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 11:53:37.117 | INFO     | __main__:<lambda>:234 | ‚úÖ GATT application registada!
2026-01-02 11:53:37.118 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 11:53:37.230 | INFO     | __main__:<lambda>:242 | ‚úÖ Advertisement registado!
2026-01-02 11:53:42.236 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 11:53:42.237 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_115336-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 11:53:42.239 | INFO     | __main__:discover_sink:330 | Encontrados 1 dispositivos IoT
2026-01-02 11:53:42.240 | INFO     | __main__:discover_sink:347 | ‚úÖ Sink encontrado: IoT-Sink-af04ea89 (E0:D3:62:D6:EE:A0) RSSI: -49 dBm
2026-01-02 11:53:42.241 | INFO     | __main__:connect_to_sink:367 | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 11:53:42.242 | INFO     | common.ble.gatt_client:connect:262 | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 11:53:42.244 | INFO     | common.utils.ble_logger:log_connection_attempt:142 | [OP-20260102_115336-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 11:53:45.105 | INFO     | common.ble.gatt_client:connect:272 | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 11:53:45.106 | INFO     | common.utils.ble_logger:log_connection_success:157 | [OP-20260102_115336-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 2857.74ms
2026-01-02 11:53:45.107 | INFO     | __main__:connect_to_sink:380 | ‚úÖ Conectado ao Sink via GATT
2026-01-02 11:53:45.116 | INFO     | __main__:connect_to_sink:393 | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 11:53:45.118 | INFO     | __main__:_subscribe_to_notifications:402 | A subscrever a notifica√ß√µes...
2026-01-02 11:53:45.305 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:45.306 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_115336-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:45.307 | INFO     | __main__:_subscribe_to_notifications:411 | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 11:53:45.404 | INFO     | common.utils.ble_logger:log_read_response:236 | [OP-20260102_115336-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: af04ea89a60e42f5b1e940dfed46b83aff01 | ASCII: ......B...@..F.:..
2026-01-02 11:53:45.405 | INFO     | __main__:_update_hop_count_from_uplink:773 | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 11:53:45.405 | INFO     | __main__:authenticate_with_sink:537 | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 11:53:45.504 | INFO     | common.ble.gatt_client:subscribe_notifications:562 | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:45.505 | INFO     | common.utils.ble_logger:log_subscribe:348 | [OP-20260102_115336-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:45.506 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 323b6aad...
2026-01-02 11:53:45.507 | INFO     | __main__:authenticate_with_sink:568 | üì§ Enviando certificado...
2026-01-02 11:53:45.507 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 11:53:45.508 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 883 bytes
2026-01-02 11:53:45.509 | INFO     | common.ble.fragmentation:fragment_message:98 | Fragmentando mensagem de 886 bytes em 5 fragmentos
2026-01-02 11:53:45.513 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115336-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103732d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435944434341634b674177494241674955486636554f3969687439 | ASCII: .....s-----BEGIN CERTIFICATE-----.MIICYDCCAcKgAwIBAgIUHf6UO9iht9 [TRUNCATED]
2026-01-02 11:53:45.653 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115336-0010] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:45.756 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115336-0011] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 11:53:45.904 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115336-0012] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:46.007 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115336-0013] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d4467595941424142664245354466352f3950305a36666765433779695630392f510a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABABfBE5Df5/9P0Z6fgeC7yiV09/Q. [TRUNCATED]
2026-01-02 11:53:46.153 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115336-0014] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:46.257 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115336-0015] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003056d64736d77766d2b64490a68486d6a76306870486a314f74686b6f7172337052614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...mdsmwvm+dI.hHmjv0hpHj1Othkoqr3pRaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 11:53:46.404 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115336-0016] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:46.506 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115336-0017] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 169 bytes | Hex: 02040538354d77556f4c79796e386b772f3437496f7053317a75452f0a673277354b562f58494c575949335556555768706e7334435153564e44655563397764 | ASCII: ...85MwUoLyyn8kw/47IopS1zuE/.g2w5KV/XILWYI3UVUWhpns4CQSVNDeUc9wd [TRUNCATED]
2026-01-02 11:53:46.654 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115336-0018] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:46.656 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0019] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203ac000003882d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943627a4343416447674177494241674955637a61794137 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICbzCCAdGgAwIBAgIUczayA7 [TRUNCATED]
2026-01-02 11:53:46.658 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 6 fragmentos
2026-01-02 11:53:46.754 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0020] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449314d54497a4d4441784d6a67314e566f580a44544d314d5449794f4441 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI1MTIzMDAxMjg1NVoX.DTM1MTIyODA [TRUNCATED]
2026-01-02 11:53:46.858 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0021] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064d3245784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d4467595941424146636c | ASCII: ...M2ExDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAFcl [TRUNCATED]
2026-01-02 11:53:46.958 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0022] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0003066f72476e2f714162545a42442f720a4263547470423468635a7a494b78594d383269486d74724b6f504f754b6846564c625031655750704c714d344d44 | ASCII: ...orGn/qAbTZBD/r.BcTtpB4hcZzIKxYM82iHmtrKoPOuKhFVLbP1eWPpLqM4MD [TRUNCATED]
2026-01-02 11:53:47.057 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004064d706d5553774731624a48304b52784a504a614a554830782f694c364e0a6c5263765068685a66393737766d44433452333958354f2f44534e31736264 | ASCII: ...MpmUSwG1bJH0KRxJPJaJUH0x/iL6N.lRcvPhhZf977vmDC4R39X5O/DSN1sbd [TRUNCATED]
2026-01-02 11:53:47.154 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0024] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 46 bytes | Hex: 02050649434154452d2d2d2d2d0ae8cc81cd0b04c360abf165b826c3f1ad72b305adb3b5cc65be88cdd75240c8bf | ASCII: ...ICATE-----........`..e.&...r......e....R@..
2026-01-02 11:53:47.155 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 943 bytes (6 fragmentos)
2026-01-02 11:53:47.257 | INFO     | common.security.authentication:handle_challenge:221 | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-02 11:53:47.258 | INFO     | common.security.authentication:handle_challenge:240 | üìú Extraindo certificado do peer do payload...
2026-01-02 11:53:47.262 | INFO     | common.security.certificate_manager:validate_certificate:262 | ‚úÖ Certificado validado com sucesso
2026-01-02 11:53:47.262 | INFO     | common.security.authentication:handle_challenge:253 | ‚úÖ Certificado do peer validado!
2026-01-02 11:53:47.263 | INFO     | common.security.authentication:handle_challenge:254 |    Peer NID: af04ea89...
2026-01-02 11:53:47.264 | INFO     | common.security.authentication:handle_challenge:255 |    Peer tipo: SINK
2026-01-02 11:53:47.266 | INFO     | common.security.authentication:handle_challenge:271 | ‚úçÔ∏è  Response gerada: 138 bytes
2026-01-02 11:53:47.269 | INFO     | common.utils.ble_logger:log_write_request:270 | [OP-20260102_115336-0025] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 144 bytes | Hex: 03000103008a30818702417917749758a63717ac960d570f5b09990f91dd2039fdb4b6a3738080916a43bf606c63401dde201823cc92e7500ca1d4ac89087e0f | ASCII: ......0...Ay.t.X.7....W.[..... 9....s...jC.`lc@.. .#...P......~. [TRUNCATED]
2026-01-02 11:53:47.354 | INFO     | common.utils.ble_logger:log_write_response:296 | [OP-20260102_115336-0026] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 11:53:47.355 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0027] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: af04ea89a60e42f5b1e940dfed46b83aaf04ea89a60e42f5b1e940dfed46b83a020100000043be749ad7e231ba201be1338234772e2bd7447eff48effeb3c7aa | ASCII: ......B...@..F.:......B...@..F.:.....C.t...1. ..3.4w.+.D~.H..... [TRUNCATED]
2026-01-02 11:53:47.356 | INFO     | __main__:_handle_heartbeat:451 | Sink NID identificado: af04ea89...
2026-01-02 11:53:47.357 | WARNING  | common.protocol.heartbeat:verify_signature:185 | ‚ö†Ô∏è  Certificado do Sink n√£o dispon√≠vel para verifica√ß√£o
2026-01-02 11:53:47.357 | ERROR    | __main__:_handle_heartbeat:466 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 11:53:47.358 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0028] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-02 11:53:47.359 | INFO     | common.ble.fragmentation:add_fragment:165 | Iniciando recep√ß√£o de 1 fragmentos
2026-01-02 11:53:47.359 | INFO     | common.ble.fragmentation:add_fragment:203 | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-02 11:53:47.857 | INFO     | common.security.authentication:handle_auth_success:331 | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-02 11:53:47.858 | INFO     | __main__:authenticate_with_sink:600 | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-02 11:53:47.867 | INFO     | __main__:authenticate_with_sink:607 | üîë Session key estabelecida
2026-01-02 11:53:47.869 | INFO     | __main__:run:828 | ============================================================
2026-01-02 11:53:47.870 | INFO     | __main__:run:829 | ‚úÖ Node pronto! Uplink conectado (hop=0)
2026-01-02 11:53:47.871 | INFO     | __main__:run:830 | ============================================================
2026-01-02 11:53:52.355 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0029] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: af04ea89a60e42f5b1e940dfed46b83aaf04ea89a60e42f5b1e940dfed46b83a0201000000448bfa25b609fc358809310314c383edb5cc3f0b013e6fc0add0b6 | ASCII: ......B...@..F.:......B...@..F.:.....D..%...5..1.......?..>o.... [TRUNCATED]
2026-01-02 11:53:52.361 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 11:53:52.362 | WARNING  | common.protocol.heartbeat:verify_signature:214 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 11:53:52.363 | ERROR    | __main__:_handle_heartbeat:466 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 11:53:57.355 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0030] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: af04ea89a60e42f5b1e940dfed46b83aaf04ea89a60e42f5b1e940dfed46b83a02010000004572d9d6cb179d5a2da14d5868db8b0d5c81e14f0415613bef760c | ASCII: ......B...@..F.:......B...@..F.:.....Er.....Z-.MXh...\..O..a;.v. [TRUNCATED]
2026-01-02 11:53:57.361 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 11:53:57.362 | WARNING  | common.protocol.heartbeat:verify_signature:214 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 11:53:57.363 | ERROR    | __main__:_handle_heartbeat:466 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 11:54:02.355 | INFO     | common.utils.ble_logger:log_notification:324 | [OP-20260102_115336-0031] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: af04ea89a60e42f5b1e940dfed46b83aaf04ea89a60e42f5b1e940dfed46b83a020100000046f72ce6152080753e4a4141165d2ffac68558742c9c441f3fe94e | ASCII: ......B...@..F.:......B...@..F.:.....F.,.. .u>JAA.]/...Xt,.D.?.N [TRUNCATED]
2026-01-02 11:54:02.359 | WARNING  | common.security.certificate_manager:verify_signature:384 | ‚ùå Assinatura inv√°lida
2026-01-02 11:54:02.360 | WARNING  | common.protocol.heartbeat:verify_signature:214 | ‚ùå Assinatura de heartbeat inv√°lida
2026-01-02 11:54:02.363 | ERROR    | __main__:_handle_heartbeat:466 | ‚ùå Assinatura de heartbeat inv√°lida!
2026-01-02 11:54:03.783 | INFO     | __main__:signal_handler:911 | 
Sinal 2 recebido, a parar...
2026-01-02 11:54:03.784 | INFO     | __main__:stop:857 | A parar Node...
2026-01-02 11:54:03.784 | INFO     | __main__:stop_gatt_server:255 | A parar GATT Server...
2026-01-02 12:09:21.558 | INFO     | node.iot_node:__init__:81 | A carregar certificados...
2026-01-02 12:09:21.563 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 323b6aad...
2026-01-02 12:09:21.563 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 12:09:21.563 | INFO     | node.iot_node:__init__:111 | ‚úÖ Certificados carregados com sucesso
2026-01-02 12:09:21.563 | INFO     | node.iot_node:__init__:119 | Node NID: 323b6aad...
2026-01-02 12:09:21.564 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 12:09:21.564 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 12:09:21.618 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_120921.log
2026-01-02 12:09:21.619 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 12:09:21.619 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 12:09:21.620 | INFO     | node.iot_node:__init__:171 | IoT Node inicializado (adapter=hci0)
2026-01-02 12:09:21.620 | INFO     | node.iot_node:setup_gatt_server:175 | A configurar GATT Server...
2026-01-02 12:09:21.623 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 12:09:21.623 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 12:09:21.624 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 12:09:21.624 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 12:09:21.626 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=323b6aad..., type=node
2026-01-02 12:09:21.629 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 12:09:21.632 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 12:09:21.642 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 12:09:21.644 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 12:09:21.645 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 12:09:21.646 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 12:09:21.646 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:09:21.647 | INFO     | node.iot_node:setup_gatt_server:218 | ‚úÖ GATT Server configurado
2026-01-02 12:09:21.647 | INFO     | node.iot_node:start_gatt_server:222 | A iniciar GATT Server...
2026-01-02 12:09:21.651 | INFO     | node.iot_node:start_gatt_server:251 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 12:09:21.652 | INFO     | __main__:main:466 | ‚úÖ Node Device iniciado - CLI interativo pronto
2026-01-02 12:09:21.785 | INFO     | node.iot_node:<lambda>:234 | ‚úÖ GATT application registada!
2026-01-02 12:09:21.787 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:09:21.885 | INFO     | node.iot_node:<lambda>:242 | ‚úÖ Advertisement registado!
2026-01-02 12:09:25.766 | INFO     | node.iot_node:stop:857 | A parar Node...
2026-01-02 12:09:25.767 | INFO     | node.iot_node:stop_gatt_server:255 | A parar GATT Server...
2026-01-02 12:09:25.768 | INFO     | node.iot_node:stop_gatt_server:263 | ‚úÖ GATT Server parado
2026-01-02 12:09:25.769 | INFO     | node.iot_node:stop:870 | ‚úÖ Node parado
2026-01-02 12:11:32.748 | INFO     | node.iot_node:__init__:81 | A carregar certificados...
2026-01-02 12:11:32.752 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 323b6aad...
2026-01-02 12:11:32.752 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 12:11:32.753 | INFO     | node.iot_node:__init__:111 | ‚úÖ Certificados carregados com sucesso
2026-01-02 12:11:32.753 | INFO     | node.iot_node:__init__:119 | Node NID: 323b6aad...
2026-01-02 12:11:32.753 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 12:11:32.754 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 12:11:32.771 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_121132.log
2026-01-02 12:11:32.772 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 12:11:32.772 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 12:11:32.773 | INFO     | node.iot_node:__init__:171 | IoT Node inicializado (adapter=hci0)
2026-01-02 12:11:32.775 | INFO     | node.iot_node:setup_gatt_server:175 | A configurar GATT Server...
2026-01-02 12:11:32.779 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 12:11:32.780 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 12:11:32.780 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 12:11:32.782 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 12:11:32.784 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=323b6aad..., type=node
2026-01-02 12:11:32.786 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 12:11:32.788 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 12:11:32.790 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 12:11:32.790 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 12:11:32.791 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 12:11:32.793 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 12:11:32.794 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:11:32.795 | INFO     | node.iot_node:setup_gatt_server:218 | ‚úÖ GATT Server configurado
2026-01-02 12:11:32.796 | INFO     | node.iot_node:start_gatt_server:222 | A iniciar GATT Server...
2026-01-02 12:11:32.799 | INFO     | node.iot_node:start_gatt_server:251 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 12:11:32.801 | INFO     | __main__:main:466 | ‚úÖ Node Device iniciado - CLI interativo pronto
2026-01-02 12:11:32.870 | INFO     | node.iot_node:<lambda>:234 | ‚úÖ GATT application registada!
2026-01-02 12:11:32.871 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:11:32.968 | INFO     | node.iot_node:<lambda>:242 | ‚úÖ Advertisement registado!
2026-01-02 12:11:48.256 | INFO     | node.iot_node:discover_sink:323 | üîç A procurar Sink...
2026-01-02 12:11:48.258 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 12:11:48.259 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_121132-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 12:11:53.393 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 12:11:53.394 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_121132-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 12:11:53.396 | INFO     | node.iot_node:discover_sink:330 | Encontrados 1 dispositivos IoT
2026-01-02 12:11:53.397 | INFO     | node.iot_node:discover_sink:347 | ‚úÖ Sink encontrado: IoT-Sink-af04ea89 (E0:D3:62:D6:EE:A0) RSSI: -43 dBm
2026-01-02 12:12:56.732 | INFO     | node.iot_node:discover_sink:323 | üîç A procurar Sink...
2026-01-02 12:12:56.734 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 12:12:56.736 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_121132-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 12:13:01.861 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 12:13:01.862 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_121132-0004] SCAN_RESULT | Devices_Found: 0
2026-01-02 12:13:01.864 | INFO     | node.iot_node:discover_sink:330 | Encontrados 0 dispositivos IoT
2026-01-02 12:13:01.865 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 12:13:01.866 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_121132-0005] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 12:13:06.908 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 12:13:06.910 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_121132-0006] SCAN_RESULT | Devices_Found: 1
2026-01-02 12:13:06.911 | INFO     | node.iot_node:discover_sink:330 | Encontrados 1 dispositivos IoT
2026-01-02 12:13:06.913 | INFO     | node.iot_node:discover_sink:347 | ‚úÖ Sink encontrado: IoT-Sink-af04ea89 (E0:D3:62:D6:EE:A0) RSSI: -48 dBm
2026-01-02 12:13:37.558 | INFO     | node.iot_node:discover_sink:323 | üîç A procurar Sink...
2026-01-02 12:13:37.560 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 12:13:37.562 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_121132-0007] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 12:13:42.767 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 12:13:42.769 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_121132-0008] SCAN_RESULT | Devices_Found: 0
2026-01-02 12:13:42.771 | INFO     | node.iot_node:discover_sink:330 | Encontrados 0 dispositivos IoT
2026-01-02 12:13:42.772 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 12:13:42.774 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_121132-0009] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 12:13:47.833 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 12:13:47.834 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_121132-0010] SCAN_RESULT | Devices_Found: 1
2026-01-02 12:13:47.836 | INFO     | node.iot_node:discover_sink:330 | Encontrados 1 dispositivos IoT
2026-01-02 12:13:47.837 | INFO     | node.iot_node:discover_sink:347 | ‚úÖ Sink encontrado: IoT-Sink-af04ea89 (E0:D3:62:D6:EE:A0) RSSI: -43 dBm
2026-01-02 12:14:02.920 | INFO     | node.iot_node:stop:857 | A parar Node...
2026-01-02 12:14:02.921 | INFO     | node.iot_node:stop_gatt_server:255 | A parar GATT Server...
2026-01-02 12:14:02.924 | INFO     | node.iot_node:stop_gatt_server:263 | ‚úÖ GATT Server parado
2026-01-02 12:14:02.925 | INFO     | node.iot_node:stop:870 | ‚úÖ Node parado
2026-01-02 12:14:02.928 | INFO     | node.iot_node:stop:857 | A parar Node...
2026-01-02 12:14:02.929 | INFO     | node.iot_node:stop_gatt_server:255 | A parar GATT Server...
2026-01-02 12:14:02.930 | INFO     | node.iot_node:stop_gatt_server:263 | ‚úÖ GATT Server parado
2026-01-02 12:14:02.931 | INFO     | node.iot_node:stop:870 | ‚úÖ Node parado
2026-01-02 12:14:06.295 | INFO     | node.iot_node:__init__:81 | A carregar certificados...
2026-01-02 12:14:06.299 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 323b6aad...
2026-01-02 12:14:06.299 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2026-01-02 12:14:06.300 | INFO     | node.iot_node:__init__:111 | ‚úÖ Certificados carregados com sucesso
2026-01-02 12:14:06.300 | INFO     | node.iot_node:__init__:119 | Node NID: 323b6aad...
2026-01-02 12:14:06.300 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 12:14:06.301 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 12:14:06.322 | INFO     | common.utils.ble_logger:__init__:49 | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_121406.log
2026-01-02 12:14:06.322 | INFO     | common.ble.gatt_client:__init__:151 | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 12:14:06.323 | INFO     | common.ble.gatt_client:__init__:619 | BLE Client iniciado
2026-01-02 12:14:06.323 | INFO     | node.iot_node:__init__:171 | IoT Node inicializado (adapter=hci0)
2026-01-02 12:14:06.325 | INFO     | node.iot_node:setup_gatt_server:175 | A configurar GATT Server...
2026-01-02 12:14:06.327 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 12:14:06.330 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 12:14:06.330 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 12:14:06.331 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 12:14:06.333 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=323b6aad..., type=node
2026-01-02 12:14:06.334 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 12:14:06.336 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 12:14:06.338 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 12:14:06.340 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 12:14:06.341 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 12:14:06.343 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 12:14:06.343 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:14:06.347 | INFO     | node.iot_node:setup_gatt_server:218 | ‚úÖ GATT Server configurado
2026-01-02 12:14:06.348 | INFO     | node.iot_node:start_gatt_server:222 | A iniciar GATT Server...
2026-01-02 12:14:06.350 | INFO     | node.iot_node:start_gatt_server:251 | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 12:14:06.351 | INFO     | __main__:main:466 | ‚úÖ Node Device iniciado - CLI interativo pronto
2026-01-02 12:14:06.437 | INFO     | node.iot_node:<lambda>:234 | ‚úÖ GATT application registada!
2026-01-02 12:14:06.438 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:14:06.537 | INFO     | node.iot_node:<lambda>:242 | ‚úÖ Advertisement registado!
2026-01-02 12:14:07.993 | INFO     | node.iot_node:discover_sink:323 | üîç A procurar Sink...
2026-01-02 12:14:07.994 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 12:14:07.995 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_121406-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 12:14:13.025 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-02 12:14:13.026 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_121406-0002] SCAN_RESULT | Devices_Found: 0
2026-01-02 12:14:13.027 | INFO     | node.iot_node:discover_sink:330 | Encontrados 0 dispositivos IoT
2026-01-02 12:14:13.029 | INFO     | common.ble.gatt_client:scan:178 | A fazer scan BLE durante 5000ms...
2026-01-02 12:14:13.031 | INFO     | common.utils.ble_logger:log_scan_start:105 | [OP-20260102_121406-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 12:14:18.070 | INFO     | common.ble.gatt_client:scan:218 | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 12:14:18.072 | INFO     | common.utils.ble_logger:log_scan_result:120 | [OP-20260102_121406-0004] SCAN_RESULT | Devices_Found: 1
2026-01-02 12:14:18.074 | INFO     | node.iot_node:discover_sink:330 | Encontrados 1 dispositivos IoT
2026-01-02 12:14:18.078 | INFO     | node.iot_node:discover_sink:347 | ‚úÖ Sink encontrado: IoT-Sink-af04ea89 (E0:D3:62:D6:EE:A0) RSSI: -45 dBm
2026-01-02 12:14:32.323 | INFO     | node.iot_node:stop:857 | A parar Node...
2026-01-02 12:14:32.325 | INFO     | node.iot_node:stop_gatt_server:255 | A parar GATT Server...
2026-01-02 12:14:32.328 | INFO     | node.iot_node:stop_gatt_server:263 | ‚úÖ GATT Server parado
2026-01-02 12:14:32.329 | INFO     | node.iot_node:stop:870 | ‚úÖ Node parado
2026-01-02 12:27:48.799 | INFO     | sink.sink_device:__init__:85 | A carregar certificados...
2026-01-02 12:27:48.801 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para af04ea89...
2026-01-02 12:27:48.802 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafael/repos/iot/certs
2026-01-02 12:27:48.802 | INFO     | sink.sink_device:__init__:115 | ‚úÖ Certificados carregados com sucesso
2026-01-02 12:27:48.802 | INFO     | sink.sink_device:__init__:123 | Sink NID: af04ea89...
2026-01-02 12:27:48.802 | INFO     | common.security.auth_handler:__init__:40 | AuthenticationHandler inicializado
2026-01-02 12:27:48.802 | INFO     | common.security.replay_protection:__init__:45 | ReplayProtection iniciado (window_size=100)
2026-01-02 12:27:48.802 | INFO     | sink.sink_device:__init__:146 | Sink Device inicializado (adapter=hci1)
2026-01-02 12:27:48.802 | INFO     | sink.sink_device:setup_gatt_server:150 | A configurar GATT Server...
2026-01-02 12:27:48.803 | INFO     | common.ble.gatt_server:__init__:372 | Application criada: /
2026-01-02 12:27:48.803 | INFO     | common.ble.gatt_server:__init__:309 | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 12:27:48.803 | INFO     | common.ble.gatt_services:__init__:551 | A criar IoTNetworkService...
2026-01-02 12:27:48.804 | INFO     | common.ble.gatt_services:__init__:75 | NetworkPacketCharacteristic criada
2026-01-02 12:27:48.804 | INFO     | common.ble.gatt_services:__init__:214 | DeviceInfoCharacteristic criada: NID=af04ea89..., type=sink
2026-01-02 12:27:48.804 | INFO     | common.ble.gatt_services:__init__:288 | NeighborTableCharacteristic criada
2026-01-02 12:27:48.804 | INFO     | common.ble.gatt_services:__init__:416 | AuthCharacteristic criada
2026-01-02 12:27:48.804 | INFO     | common.ble.gatt_services:__init__:565 | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 12:27:48.804 | INFO     | common.ble.gatt_server:add_service:381 | Service adicionado √† aplica√ß√£o: /0
2026-01-02 12:27:48.805 | INFO     | sink.sink_device:setup_gatt_server:188 | ‚úÖ GATT Server configurado
2026-01-02 12:27:48.805 | INFO     | sink.sink_device:setup_advertising:192 | A configurar BLE Advertising...
2026-01-02 12:27:48.805 | INFO     | common.ble.advertising:__init__:87 | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 12:27:48.805 | INFO     | common.ble.advertising:add_service_uuid:102 | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 12:27:48.805 | INFO     | common.ble.advertising:add_service_uuid:103 |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:27:48.805 | INFO     | sink.sink_device:setup_advertising:203 | ‚úÖ BLE Advertising configurado
2026-01-02 12:27:48.806 | INFO     | sink.sink_device:start_heartbeat_service:357 | üíì A iniciar servi√ßo de heartbeat...
2026-01-02 12:27:48.806 | INFO     | sink.sink_device:start_heartbeat_service:388 | ‚úÖ Servi√ßo de heartbeat iniciado
2026-01-02 12:27:48.807 | INFO     | __main__:main:346 | ‚úÖ Sink Device iniciado - CLI interativo pronto
2026-01-02 12:27:48.813 | INFO     | __main__:<lambda>:317 | ‚úÖ GATT application registada!
2026-01-02 12:27:48.813 | INFO     | common.ble.advertising:get_properties:156 | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 12:27:48.915 | INFO     | __main__:<lambda>:325 | ‚úÖ Advertisement registado!
