2025-12-30 00:13:40.482 | INFO     | __main__:main:306 | ============================================================
2025-12-30 00:13:40.483 | INFO     | __main__:main:307 |   Cliente BLE com Autentica√ß√£o X.509
2025-12-30 00:13:40.483 | INFO     | __main__:main:308 | ============================================================
2025-12-30 00:13:40.483 | INFO     | __main__:main:309 | 
üì± Client NID: 69f0365f...
2025-12-30 00:13:40.483 | INFO     | __main__:main:315 | 
üîê Carregando certificados...
2025-12-30 00:13:40.483 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 69f0365f...
2025-12-30 00:13:40.484 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2025-12-30 00:13:40.484 | INFO     | common.security.certificate_manager:initialize:150 | ============================================================
2025-12-30 00:13:40.484 | INFO     | common.security.certificate_manager:initialize:151 | A carregar certificados...
2025-12-30 00:13:40.484 | INFO     | common.security.certificate_manager:initialize:152 | ============================================================
2025-12-30 00:13:40.484 | ERROR    | common.security.certificate_manager:load_ca_certificate:124 | Certificado da CA n√£o encontrado: /home/rafa/IOT/IOT/certs/ca_certificate.pem
2025-12-30 00:13:40.485 | ERROR    | __main__:main:319 | ‚ùå Erro ao carregar certificados
2025-12-30 00:13:40.485 | ERROR    | __main__:main:320 | 
Verifique se existem certificados para este dispositivo:
2025-12-30 00:13:40.485 | ERROR    | __main__:main:321 |   certs/69f0365f-0b47-4449-8c75-558f4537cf85/certificate.pem
2025-12-30 00:13:40.485 | ERROR    | __main__:main:322 |   certs/69f0365f-0b47-4449-8c75-558f4537cf85/private_key.pem
2025-12-30 00:13:40.486 | ERROR    | __main__:main:323 |   certs/ca_certificate.pem
2025-12-30 00:13:48.792 | INFO     | __main__:main:306 | ============================================================
2025-12-30 00:13:48.792 | INFO     | __main__:main:307 |   Cliente BLE com Autentica√ß√£o X.509
2025-12-30 00:13:48.792 | INFO     | __main__:main:308 | ============================================================
2025-12-30 00:13:48.793 | INFO     | __main__:main:309 | 
üì± Client NID: 69f0365f...
2025-12-30 00:13:48.793 | INFO     | __main__:main:315 | 
üîê Carregando certificados...
2025-12-30 00:13:48.793 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 69f0365f...
2025-12-30 00:13:48.793 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2025-12-30 00:13:48.794 | INFO     | common.security.certificate_manager:initialize:150 | ============================================================
2025-12-30 00:13:48.794 | INFO     | common.security.certificate_manager:initialize:151 | A carregar certificados...
2025-12-30 00:13:48.794 | INFO     | common.security.certificate_manager:initialize:152 | ============================================================
2025-12-30 00:13:48.795 | ERROR    | common.security.certificate_manager:load_ca_certificate:124 | Certificado da CA n√£o encontrado: /home/rafa/IOT/IOT/certs/ca_certificate.pem
2025-12-30 00:13:48.795 | ERROR    | __main__:main:319 | ‚ùå Erro ao carregar certificados
2025-12-30 00:13:48.796 | ERROR    | __main__:main:320 | 
Verifique se existem certificados para este dispositivo:
2025-12-30 00:13:48.796 | ERROR    | __main__:main:321 |   certs/69f0365f-0b47-4449-8c75-558f4537cf85/certificate.pem
2025-12-30 00:13:48.796 | ERROR    | __main__:main:322 |   certs/69f0365f-0b47-4449-8c75-558f4537cf85/private_key.pem
2025-12-30 00:13:48.797 | ERROR    | __main__:main:323 |   certs/ca_certificate.pem
2025-12-30 00:18:39.650 | INFO     | __main__:main:306 | ============================================================
2025-12-30 00:18:39.650 | INFO     | __main__:main:307 |   Cliente BLE com Autentica√ß√£o X.509
2025-12-30 00:18:39.650 | INFO     | __main__:main:308 | ============================================================
2025-12-30 00:18:39.650 | INFO     | __main__:main:309 | 
üì± Client NID: 69f0365f...
2025-12-30 00:18:39.651 | INFO     | __main__:main:315 | 
üîê Carregando certificados...
2025-12-30 00:18:39.651 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 69f0365f...
2025-12-30 00:18:39.651 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2025-12-30 00:18:39.652 | INFO     | common.security.certificate_manager:initialize:150 | ============================================================
2025-12-30 00:18:39.652 | INFO     | common.security.certificate_manager:initialize:151 | A carregar certificados...
2025-12-30 00:18:39.652 | INFO     | common.security.certificate_manager:initialize:152 | ============================================================
2025-12-30 00:18:39.763 | INFO     | common.security.certificate_manager:load_ca_certificate:134 | ‚úÖ Certificado da CA carregado: /home/rafa/IOT/IOT/certs/ca_certificate.pem
2025-12-30 00:18:39.764 | INFO     | common.security.certificate_manager:load_ca_certificate:135 |    Serial: 390882065628549426367143608417965902030398535790
2025-12-30 00:18:39.806 | INFO     | common.security.certificate_manager:load_device_certificate:96 | ‚úÖ Certificado do dispositivo carregado: /home/rafa/IOT/IOT/certs/69f0365f-0b47-4449-8c75-558f4537cf85/certificate.pem
2025-12-30 00:18:39.807 | INFO     | common.security.certificate_manager:load_device_certificate:97 |    Serial: 595377818982776629124640282954716968146495279119
2025-12-30 00:18:39.817 | INFO     | common.security.certificate_manager:initialize:162 | ============================================================
2025-12-30 00:18:39.818 | INFO     | common.security.certificate_manager:initialize:163 | ‚úÖ Todos os certificados carregados com sucesso!
2025-12-30 00:18:39.818 | INFO     | common.security.certificate_manager:initialize:164 | ============================================================
2025-12-30 00:18:39.819 | INFO     | __main__:main:327 | 
üîí Criando protocolo de autentica√ß√£o...
2025-12-30 00:18:39.819 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 69f0365f...
2025-12-30 00:18:39.820 | INFO     | __main__:main:331 | 
üì° A escanear por servidores BLE...
2025-12-30 00:18:39.825 | INFO     | __main__:scan_for_server:69 | Usando adaptador: hci0 [A0:88:69:B6:F7:D2]
2025-12-30 00:18:39.825 | INFO     | __main__:scan_for_server:71 | A escanear por 5 segundos...
2025-12-30 00:18:45.031 | INFO     | __main__:scan_for_server:75 | Encontrados 1 dispositivos
2025-12-30 00:18:45.032 | INFO     | __main__:find_iot_server:102 | Servidor IoT encontrado: IoT-Auth-Server [E0:D3:62:D6:EE:A0]
2025-12-30 00:18:45.032 | INFO     | __main__:main:349 | 
üîó A conectar ao servidor: IoT-Auth-Server [E0:D3:62:D6:EE:A0]
2025-12-30 00:18:48.217 | INFO     | __main__:main:353 | ‚úÖ Conectado!
2025-12-30 00:18:48.218 | INFO     | __main__:authenticate_with_server:163 | 
============================================================
2025-12-30 00:18:48.218 | INFO     | __main__:authenticate_with_server:164 | üîê Iniciando Autentica√ß√£o
2025-12-30 00:18:48.219 | INFO     | __main__:authenticate_with_server:165 | ============================================================
2025-12-30 00:18:48.222 | INFO     | __main__:authenticate_with_server:185 | ‚úÖ AuthCharacteristic encontrada
2025-12-30 00:18:48.223 | INFO     | __main__:authenticate_with_server:186 |    Service: 12340000-0000-1000-8000-00805f9b34fb
2025-12-30 00:18:48.223 | INFO     | __main__:authenticate_with_server:187 |    Characteristic: 12340004-0000-1000-8000-00805f9b34fb
2025-12-30 00:18:48.224 | INFO     | __main__:authenticate_with_server:190 | 
üì° A subscrever indications de autentica√ß√£o...
2025-12-30 00:18:48.694 | INFO     | __main__:authenticate_with_server:198 | ‚úÖ Subscrito a indications
2025-12-30 00:18:48.695 | INFO     | __main__:authenticate_with_server:204 | 
--- Passo 1: Enviar certificado ao servidor ---
2025-12-30 00:18:48.696 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2025-12-30 00:18:48.697 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 908 bytes
2025-12-30 00:18:48.698 | INFO     | __main__:authenticate_with_server:206 | Enviando CERT_OFFER: 911 bytes
2025-12-30 00:18:49.294 | ERROR    | __main__:authenticate_with_server:216 | ‚ùå Erro ao enviar certificado: org.bluez.Error.InvalidArguments: Invalid Length
[70] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service00c2/char00cb org.bluez.GattCharacteristic1 WriteValue
2025-12-30 00:18:49.295 | ERROR    | __main__:main:360 | ‚ùå Autentica√ß√£o falhou
2025-12-30 00:22:43.121 | INFO     | __main__:main:318 | ============================================================
2025-12-30 00:22:43.122 | INFO     | __main__:main:319 |   Cliente BLE com Autentica√ß√£o X.509
2025-12-30 00:22:43.122 | INFO     | __main__:main:320 | ============================================================
2025-12-30 00:22:43.122 | INFO     | __main__:main:321 | 
üì± Client NID: 69f0365f...
2025-12-30 00:22:43.122 | INFO     | __main__:main:327 | 
üîê Carregando certificados...
2025-12-30 00:22:43.123 | INFO     | common.security.certificate_manager:__init__:57 | CertificateManager inicializado para 69f0365f...
2025-12-30 00:22:43.123 | INFO     | common.security.certificate_manager:__init__:58 |    Diret√≥rio de certificados: /home/rafa/IOT/IOT/certs
2025-12-30 00:22:43.123 | INFO     | common.security.certificate_manager:initialize:150 | ============================================================
2025-12-30 00:22:43.123 | INFO     | common.security.certificate_manager:initialize:151 | A carregar certificados...
2025-12-30 00:22:43.124 | INFO     | common.security.certificate_manager:initialize:152 | ============================================================
2025-12-30 00:22:43.127 | INFO     | common.security.certificate_manager:load_ca_certificate:134 | ‚úÖ Certificado da CA carregado: /home/rafa/IOT/IOT/certs/ca_certificate.pem
2025-12-30 00:22:43.128 | INFO     | common.security.certificate_manager:load_ca_certificate:135 |    Serial: 390882065628549426367143608417965902030398535790
2025-12-30 00:22:43.130 | INFO     | common.security.certificate_manager:load_device_certificate:96 | ‚úÖ Certificado do dispositivo carregado: /home/rafa/IOT/IOT/certs/69f0365f-0b47-4449-8c75-558f4537cf85/certificate.pem
2025-12-30 00:22:43.130 | INFO     | common.security.certificate_manager:load_device_certificate:97 |    Serial: 595377818982776629124640282954716968146495279119
2025-12-30 00:22:43.131 | INFO     | common.security.certificate_manager:initialize:162 | ============================================================
2025-12-30 00:22:43.131 | INFO     | common.security.certificate_manager:initialize:163 | ‚úÖ Todos os certificados carregados com sucesso!
2025-12-30 00:22:43.131 | INFO     | common.security.certificate_manager:initialize:164 | ============================================================
2025-12-30 00:22:43.131 | INFO     | __main__:main:339 | 
üîí Criando protocolo de autentica√ß√£o...
2025-12-30 00:22:43.131 | INFO     | common.security.authentication:__init__:126 | AuthenticationProtocol inicializado para 69f0365f...
2025-12-30 00:22:43.132 | INFO     | __main__:main:343 | 
üì° A escanear por servidores BLE...
2025-12-30 00:22:43.135 | INFO     | __main__:scan_for_server:69 | Usando adaptador: hci0 [A0:88:69:B6:F7:D2]
2025-12-30 00:22:43.137 | INFO     | __main__:scan_for_server:71 | A escanear por 5 segundos...
2025-12-30 00:22:48.344 | INFO     | __main__:scan_for_server:75 | Encontrados 1 dispositivos
2025-12-30 00:22:48.345 | INFO     | __main__:find_iot_server:102 | Servidor IoT encontrado: IoT-Auth-Server [E0:D3:62:D6:EE:A0]
2025-12-30 00:22:48.345 | INFO     | __main__:main:361 | 
üîó A conectar ao servidor: IoT-Auth-Server [E0:D3:62:D6:EE:A0]
2025-12-30 00:22:51.989 | INFO     | __main__:main:365 | ‚úÖ Conectado!
2025-12-30 00:22:51.989 | INFO     | __main__:main:371 | 
üìè Negociando MTU...
2025-12-30 00:22:51.990 | INFO     | __main__:main:376 |    MTU ser√° negociado automaticamente pelo BLE
2025-12-30 00:22:51.991 | INFO     | __main__:main:377 |    Certificados grandes podem precisar de write_command ou fragmenta√ß√£o
2025-12-30 00:22:51.991 | INFO     | __main__:authenticate_with_server:163 | 
============================================================
2025-12-30 00:22:51.991 | INFO     | __main__:authenticate_with_server:164 | üîê Iniciando Autentica√ß√£o
2025-12-30 00:22:51.992 | INFO     | __main__:authenticate_with_server:165 | ============================================================
2025-12-30 00:22:51.995 | INFO     | __main__:authenticate_with_server:185 | ‚úÖ AuthCharacteristic encontrada
2025-12-30 00:22:51.996 | INFO     | __main__:authenticate_with_server:186 |    Service: 12340000-0000-1000-8000-00805f9b34fb
2025-12-30 00:22:51.997 | INFO     | __main__:authenticate_with_server:187 |    Characteristic: 12340004-0000-1000-8000-00805f9b34fb
2025-12-30 00:22:51.997 | INFO     | __main__:authenticate_with_server:190 | 
üì° A subscrever indications de autentica√ß√£o...
2025-12-30 00:22:52.691 | INFO     | __main__:authenticate_with_server:198 | ‚úÖ Subscrito a indications
2025-12-30 00:22:52.691 | INFO     | __main__:authenticate_with_server:204 | 
--- Passo 1: Enviar certificado ao servidor ---
2025-12-30 00:22:52.692 | INFO     | common.security.authentication:start_authentication:135 | üîê Iniciando autentica√ß√£o - enviando certificado...
2025-12-30 00:22:52.692 | INFO     | common.security.authentication:start_authentication:146 |    Certificado: 908 bytes
2025-12-30 00:22:52.693 | INFO     | __main__:authenticate_with_server:206 | Enviando CERT_OFFER: 911 bytes
2025-12-30 00:22:52.697 | ERROR    | __main__:authenticate_with_server:226 | ‚ùå Erro ao enviar certificado: org.bluez.Error.Failed: Failed to initiate write
[70] method call[(null)->org.bluez] /org/bluez/hci0/dev_E0_D3_62_D6_EE_A0/service00c2/char00cb org.bluez.GattCharacteristic1 WriteValue
2025-12-30 00:22:52.697 | INFO     | __main__:authenticate_with_server:227 |    Certificado muito grande para MTU atual
2025-12-30 00:22:52.697 | INFO     | __main__:authenticate_with_server:228 |    Ser√° necess√°rio implementar fragmenta√ß√£o
2025-12-30 00:22:52.698 | ERROR    | __main__:main:383 | ‚ùå Autentica√ß√£o falhou
