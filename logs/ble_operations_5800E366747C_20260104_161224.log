2026-01-04 16:12:24.883 | INFO     | BLE Operation Logger iniciado: ble_operations_5800E366747C_20260104_161224.log
2026-01-04 16:12:24.883 | INFO     | Scanner BLE iniciado: hci0 (58:00:E3:66:74:7C)
2026-01-04 16:12:24.884 | INFO     | BLE Client iniciado
2026-01-04 16:12:24.884 | DEBUG    | FragmentReassembler inicializado
2026-01-04 16:12:24.884 | INFO     | ReplayProtection iniciado (window_size=100)
2026-01-04 16:12:24.885 | INFO     | üîÄ Router Daemon inicializado para NID=a40543fa...
2026-01-04 16:12:24.885 | DEBUG    | ‚úÖ Send callback configurado
2026-01-04 16:12:24.885 | DEBUG    | ‚úÖ Handler registado para MessageType(1)
2026-01-04 16:12:24.885 | DEBUG    | ‚úÖ Handler registado para MessageType(2)
2026-01-04 16:12:24.886 | INFO     | IoT Node inicializado (adapter=hci0)
2026-01-04 16:12:24.886 | INFO     | ‚úÖ Router Daemon integrado
2026-01-04 16:12:24.886 | INFO     | A configurar GATT Server...
2026-01-04 16:12:24.887 | INFO     | Application criada: /
2026-01-04 16:12:24.888 | INFO     | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-04 16:12:24.888 | INFO     | A criar IoTNetworkService...
2026-01-04 16:12:24.889 | DEBUG    | Characteristic criada: /0/char0 (UUID: 12340001-0000-1000-8000-00805f9b34fb, flags: ['write', 'notify'])
2026-01-04 16:12:24.889 | INFO     | NetworkPacketCharacteristic criada
2026-01-04 16:12:24.889 | DEBUG    | Characteristic criada: /0/char1 (UUID: 12340002-0000-1000-8000-00805f9b34fb, flags: ['read'])
2026-01-04 16:12:24.889 | INFO     | DeviceInfoCharacteristic criada: NID=a40543fa..., type=node
2026-01-04 16:12:24.890 | DEBUG    | Characteristic criada: /0/char2 (UUID: 12340003-0000-1000-8000-00805f9b34fb, flags: ['read', 'notify'])
2026-01-04 16:12:24.890 | INFO     | NeighborTableCharacteristic criada
2026-01-04 16:12:24.890 | DEBUG    | Characteristic criada: /0/char3 (UUID: 12340004-0000-1000-8000-00805f9b34fb, flags: ['write', 'indicate'])
2026-01-04 16:12:24.891 | INFO     | AuthCharacteristic criada
2026-01-04 16:12:24.891 | DEBUG    | Characteristic adicionada a /0: /0/char0
2026-01-04 16:12:24.891 | DEBUG    | Characteristic adicionada a /0: /0/char1
2026-01-04 16:12:24.891 | DEBUG    | Characteristic adicionada a /0: /0/char2
2026-01-04 16:12:24.891 | DEBUG    | Characteristic adicionada a /0: /0/char3
2026-01-04 16:12:24.891 | INFO     | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-04 16:12:24.891 | INFO     | Service adicionado √† aplica√ß√£o: /0
2026-01-04 16:12:24.892 | DEBUG    | Packet callback definido
2026-01-04 16:12:24.892 | DEBUG    | Auth callback definido
2026-01-04 16:12:24.892 | INFO     | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-04 16:12:24.892 | INFO     | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-04 16:12:24.892 | INFO     |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 16:12:24.893 | DEBUG    | Local name definido: IoT-Node-a40543fa
2026-01-04 16:12:24.894 | DEBUG    | Manufacturer data adicionado: ID=65535
2026-01-04 16:12:24.894 | INFO     | üîÑ Advertising cont√≠nuo configurado (duration=0)
2026-01-04 16:12:24.895 | INFO     | ‚úÖ GATT Server configurado
2026-01-04 16:12:24.895 | INFO     | A iniciar GATT Server...
2026-01-04 16:12:24.897 | INFO     | ‚úÖ GATT Server iniciado em thread separada
2026-01-04 16:12:24.898 | INFO     | ‚úÖ Node Device iniciado - CLI interativo pronto
2026-01-04 16:12:24.899 | DEBUG    | GetManagedObjects called
2026-01-04 16:12:24.899 | DEBUG    | GetManagedObjects returning 5 objects
2026-01-04 16:12:24.904 | INFO     | ‚úÖ GATT application registada!
2026-01-04 16:12:24.904 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 16:12:24.904 | INFO     | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 16:12:24.905 | ERROR    | ‚ùå Falha ao registar advertisement: org.bluez.Error.Failed: Failed to register advertisement
2026-01-04 16:12:30.666 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 16:12:30.667 | INFO     | [OP-20260104_161224-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 16:12:35.705 | DEBUG    |   Encontrado: ubuntors #1 (E0:D3:62:D6:EE:A0) RSSI: -52 dBm
2026-01-04 16:12:35.706 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-04 16:12:35.707 | INFO     | [OP-20260104_161224-0002] SCAN_RESULT | Devices_Found: 1
2026-01-04 16:12:35.709 | DEBUG    | [OP-20260104_161224-0002]   Device_1: Name: ubuntors #1 | Address: E0:D3:62:D6:EE:A0 | RSSI: -52 dBm | Services: 3
2026-01-04 16:12:35.709 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 16:12:35.710 | INFO     | [OP-20260104_161224-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 16:12:40.745 | DEBUG    |   Encontrado: Unknown (E0:D3:62:D7:47:03) RSSI: -58 dBm
2026-01-04 16:12:40.746 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-04 16:12:40.747 | INFO     | [OP-20260104_161224-0004] SCAN_RESULT | Devices_Found: 1
2026-01-04 16:12:40.748 | DEBUG    | [OP-20260104_161224-0004]   Device_1: Name: Unknown | Address: E0:D3:62:D7:47:03 | RSSI: -58 dBm | Services: 1
2026-01-04 16:13:18.724 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 16:13:18.726 | INFO     | [OP-20260104_161224-0005] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 16:13:23.739 | INFO     | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-04 16:13:23.740 | INFO     | [OP-20260104_161224-0006] SCAN_RESULT | Devices_Found: 0
2026-01-04 16:13:23.742 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 16:13:23.743 | INFO     | [OP-20260104_161224-0007] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 16:13:28.762 | INFO     | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-04 16:13:28.762 | INFO     | [OP-20260104_161224-0008] SCAN_RESULT | Devices_Found: 0
2026-01-04 16:13:32.107 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 16:13:32.108 | INFO     | [OP-20260104_161224-0009] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 16:13:37.135 | INFO     | Scan conclu√≠do: 0 dispositivos encontrados
2026-01-04 16:13:37.137 | INFO     | [OP-20260104_161224-0010] SCAN_RESULT | Devices_Found: 0
2026-01-04 16:13:37.138 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 16:13:37.140 | INFO     | [OP-20260104_161224-0011] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 16:13:42.157 | DEBUG    |   Encontrado: ubuntors #1 (E0:D3:62:D6:EE:A0) RSSI: -50 dBm
2026-01-04 16:13:42.157 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-04 16:13:42.157 | INFO     | [OP-20260104_161224-0012] SCAN_RESULT | Devices_Found: 1
2026-01-04 16:13:42.158 | DEBUG    | [OP-20260104_161224-0012]   Device_1: Name: ubuntors #1 | Address: E0:D3:62:D6:EE:A0 | RSSI: -50 dBm | Services: 3
2026-01-04 16:13:48.678 | INFO     | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-04 16:13:48.680 | DEBUG    | BLEConnection criada para E0:D3:62:D6:EE:A0
2026-01-04 16:13:48.681 | INFO     | A conectar a E0:D3:62:D6:EE:A0...
2026-01-04 16:13:48.682 | INFO     | [OP-20260104_161224-0013] CONNECT_ATTEMPT | Local: 58:00:E3:66:74:7C | Remote: E0:D3:62:D6:EE:A0
2026-01-04 16:13:48.693 | INFO     | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-04 16:13:48.695 | INFO     | [OP-20260104_161224-0014] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 7.35ms
2026-01-04 16:13:48.696 | DEBUG    | ‚úÖ Conex√£o estabelecida. Opera√ß√µes GATT usar√£o D-Bus se necess√°rio.
2026-01-04 16:13:48.697 | INFO     | ‚úÖ Conectado ao Sink via GATT
2026-01-04 16:13:48.701 | DEBUG    | Descobertos 3 servi√ßos
2026-01-04 16:13:48.708 | DEBUG    | Servi√ßo 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 16:13:48.709 | INFO     | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-04 16:13:48.711 | DEBUG    | üîÑ Timestamp de heartbeat resetado para nova conex√£o
2026-01-04 16:13:48.712 | INFO     | A subscrever a notifica√ß√µes...
2026-01-04 16:13:48.803 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:48.805 | INFO     | [OP-20260104_161224-0015] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:48.807 | INFO     | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-04 16:13:48.808 | DEBUG    | [OP-20260104_161224-0016] READ_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:48.893 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 16:13:48.895 | INFO     | [OP-20260104_161224-0017] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: 0abd826034354e24aa128bf5d40cc219ff00 | ASCII: ...`45N$..........
2026-01-04 16:13:48.897 | INFO     | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-04 16:13:48.901 | INFO     | üîê A iniciar autentica√ß√£o com Sink...
2026-01-04 16:13:48.903 | DEBUG    | üì° A subscrever a AUTH characteristic...
2026-01-04 16:13:48.984 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:48.986 | INFO     | [OP-20260104_161224-0018] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:48.987 | DEBUG    | ‚úÖ Subscrito a AUTH indications
2026-01-04 16:13:48.988 | INFO     | AuthenticationProtocol inicializado para a40543fa...
2026-01-04 16:13:48.989 | INFO     | üì§ Enviando certificado...
2026-01-04 16:13:48.991 | INFO     | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-04 16:13:48.994 | INFO     |    Certificado: 887 bytes
2026-01-04 16:13:48.997 | DEBUG    |    Estado: IDLE ‚Üí CERT_SENT
2026-01-04 16:13:48.998 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 16:13:49.000 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 16:13:49.002 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 16:13:49.003 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 16:13:49.004 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 16:13:49.005 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 16:13:49.005 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 16:13:49.008 | INFO     | [OP-20260104_161224-0019] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b67417749424167495547784b34596a38596e6c | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUGxK4Yj8Ynl [TRUNCATED]
2026-01-04 16:13:49.072 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 16:13:49.072 | INFO     | [OP-20260104_161224-0020] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:49.074 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 16:13:49.179 | INFO     | [OP-20260104_161224-0021] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e546b774e466f580a44544d324d4445774d6a41774e546b | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTkwNFoX.DTM2MDEwMjAwNTk [TRUNCATED]
2026-01-04 16:13:49.252 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 16:13:49.252 | INFO     | [OP-20260104_161224-0022] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:49.254 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 16:13:49.358 | INFO     | [OP-20260104_161224-0023] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241466d4779734c45465a4953455936583562416f44472b4138332b0a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAFmGysLEFZISEY6X5bAoDG+A83+. [TRUNCATED]
2026-01-04 16:13:49.431 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 16:13:49.432 | INFO     | [OP-20260104_161224-0024] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:49.434 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 16:13:49.538 | INFO     | [OP-20260104_161224-0025] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305456d6d4654724a6148340a533231634d4f67325877557a6a54544e61754b3750714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...EmmFTrJaH4.S21cMOg2XwUzjTTNauK7PqM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 16:13:49.612 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 16:13:49.613 | INFO     | [OP-20260104_161224-0026] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:49.614 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 16:13:49.717 | INFO     | [OP-20260104_161224-0027] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 02040571754f437562724d66446a575936386b542f6779345a63634d0a546e457775416d736e466742614976584a2b4e656e423843516748637873576a6d7579 | ASCII: ...quOCubrMfDjWY68kT/gy4ZccM.TnEwuAmsnFgBaIvXJ+NenB8CQgHcxsWjmuy [TRUNCATED]
2026-01-04 16:13:49.792 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 16:13:49.794 | INFO     | [OP-20260104_161224-0028] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 16:13:49.796 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 16:13:49.794 | INFO     | [OP-20260104_161224-0029] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 16:13:49.799 | DEBUG    | üîê AUTH indication recebida: 6 bytes
2026-01-04 16:13:49.799 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 16:13:49.800 | INFO     | Iniciando recep√ß√£o de 1 fragmentos
2026-01-04 16:13:49.801 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 16:13:49.802 | INFO     | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-04 16:13:49.803 | DEBUG    | FragmentReassembler resetado
2026-01-04 16:13:49.803 | DEBUG    | üîê AUTH mensagem completa: 3 bytes
2026-01-04 16:13:49.897 | DEBUG    | Autentica√ß√£o round 1/10
2026-01-04 16:13:50.399 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 16:13:50.399 | DEBUG    | üì® Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 16:13:50.400 | INFO     | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-04 16:13:50.401 | INFO     | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-04 16:13:50.403 | ERROR    | Certificados n√£o dispon√≠veis para derivar session key
2026-01-04 16:13:50.406 | INFO     | DTLSChannel criado (client) com certificado node_a40543fa_cert.pem
2026-01-04 16:13:50.408 | INFO     | Iniciando handshake DTLS...
2026-01-04 16:13:50.410 | WARNING  | DTLS n√£o dispon√≠vel - operando em modo stub
2026-01-04 16:13:50.411 | INFO     | ‚úÖ Canal DTLS (stub) estabelecido
2026-01-04 16:13:50.411 | INFO     | üîê Canal DTLS end-to-end estabelecido com Sink
2026-01-04 16:15:03.203 | INFO     | A parar Node...
2026-01-04 16:15:03.204 | INFO     | A parar GATT Server...
2026-01-04 16:15:03.208 | INFO     | ‚úÖ GATT Server parado
2026-01-04 16:15:05.047 | INFO     | Desconectado de E0:D3:62:D6:EE:A0
2026-01-04 16:15:05.050 | INFO     | [OP-20260104_161224-0030] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-04 16:15:05.052 | INFO     | ‚úÖ Node parado
