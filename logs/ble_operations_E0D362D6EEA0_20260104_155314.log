2026-01-04 15:53:14.790 | INFO     | BLE Operation Logger iniciado: ble_operations_E0D362D6EEA0_20260104_155314.log
2026-01-04 15:53:14.791 | INFO     | Scanner BLE iniciado: hci0 (E0:D3:62:D6:EE:A0)
2026-01-04 15:53:14.792 | INFO     | BLE Client iniciado
2026-01-04 15:53:14.793 | DEBUG    | FragmentReassembler inicializado
2026-01-04 15:53:14.794 | INFO     | ReplayProtection iniciado (window_size=100)
2026-01-04 15:53:14.795 | INFO     | üîÄ Router Daemon inicializado para NID=0abd8260...
2026-01-04 15:53:14.797 | DEBUG    | ‚úÖ Send callback configurado
2026-01-04 15:53:14.797 | DEBUG    | ‚úÖ Handler registado para MessageType(1)
2026-01-04 15:53:14.797 | DEBUG    | ‚úÖ Handler registado para MessageType(2)
2026-01-04 15:53:14.797 | INFO     | IoT Node inicializado (adapter=hci0)
2026-01-04 15:53:14.797 | INFO     | ‚úÖ Router Daemon integrado
2026-01-04 15:53:14.801 | INFO     | A configurar GATT Server...
2026-01-04 15:53:14.804 | INFO     | Application criada: /
2026-01-04 15:53:14.805 | INFO     | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-04 15:53:14.805 | INFO     | A criar IoTNetworkService...
2026-01-04 15:53:14.806 | DEBUG    | Characteristic criada: /0/char0 (UUID: 12340001-0000-1000-8000-00805f9b34fb, flags: ['write', 'notify'])
2026-01-04 15:53:14.806 | INFO     | NetworkPacketCharacteristic criada
2026-01-04 15:53:14.807 | DEBUG    | Characteristic criada: /0/char1 (UUID: 12340002-0000-1000-8000-00805f9b34fb, flags: ['read'])
2026-01-04 15:53:14.807 | INFO     | DeviceInfoCharacteristic criada: NID=0abd8260..., type=node
2026-01-04 15:53:14.808 | DEBUG    | Characteristic criada: /0/char2 (UUID: 12340003-0000-1000-8000-00805f9b34fb, flags: ['read', 'notify'])
2026-01-04 15:53:14.809 | INFO     | NeighborTableCharacteristic criada
2026-01-04 15:53:14.809 | DEBUG    | Characteristic criada: /0/char3 (UUID: 12340004-0000-1000-8000-00805f9b34fb, flags: ['write', 'indicate'])
2026-01-04 15:53:14.809 | INFO     | AuthCharacteristic criada
2026-01-04 15:53:14.810 | DEBUG    | Characteristic adicionada a /0: /0/char0
2026-01-04 15:53:14.811 | DEBUG    | Characteristic adicionada a /0: /0/char1
2026-01-04 15:53:14.811 | DEBUG    | Characteristic adicionada a /0: /0/char2
2026-01-04 15:53:14.811 | DEBUG    | Characteristic adicionada a /0: /0/char3
2026-01-04 15:53:14.811 | INFO     | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-04 15:53:14.812 | INFO     | Service adicionado √† aplica√ß√£o: /0
2026-01-04 15:53:14.812 | DEBUG    | Packet callback definido
2026-01-04 15:53:14.812 | DEBUG    | Auth callback definido
2026-01-04 15:53:14.813 | INFO     | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-04 15:53:14.813 | INFO     | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:14.814 | INFO     |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 15:53:14.815 | DEBUG    | Local name definido: IoT-Node-0abd8260
2026-01-04 15:53:14.815 | DEBUG    | Manufacturer data adicionado: ID=65535
2026-01-04 15:53:14.815 | INFO     | üîÑ Advertising cont√≠nuo configurado (duration=0)
2026-01-04 15:53:14.816 | INFO     | ‚úÖ GATT Server configurado
2026-01-04 15:53:14.818 | INFO     | A iniciar GATT Server...
2026-01-04 15:53:14.821 | INFO     | ‚úÖ GATT Server iniciado em thread separada
2026-01-04 15:53:14.823 | INFO     | ‚úÖ Node Device iniciado - CLI interativo pronto
2026-01-04 15:53:14.828 | DEBUG    | GetManagedObjects called
2026-01-04 15:53:14.829 | DEBUG    | GetManagedObjects returning 5 objects
2026-01-04 15:53:14.921 | INFO     | ‚úÖ GATT application registada!
2026-01-04 15:53:14.922 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 15:53:14.922 | INFO     | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 15:53:15.024 | INFO     | ‚úÖ Advertisement registado!
2026-01-04 15:53:24.936 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 15:53:24.936 | INFO     | [OP-20260104_155314-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 15:53:30.049 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -60 dBm
2026-01-04 15:53:30.053 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-04 15:53:30.055 | INFO     | [OP-20260104_155314-0002] SCAN_RESULT | Devices_Found: 1
2026-01-04 15:53:30.056 | DEBUG    | [OP-20260104_155314-0002]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -60 dBm | Services: 1
2026-01-04 15:53:30.057 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 15:53:30.058 | INFO     | [OP-20260104_155314-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 15:53:35.081 | DEBUG    |   Encontrado: IoT-Node-a40543fa (58:00:E3:66:74:7C) RSSI: -56 dBm
2026-01-04 15:53:35.084 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-04 15:53:35.085 | INFO     | [OP-20260104_155314-0004] SCAN_RESULT | Devices_Found: 1
2026-01-04 15:53:35.086 | DEBUG    | [OP-20260104_155314-0004]   Device_1: Name: IoT-Node-a40543fa | Address: 58:00:E3:66:74:7C | RSSI: -56 dBm | Services: 1
2026-01-04 15:53:37.319 | INFO     | A conectar ao Sink 58:00:E3:66:74:7C...
2026-01-04 15:53:37.321 | DEBUG    | BLEConnection criada para 58:00:E3:66:74:7C
2026-01-04 15:53:37.321 | INFO     | A conectar a 58:00:E3:66:74:7C...
2026-01-04 15:53:37.322 | INFO     | [OP-20260104_155314-0005] CONNECT_ATTEMPT | Local: E0:D3:62:D6:EE:A0 | Remote: 58:00:E3:66:74:7C
2026-01-04 15:53:42.509 | INFO     | ‚úÖ Conectado a 58:00:E3:66:74:7C
2026-01-04 15:53:42.510 | INFO     | [OP-20260104_155314-0006] CONNECT_SUCCESS | Remote: 58:00:E3:66:74:7C | Time: 5183.06ms
2026-01-04 15:53:42.512 | DEBUG    | ‚úÖ Conex√£o estabelecida. Opera√ß√µes GATT usar√£o D-Bus se necess√°rio.
2026-01-04 15:53:42.512 | INFO     | ‚úÖ Conectado ao Sink via GATT
2026-01-04 15:53:42.515 | DEBUG    | Descobertos 3 servi√ßos
2026-01-04 15:53:42.519 | DEBUG    | Servi√ßo 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 15:53:42.519 | INFO     | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-04 15:53:42.521 | DEBUG    | üîÑ Timestamp de heartbeat resetado para nova conex√£o
2026-01-04 15:53:42.521 | INFO     | A subscrever a notifica√ß√µes...
2026-01-04 15:53:42.963 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:42.965 | INFO     | [OP-20260104_155314-0007] SUBSCRIBE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:42.966 | INFO     | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-04 15:53:42.967 | DEBUG    | [OP-20260104_155314-0008] READ_REQUEST | Remote: 58:00:E3:66:74:7C | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.053 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 15:53:43.053 | INFO     | [OP-20260104_155314-0009] READ_RESPONSE | Remote: 58:00:E3:66:74:7C | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: a40543face324331ad8d4798037bfbc7ff00 | ASCII: ..C..2C1..G..{....
2026-01-04 15:53:43.054 | INFO     | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-04 15:53:43.056 | INFO     | üîê A iniciar autentica√ß√£o com Sink...
2026-01-04 15:53:43.057 | DEBUG    | üì° A subscrever a AUTH characteristic...
2026-01-04 15:53:43.143 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.144 | INFO     | [OP-20260104_155314-0010] SUBSCRIBE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.145 | DEBUG    | ‚úÖ Subscrito a AUTH indications
2026-01-04 15:53:43.146 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 15:53:43.147 | INFO     | üì§ Enviando certificado...
2026-01-04 15:53:43.148 | INFO     | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-04 15:53:43.149 | INFO     |    Certificado: 887 bytes
2026-01-04 15:53:43.151 | DEBUG    |    Estado: IDLE ‚Üí CERT_SENT
2026-01-04 15:53:43.151 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 15:53:43.152 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 15:53:43.153 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 15:53:43.153 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 15:53:43.154 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 15:53:43.154 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 15:53:43.155 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 15:53:43.158 | INFO     | [OP-20260104_155314-0011] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 15:53:43.231 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 15:53:43.231 | INFO     | [OP-20260104_155314-0012] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.232 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 15:53:43.333 | INFO     | [OP-20260104_155314-0013] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 15:53:43.411 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 15:53:43.411 | INFO     | [OP-20260104_155314-0014] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.412 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 15:53:43.514 | INFO     | [OP-20260104_155314-0015] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 15:53:43.591 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 15:53:43.591 | INFO     | [OP-20260104_155314-0016] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.592 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 15:53:43.694 | INFO     | [OP-20260104_155314-0017] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 15:53:43.816 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 15:53:43.817 | INFO     | [OP-20260104_155314-0018] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.818 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 15:53:43.920 | INFO     | [OP-20260104_155314-0019] WRITE_REQUEST | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 15:53:43.996 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 15:53:43.997 | INFO     | [OP-20260104_155314-0020] WRITE_SUCCESS | Remote: 58:00:E3:66:74:7C | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 15:53:43.997 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 15:53:44.098 | DEBUG    | Autentica√ß√£o round 1/10
2026-01-04 15:53:44.598 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:44.599 | DEBUG    | Autentica√ß√£o round 2/10
2026-01-04 15:53:45.099 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:45.100 | DEBUG    | Autentica√ß√£o round 3/10
2026-01-04 15:53:45.601 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:45.601 | DEBUG    | Autentica√ß√£o round 4/10
2026-01-04 15:53:46.102 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:46.103 | DEBUG    | Autentica√ß√£o round 5/10
2026-01-04 15:53:46.603 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:46.604 | DEBUG    | Autentica√ß√£o round 6/10
2026-01-04 15:53:47.104 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:47.105 | DEBUG    | Autentica√ß√£o round 7/10
2026-01-04 15:53:47.605 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:47.605 | DEBUG    | Autentica√ß√£o round 8/10
2026-01-04 15:53:48.106 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:48.106 | DEBUG    | Autentica√ß√£o round 9/10
2026-01-04 15:53:48.607 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:48.608 | DEBUG    | Autentica√ß√£o round 10/10
2026-01-04 15:53:49.108 | DEBUG    | Sem resposta ainda, continuando...
2026-01-04 15:53:49.109 | ERROR    | ‚ùå Autentica√ß√£o expirou (timeout)
2026-01-04 15:54:19.524 | INFO     | A parar Node...
2026-01-04 15:54:19.526 | INFO     | A parar GATT Server...
2026-01-04 15:54:19.529 | INFO     | ‚úÖ GATT Server parado
2026-01-04 15:54:21.934 | INFO     | Desconectado de 58:00:E3:66:74:7C
2026-01-04 15:54:21.935 | INFO     | [OP-20260104_155314-0021] DISCONNECT | Remote: 58:00:E3:66:74:7C | Reason: normal
2026-01-04 15:54:21.936 | INFO     | ‚úÖ Node parado
