2026-01-02 02:28:30.519 | INFO     | BLE Operation Logger iniciado: ble_operations_A08869B6F7D2_20260102_022830.log
2026-01-02 02:28:30.520 | INFO     | Scanner BLE iniciado: hci0 (A0:88:69:B6:F7:D2)
2026-01-02 02:28:30.521 | INFO     | BLE Client iniciado
2026-01-02 02:28:30.521 | INFO     | IoT Node inicializado (adapter=hci0)
2026-01-02 02:28:30.522 | INFO     | ============================================================
2026-01-02 02:28:30.522 | INFO     |   A iniciar IoT Node (dual-mode)
2026-01-02 02:28:30.523 | INFO     | ============================================================
2026-01-02 02:28:30.525 | INFO     | A configurar GATT Server...
2026-01-02 02:28:30.527 | INFO     | Application criada: /
2026-01-02 02:28:30.528 | INFO     | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-02 02:28:30.528 | INFO     | A criar IoTNetworkService...
2026-01-02 02:28:30.530 | DEBUG    | Characteristic criada: /0/char0 (UUID: 12340001-0000-1000-8000-00805f9b34fb, flags: ['write', 'notify'])
2026-01-02 02:28:30.531 | INFO     | NetworkPacketCharacteristic criada
2026-01-02 02:28:30.532 | DEBUG    | Characteristic criada: /0/char1 (UUID: 12340002-0000-1000-8000-00805f9b34fb, flags: ['read'])
2026-01-02 02:28:30.532 | INFO     | DeviceInfoCharacteristic criada: NID=53a84472..., type=node
2026-01-02 02:28:30.533 | DEBUG    | Characteristic criada: /0/char2 (UUID: 12340003-0000-1000-8000-00805f9b34fb, flags: ['read', 'notify'])
2026-01-02 02:28:30.533 | INFO     | NeighborTableCharacteristic criada
2026-01-02 02:28:30.534 | DEBUG    | Characteristic criada: /0/char3 (UUID: 12340004-0000-1000-8000-00805f9b34fb, flags: ['write', 'indicate'])
2026-01-02 02:28:30.534 | INFO     | AuthCharacteristic criada
2026-01-02 02:28:30.536 | DEBUG    | Characteristic adicionada a /0: /0/char0
2026-01-02 02:28:30.537 | DEBUG    | Characteristic adicionada a /0: /0/char1
2026-01-02 02:28:30.537 | DEBUG    | Characteristic adicionada a /0: /0/char2
2026-01-02 02:28:30.537 | DEBUG    | Characteristic adicionada a /0: /0/char3
2026-01-02 02:28:30.538 | INFO     | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-02 02:28:30.539 | INFO     | Service adicionado √† aplica√ß√£o: /0
2026-01-02 02:28:30.540 | DEBUG    | Packet callback definido
2026-01-02 02:28:30.540 | DEBUG    | Auth callback definido
2026-01-02 02:28:30.540 | INFO     | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-02 02:28:30.542 | INFO     | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:30.543 | INFO     |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:28:30.545 | DEBUG    | Local name definido: IoT-Node-53a84472
2026-01-02 02:28:30.545 | DEBUG    | Manufacturer data adicionado: ID=65535
2026-01-02 02:28:30.546 | INFO     | ‚úÖ GATT Server configurado
2026-01-02 02:28:30.547 | INFO     | A iniciar GATT Server...
2026-01-02 02:28:30.551 | INFO     | ‚úÖ GATT Server iniciado em thread separada
2026-01-02 02:28:30.551 | INFO     | ‚úÖ GATT Server ativo - aguardando downlinks
2026-01-02 02:28:30.553 | INFO     | üîç A procurar Sink...
2026-01-02 02:28:30.555 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-02 02:28:30.556 | INFO     | [OP-20260102_022830-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-02 02:28:30.557 | DEBUG    | GetManagedObjects called
2026-01-02 02:28:30.557 | DEBUG    | GetManagedObjects returning 5 objects
2026-01-02 02:28:30.631 | INFO     | ‚úÖ GATT application registada!
2026-01-02 02:28:30.633 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-02 02:28:30.633 | INFO     | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-02 02:28:30.745 | INFO     | ‚úÖ Advertisement registado!
2026-01-02 02:28:35.836 | DEBUG    |   Encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -60 dBm
2026-01-02 02:28:35.836 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-02 02:28:35.836 | INFO     | [OP-20260102_022830-0002] SCAN_RESULT | Devices_Found: 1
2026-01-02 02:28:35.837 | DEBUG    | [OP-20260102_022830-0002]   Device_1: Name: IoT-Sink-c5c55ab2 | Address: E0:D3:62:D6:EE:A0 | RSSI: -60 dBm | Services: 1
2026-01-02 02:28:35.837 | INFO     | Encontrados 1 dispositivos IoT
2026-01-02 02:28:35.838 | DEBUG    |   Device: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -60 dBm
2026-01-02 02:28:35.838 | DEBUG    |     Type=0, HopCount=255
2026-01-02 02:28:35.838 | INFO     | ‚úÖ Sink encontrado: IoT-Sink-c5c55ab2 (E0:D3:62:D6:EE:A0) RSSI: -60 dBm
2026-01-02 02:28:35.839 | INFO     | A conectar ao Sink E0:D3:62:D6:EE:A0...
2026-01-02 02:28:35.839 | DEBUG    | BLEConnection criada para E0:D3:62:D6:EE:A0
2026-01-02 02:28:35.839 | INFO     | A conectar a E0:D3:62:D6:EE:A0...
2026-01-02 02:28:35.840 | INFO     | [OP-20260102_022830-0003] CONNECT_ATTEMPT | Local: A0:88:69:B6:F7:D2 | Remote: E0:D3:62:D6:EE:A0
2026-01-02 02:28:39.042 | INFO     | ‚úÖ Conectado a E0:D3:62:D6:EE:A0
2026-01-02 02:28:39.043 | INFO     | [OP-20260102_022830-0004] CONNECT_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Time: 3199.40ms
2026-01-02 02:28:39.044 | DEBUG    | ‚úÖ Conex√£o estabelecida. Opera√ß√µes GATT usar√£o D-Bus se necess√°rio.
2026-01-02 02:28:39.045 | INFO     | ‚úÖ Conectado ao Sink via GATT
2026-01-02 02:28:39.048 | DEBUG    | Descobertos 4 servi√ßos
2026-01-02 02:28:39.052 | DEBUG    | Servi√ßo 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-02 02:28:39.053 | INFO     | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-02 02:28:39.054 | INFO     | A subscrever a notifica√ß√µes...
2026-01-02 02:28:39.562 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.565 | INFO     | [OP-20260102_022830-0005] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.566 | INFO     | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-02 02:28:39.567 | DEBUG    | [OP-20260102_022830-0006] READ_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.663 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-02 02:28:39.663 | INFO     | [OP-20260102_022830-0007] READ_RESPONSE | Remote: E0:D3:62:D6:EE:A0 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380ff01 | ASCII: ..Z..iB}...Q......
2026-01-02 02:28:39.664 | INFO     | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-02 02:28:39.665 | DEBUG    | Manufacturer data adicionado: ID=65535
2026-01-02 02:28:39.665 | DEBUG    | Advertisement atualizado: hop_count=0
2026-01-02 02:28:39.666 | INFO     | üîê A iniciar autentica√ß√£o com Sink...
2026-01-02 02:28:39.666 | DEBUG    | üì° A subscrever a AUTH characteristic...
2026-01-02 02:28:39.761 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.762 | INFO     | [OP-20260102_022830-0008] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.762 | DEBUG    | ‚úÖ Subscrito a AUTH indications
2026-01-02 02:28:39.762 | INFO     | AuthenticationProtocol inicializado para 53a84472...
2026-01-02 02:28:39.763 | INFO     | üì§ Enviando certificado...
2026-01-02 02:28:39.763 | INFO     | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-02 02:28:39.763 | INFO     |    Certificado: 887 bytes
2026-01-02 02:28:39.764 | DEBUG    |    Estado: IDLE ‚Üí CERT_SENT
2026-01-02 02:28:39.764 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-02 02:28:39.764 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-02 02:28:39.764 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-02 02:28:39.764 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-02 02:28:39.765 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-02 02:28:39.765 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-02 02:28:39.765 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-02 02:28:39.766 | INFO     | [OP-20260102_022830-0009] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955657479325a6c55354642 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUety2ZlU5FB [TRUNCATED]
2026-01-02 02:28:39.767 | INFO     | [OP-20260102_022830-0010] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af380020100000003f72cddbfce556c6bb0474f7203fc157338a84b90110a9a1f252c | ASCII: ..Z..iB}...Q......Z..iB}...Q...........,...Ulk.GOr...s8.K.....%, [TRUNCATED]
2026-01-02 02:28:39.769 | INFO     | Sink NID identificado: c5c55ab2...
2026-01-02 02:28:39.770 | DEBUG    | Novo source c5c55ab2...: seq=3 (primeiro pacote)
2026-01-02 02:28:39.770 | DEBUG    | üíì Heartbeat recebido (seq=3, age=0.84s)
2026-01-02 02:28:39.911 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-02 02:28:39.911 | INFO     | [OP-20260102_022830-0011] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:39.912 | DEBUG    |   Fragmento 1/5 enviado
2026-01-02 02:28:40.014 | INFO     | [OP-20260102_022830-0012] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449314d5449794f54497a4e44517a4d6c6f580a44544d314d5449794e7a497a4e4451 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI1MTIyOTIzNDQzMloX.DTM1MTIyNzIzNDQ [TRUNCATED]
2026-01-02 02:28:40.161 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-02 02:28:40.161 | INFO     | [OP-20260102_022830-0013] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.162 | DEBUG    |   Fragmento 2/5 enviado
2026-01-02 02:28:40.265 | INFO     | [OP-20260102_022830-0014] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241456a5a664e4f582f456157716c626755424372633971676b43350a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAEjZfNOX/EaWqlbgUBCrc9qgkC5. [TRUNCATED]
2026-01-02 02:28:40.412 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-02 02:28:40.413 | INFO     | [OP-20260102_022830-0015] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.414 | DEBUG    |   Fragmento 3/5 enviado
2026-01-02 02:28:40.517 | INFO     | [OP-20260102_022830-0016] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305322b7557522b624835560a3147525a7964677179532f365a50456b4778617937714d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...2+uWR+bH5V.1GRZydgqyS/6ZPEkGxay7qM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-02 02:28:40.661 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-02 02:28:40.662 | INFO     | [OP-20260102_022830-0017] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.663 | DEBUG    |   Fragmento 4/5 enviado
2026-01-02 02:28:40.765 | INFO     | [OP-20260102_022830-0018] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 0204057a4233785053466831484d2f79427553464f702f794b5767580a69446f397832696f457134374b4e51567878794859475143516744444c625662666e58 | ASCII: ...zB3xPSFh1HM/yBuSFOp/yKWgX.iDo9x2ioEq47KNQVxxyHYGQCQgDDLbVbfnX [TRUNCATED]
2026-01-02 02:28:40.861 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-02 02:28:40.861 | INFO     | [OP-20260102_022830-0019] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:40.862 | DEBUG    |   Fragmento 5/5 enviado
2026-01-02 02:28:40.863 | INFO     | [OP-20260102_022830-0020] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 38 bytes | Hex: 03000102002006b591f9df30b41cd63acda27b12a7154061c2a940bb5240017471a1248523b5 | ASCII: ..... .....0...:..{...@a..@.R@.tq.$.#.
2026-01-02 02:28:40.864 | DEBUG    | üîê AUTH indication recebida: 38 bytes
2026-01-02 02:28:40.962 | DEBUG    | Autentica√ß√£o round 1/10
2026-01-02 02:28:41.462 | DEBUG    | Resposta auth lida do buffer: 38 bytes
2026-01-02 02:28:41.463 | DEBUG    | üì® Recebido: AuthMessage(type=RESPONSE, payload=1 bytes)
2026-01-02 02:28:41.464 | INFO     | üîç Response recebida - verificando assinatura...
2026-01-02 02:28:41.465 | ERROR    | ‚ùå Nenhum challenge foi enviado!
2026-01-02 02:28:41.467 | DEBUG    | üì§ Enviando resposta (20 bytes)
2026-01-02 02:28:41.467 | DEBUG    | Mensagem pequena (20 bytes), 1 fragmento
2026-01-02 02:28:41.467 | DEBUG    | Enviando mensagem auth: 20 bytes em 1 fragmento(s)
2026-01-02 02:28:41.470 | INFO     | [OP-20260102_022830-0021] WRITE_REQUEST | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 23 bytes | Hex: 0300010500114e6f206368616c6c656e67652073656e74 | ASCII: ......No challenge sent
2026-01-02 02:28:41.561 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (23 bytes)
2026-01-02 02:28:41.561 | INFO     | [OP-20260102_022830-0022] WRITE_SUCCESS | Remote: E0:D3:62:D6:EE:A0 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-02 02:28:41.562 | DEBUG    |   Fragmento 1/1 enviado
2026-01-02 02:28:41.562 | DEBUG    | Autentica√ß√£o round 2/10
2026-01-02 02:28:42.062 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:42.062 | DEBUG    | Autentica√ß√£o round 3/10
2026-01-02 02:28:42.563 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:42.564 | DEBUG    | Autentica√ß√£o round 4/10
2026-01-02 02:28:43.064 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:43.065 | DEBUG    | Autentica√ß√£o round 5/10
2026-01-02 02:28:43.566 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:43.566 | DEBUG    | Autentica√ß√£o round 6/10
2026-01-02 02:28:44.067 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:44.068 | DEBUG    | Autentica√ß√£o round 7/10
2026-01-02 02:28:44.568 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:44.569 | DEBUG    | Autentica√ß√£o round 8/10
2026-01-02 02:28:44.766 | INFO     | [OP-20260102_022830-0023] NOTIFICATION | Remote: E0:D3:62:D6:EE:A0 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 158 bytes | Hex: c5c55ab2c469427db40fbf51ab0af380c5c55ab2c469427db40fbf51ab0af38002010000000458de169dd01a56b5ebb6a6296f37d0bba1ed54d26fdb09b5841c | ASCII: ..Z..iB}...Q......Z..iB}...Q..........X.....V....)o7....T.o..... [TRUNCATED]
2026-01-02 02:28:44.768 | DEBUG    | Source c5c55ab2...: seq=4 (novo highest, window: 2 seqs)
2026-01-02 02:28:44.768 | DEBUG    | üíì Heartbeat recebido (seq=4, age=0.84s)
2026-01-02 02:28:45.070 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:45.070 | DEBUG    | Autentica√ß√£o round 9/10
2026-01-02 02:28:45.571 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:45.572 | DEBUG    | Autentica√ß√£o round 10/10
2026-01-02 02:28:46.072 | DEBUG    | Sem resposta ainda, continuando...
2026-01-02 02:28:46.073 | ERROR    | ‚ùå Autentica√ß√£o expirou (timeout)
2026-01-02 02:28:46.074 | ERROR    | ‚ùå Falha na autentica√ß√£o
2026-01-02 02:28:46.075 | INFO     | A parar Node...
2026-01-02 02:28:46.076 | INFO     | A parar GATT Server...
2026-01-02 02:28:46.079 | INFO     | ‚úÖ GATT Server parado
2026-01-02 02:28:48.023 | INFO     | Desconectado de E0:D3:62:D6:EE:A0
2026-01-02 02:28:48.026 | INFO     | [OP-20260102_022830-0024] DISCONNECT | Remote: E0:D3:62:D6:EE:A0 | Reason: normal
2026-01-02 02:28:48.027 | INFO     | ‚úÖ Node parado
