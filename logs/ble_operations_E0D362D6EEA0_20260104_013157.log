2026-01-04 01:31:57.191 | INFO     | BLE Operation Logger iniciado: ble_operations_E0D362D6EEA0_20260104_013157.log
2026-01-04 01:31:57.192 | INFO     | Scanner BLE iniciado: hci0 (E0:D3:62:D6:EE:A0)
2026-01-04 01:31:57.193 | INFO     | BLE Client iniciado
2026-01-04 01:31:57.194 | DEBUG    | FragmentReassembler inicializado
2026-01-04 01:31:57.195 | INFO     | ReplayProtection iniciado (window_size=100)
2026-01-04 01:31:57.196 | INFO     | üîÄ Router Daemon inicializado para NID=0abd8260...
2026-01-04 01:31:57.197 | DEBUG    | ‚úÖ Send callback configurado
2026-01-04 01:31:57.197 | DEBUG    | ‚úÖ Handler registado para MessageType(1)
2026-01-04 01:31:57.197 | DEBUG    | ‚úÖ Handler registado para MessageType(2)
2026-01-04 01:31:57.197 | INFO     | IoT Node inicializado (adapter=hci0)
2026-01-04 01:31:57.198 | INFO     | ‚úÖ Router Daemon integrado
2026-01-04 01:31:57.198 | INFO     | A configurar GATT Server...
2026-01-04 01:31:57.203 | INFO     | Application criada: /
2026-01-04 01:31:57.204 | INFO     | Service criado: /0 (UUID: 12340000-0000-1000-8000-00805f9b34fb, primary: True)
2026-01-04 01:31:57.204 | INFO     | A criar IoTNetworkService...
2026-01-04 01:31:57.205 | DEBUG    | Characteristic criada: /0/char0 (UUID: 12340001-0000-1000-8000-00805f9b34fb, flags: ['write', 'notify'])
2026-01-04 01:31:57.206 | INFO     | NetworkPacketCharacteristic criada
2026-01-04 01:31:57.206 | DEBUG    | Characteristic criada: /0/char1 (UUID: 12340002-0000-1000-8000-00805f9b34fb, flags: ['read'])
2026-01-04 01:31:57.207 | INFO     | DeviceInfoCharacteristic criada: NID=0abd8260..., type=node
2026-01-04 01:31:57.207 | DEBUG    | Characteristic criada: /0/char2 (UUID: 12340003-0000-1000-8000-00805f9b34fb, flags: ['read', 'notify'])
2026-01-04 01:31:57.208 | INFO     | NeighborTableCharacteristic criada
2026-01-04 01:31:57.209 | DEBUG    | Characteristic criada: /0/char3 (UUID: 12340004-0000-1000-8000-00805f9b34fb, flags: ['write', 'indicate'])
2026-01-04 01:31:57.209 | INFO     | AuthCharacteristic criada
2026-01-04 01:31:57.209 | DEBUG    | Characteristic adicionada a /0: /0/char0
2026-01-04 01:31:57.210 | DEBUG    | Characteristic adicionada a /0: /0/char1
2026-01-04 01:31:57.210 | DEBUG    | Characteristic adicionada a /0: /0/char2
2026-01-04 01:31:57.210 | DEBUG    | Characteristic adicionada a /0: /0/char3
2026-01-04 01:31:57.212 | INFO     | ‚úÖ IoTNetworkService criado com sucesso!
2026-01-04 01:31:57.212 | INFO     | Service adicionado √† aplica√ß√£o: /0
2026-01-04 01:31:57.213 | DEBUG    | Packet callback definido
2026-01-04 01:31:57.213 | DEBUG    | Auth callback definido
2026-01-04 01:31:57.213 | INFO     | Advertisement criado: /org/bluez/iot/advertisement0 (type: peripheral)
2026-01-04 01:31:57.214 | INFO     | ‚úÖ Service UUID adicionado ao advertising: 12340000-0000-1000-8000-00805f9b34fb
2026-01-04 01:31:57.215 | INFO     |    Lista atual de UUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 01:31:57.216 | DEBUG    | Local name definido: IoT-Node-0abd8260
2026-01-04 01:31:57.216 | DEBUG    | Manufacturer data adicionado: ID=65535
2026-01-04 01:31:57.216 | INFO     | ‚úÖ GATT Server configurado
2026-01-04 01:31:57.217 | INFO     | A iniciar GATT Server...
2026-01-04 01:31:57.219 | INFO     | ‚úÖ GATT Server iniciado em thread separada
2026-01-04 01:31:57.219 | INFO     | ‚úÖ Node Device iniciado - CLI interativo pronto
2026-01-04 01:31:57.335 | DEBUG    | GetManagedObjects called
2026-01-04 01:31:57.336 | DEBUG    | GetManagedObjects returning 5 objects
2026-01-04 01:31:57.506 | INFO     | ‚úÖ GATT application registada!
2026-01-04 01:31:57.507 | DEBUG    | GetAll called on /org/bluez/iot/advertisement0
2026-01-04 01:31:57.507 | INFO     | üì° Advertising com ServiceUUIDs: ['12340000-0000-1000-8000-00805f9b34fb']
2026-01-04 01:31:57.609 | INFO     | ‚úÖ Advertisement registado!
2026-01-04 01:32:06.046 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 01:32:06.047 | INFO     | [OP-20260104_013157-0001] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 01:32:11.172 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -46 dBm
2026-01-04 01:32:11.173 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-04 01:32:11.174 | INFO     | [OP-20260104_013157-0002] SCAN_RESULT | Devices_Found: 1
2026-01-04 01:32:11.175 | DEBUG    | [OP-20260104_013157-0002]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -46 dBm | Services: 1
2026-01-04 01:32:11.175 | INFO     | A fazer scan BLE durante 5000ms...
2026-01-04 01:32:11.176 | INFO     | [OP-20260104_013157-0003] SCAN_START | Duration: 5000ms | Filter_IoT: True
2026-01-04 01:32:16.297 | DEBUG    |   Encontrado: IoT-Sink-4e127252 (E0:D3:62:D7:47:03) RSSI: -46 dBm
2026-01-04 01:32:16.298 | INFO     | Scan conclu√≠do: 1 dispositivos encontrados
2026-01-04 01:32:16.299 | INFO     | [OP-20260104_013157-0004] SCAN_RESULT | Devices_Found: 1
2026-01-04 01:32:16.300 | DEBUG    | [OP-20260104_013157-0004]   Device_1: Name: IoT-Sink-4e127252 | Address: E0:D3:62:D7:47:03 | RSSI: -46 dBm | Services: 1
2026-01-04 01:32:20.437 | INFO     | A conectar ao Sink E0:D3:62:D7:47:03...
2026-01-04 01:32:20.438 | DEBUG    | BLEConnection criada para E0:D3:62:D7:47:03
2026-01-04 01:32:20.438 | INFO     | A conectar a E0:D3:62:D7:47:03...
2026-01-04 01:32:20.439 | INFO     | [OP-20260104_013157-0005] CONNECT_ATTEMPT | Local: E0:D3:62:D6:EE:A0 | Remote: E0:D3:62:D7:47:03
2026-01-04 01:32:26.930 | INFO     | ‚úÖ Conectado a E0:D3:62:D7:47:03
2026-01-04 01:32:26.931 | INFO     | [OP-20260104_013157-0006] CONNECT_SUCCESS | Remote: E0:D3:62:D7:47:03 | Time: 6487.27ms
2026-01-04 01:32:26.932 | DEBUG    | ‚úÖ Conex√£o estabelecida. Opera√ß√µes GATT usar√£o D-Bus se necess√°rio.
2026-01-04 01:32:26.932 | INFO     | ‚úÖ Conectado ao Sink via GATT
2026-01-04 01:32:26.939 | DEBUG    | Descobertos 4 servi√ßos
2026-01-04 01:32:26.943 | DEBUG    | Servi√ßo 12340000-0000-1000-8000-00805f9b34fb encontrado
2026-01-04 01:32:26.944 | INFO     | ‚úÖ Servi√ßo IoT Network encontrado
2026-01-04 01:32:26.945 | DEBUG    | üîÑ Timestamp de heartbeat resetado para nova conex√£o
2026-01-04 01:32:26.946 | INFO     | A subscrever a notifica√ß√µes...
2026-01-04 01:32:27.368 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:27.369 | INFO     | [OP-20260104_013157-0007] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:27.370 | INFO     | ‚úÖ Subscrito a NETWORK_PACKET
2026-01-04 01:32:27.371 | DEBUG    | [OP-20260104_013157-0008] READ_REQUEST | Remote: E0:D3:62:D7:47:03 | Service: 12340000-0000-1000-8000-00805f9b34fb | Char: 12340002-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:27.457 | DEBUG    | Read 12340002-0000-1000-8000-00805f9b34fb: 18 bytes
2026-01-04 01:32:27.457 | INFO     | [OP-20260104_013157-0009] READ_RESPONSE | Remote: E0:D3:62:D7:47:03 | Char: 12340002-0000-1000-8000-00805f9b34fb | Data: 18 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b17ff01 | ASCII: N.rR..LP...].>{...
2026-01-04 01:32:27.458 | INFO     | ‚úÖ Conectado ao Sink - hop_count=0
2026-01-04 01:32:27.459 | INFO     | üîê A iniciar autentica√ß√£o com Sink...
2026-01-04 01:32:27.459 | DEBUG    | üì° A subscrever a AUTH characteristic...
2026-01-04 01:32:27.547 | INFO     | ‚úÖ Subscrito a notifica√ß√µes: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:27.549 | INFO     | [OP-20260104_013157-0010] SUBSCRIBE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:27.550 | DEBUG    | ‚úÖ Subscrito a AUTH indications
2026-01-04 01:32:27.550 | INFO     | AuthenticationProtocol inicializado para 0abd8260...
2026-01-04 01:32:27.552 | INFO     | üì§ Enviando certificado...
2026-01-04 01:32:27.552 | INFO     | üîê Iniciando autentica√ß√£o - enviando certificado...
2026-01-04 01:32:27.596 | INFO     |    Certificado: 887 bytes
2026-01-04 01:32:27.597 | DEBUG    |    Estado: IDLE ‚Üí CERT_SENT
2026-01-04 01:32:27.597 | INFO     | Fragmentando mensagem de 890 bytes em 5 fragmentos
2026-01-04 01:32:27.601 | DEBUG    |   Fragmento 1/5: 180 bytes, flags=0x01
2026-01-04 01:32:27.601 | DEBUG    |   Fragmento 2/5: 180 bytes, flags=0x00
2026-01-04 01:32:27.602 | DEBUG    |   Fragmento 3/5: 180 bytes, flags=0x00
2026-01-04 01:32:27.602 | DEBUG    |   Fragmento 4/5: 180 bytes, flags=0x00
2026-01-04 01:32:27.603 | DEBUG    |   Fragmento 5/5: 170 bytes, flags=0x02
2026-01-04 01:32:27.603 | DEBUG    | Enviando mensagem auth: 890 bytes em 5 fragmento(s)
2026-01-04 01:32:27.606 | INFO     | [OP-20260104_013157-0011] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100050103772d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949435954434341634b674177494241674955425269314a556f385272 | ASCII: .....w-----BEGIN CERTIFICATE-----.MIICYTCCAcKgAwIBAgIUBRi1JUo8Rr [TRUNCATED]
2026-01-04 01:32:27.681 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 01:32:27.681 | INFO     | [OP-20260104_013157-0012] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:27.682 | DEBUG    |   Fragmento 1/5 enviado
2026-01-04 01:32:27.783 | INFO     | [OP-20260104_013157-0013] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001054d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e5463784e566f580a44544d324d4445774d6a41774e5463 | ASCII: ...MDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNTcxNVoX.DTM2MDEwMjAwNTc [TRUNCATED]
2026-01-04 01:32:27.861 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 01:32:27.861 | INFO     | [OP-20260104_013157-0014] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:27.862 | DEBUG    |   Fragmento 2/5 enviado
2026-01-04 01:32:27.964 | INFO     | [OP-20260104_013157-0015] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000205675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241415a47726f48704c3249416f6e354f56414d2f534c41433941790a | ASCII: ...gZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAZGroHpL2IAon5OVAM/SLAC9Ay. [TRUNCATED]
2026-01-04 01:32:28.041 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 01:32:28.041 | INFO     | [OP-20260104_013157-0016] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:28.042 | DEBUG    |   Fragmento 3/5 enviado
2026-01-04 01:32:28.144 | INFO     | [OP-20260104_013157-0017] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000305594d574c6568665250740a4e64354f775453414a4e694f3069637059514f355a614d344d44597744415944565230544151482f424149774144414f4267 | ASCII: ...YMWLehfRPt.Nd5OwTSAJNiO0icpYQO5ZaM4MDYwDAYDVR0TAQH/BAIwADAOBg [TRUNCATED]
2026-01-04 01:32:28.221 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (183 bytes)
2026-01-04 01:32:28.221 | INFO     | [OP-20260104_013157-0018] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:28.222 | DEBUG    |   Fragmento 4/5 enviado
2026-01-04 01:32:28.324 | INFO     | [OP-20260104_013157-0019] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 173 bytes | Hex: 020405653836677866637859446f747047433179376761726a6850680a547133775375714333506b30754371454b3853702f5345435167456a385939726a546f | ASCII: ...e86gxfcxYDotpGC1y7garjhPh.Tq3wSuqC3Pk0uCqEK8Sp/SECQgEj8Y9rjTo [TRUNCATED]
2026-01-04 01:32:28.447 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (173 bytes)
2026-01-04 01:32:28.448 | INFO     | [OP-20260104_013157-0020] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:28.449 | DEBUG    |   Fragmento 5/5 enviado
2026-01-04 01:32:28.448 | INFO     | [OP-20260104_013157-0021] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0100060203b00000038c2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943634443434164476741774942416749554847374f5a74 | ASCII: ..........-----BEGIN CERTIFICATE-----.MIICcDCCAdGgAwIBAgIUHG7OZt [TRUNCATED]
2026-01-04 01:32:28.452 | DEBUG    | üîê AUTH indication recebida: 183 bytes
2026-01-04 01:32:28.452 | DEBUG    | Fragmento recebido: seq=0, total=6, payload=180 bytes, flags=0x01
2026-01-04 01:32:28.453 | INFO     | Iniciando recep√ß√£o de 6 fragmentos
2026-01-04 01:32:28.454 | DEBUG    | Fragmento 1/6 armazenado (1 de 6 recebidos)
2026-01-04 01:32:28.455 | DEBUG    | üîê Aguardando mais fragmentos AUTH...
2026-01-04 01:32:28.537 | INFO     | [OP-20260104_013157-0022] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0001065642414d4d446b6c765643424f5a58523362334a7249454e424d423458445449324d4445774e4441774e44517a4e466f580a44544d324d4445774d6a41 | ASCII: ...VBAMMDklvVCBOZXR3b3JrIENBMB4XDTI2MDEwNDAwNDQzNFoX.DTM2MDEwMjA [TRUNCATED]
2026-01-04 01:32:28.538 | DEBUG    | üîê AUTH indication recebida: 183 bytes
2026-01-04 01:32:28.538 | DEBUG    | Fragmento recebido: seq=1, total=6, payload=180 bytes, flags=0x00
2026-01-04 01:32:28.538 | DEBUG    | Fragmento 2/6 armazenado (2 de 6 recebidos)
2026-01-04 01:32:28.538 | DEBUG    | üîê Aguardando mais fragmentos AUTH...
2026-01-04 01:32:28.551 | DEBUG    | Autentica√ß√£o round 1/10
2026-01-04 01:32:28.629 | INFO     | [OP-20260104_013157-0023] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0002064d5463784454414c42674e564241734d42464e70626d7377675a7377454159484b6f5a497a6a3043415159464b34454541434d44675959414241416965 | ASCII: ...MTcxDTALBgNVBAsMBFNpbmswgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAAie [TRUNCATED]
2026-01-04 01:32:28.630 | DEBUG    | üîê AUTH indication recebida: 183 bytes
2026-01-04 01:32:28.630 | DEBUG    | Fragmento recebido: seq=2, total=6, payload=180 bytes, flags=0x00
2026-01-04 01:32:28.630 | DEBUG    | Fragmento 3/6 armazenado (3 de 6 recebidos)
2026-01-04 01:32:28.630 | DEBUG    | üîê Aguardando mais fragmentos AUTH...
2026-01-04 01:32:28.719 | INFO     | [OP-20260104_013157-0024] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 000306744e5338774d764f4b683338524e0a68474a6a584d4c4678794e3148747658795a6a6b546f6e452f454b6d542f4f2f676e544b3246515946364d344d44 | ASCII: ...tNS8wMvOKh38RN.hGJjXMLFxyN1HtvXyZjkTonE/EKmT/O/gnTK2FQYF6M4MD [TRUNCATED]
2026-01-04 01:32:28.720 | DEBUG    | üîê AUTH indication recebida: 183 bytes
2026-01-04 01:32:28.720 | DEBUG    | Fragmento recebido: seq=3, total=6, payload=180 bytes, flags=0x00
2026-01-04 01:32:28.720 | DEBUG    | Fragmento 4/6 armazenado (4 de 6 recebidos)
2026-01-04 01:32:28.720 | DEBUG    | üîê Aguardando mais fragmentos AUTH...
2026-01-04 01:32:28.809 | INFO     | [OP-20260104_013157-0025] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 183 bytes | Hex: 0004067147634b4e4f617968672f445975705336566f6269315549565972784e0a6b5258466b4e49746558616456426f6d324b326a397350446f307978766142 | ASCII: ...qGcKNOayhg/DYupS6Vobi1UIVYrxN.kRXFkNIteXadVBom2K2j9sPDo0yxvaB [TRUNCATED]
2026-01-04 01:32:28.810 | DEBUG    | üîê AUTH indication recebida: 183 bytes
2026-01-04 01:32:28.810 | DEBUG    | Fragmento recebido: seq=4, total=6, payload=180 bytes, flags=0x00
2026-01-04 01:32:28.810 | DEBUG    | Fragmento 5/6 armazenado (5 de 6 recebidos)
2026-01-04 01:32:28.810 | DEBUG    | üîê Aguardando mais fragmentos AUTH...
2026-01-04 01:32:28.897 | INFO     | [OP-20260104_013157-0026] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 50 bytes | Hex: 0205065254494649434154452d2d2d2d2d0ae8279179dc3c2ac2b7762eb081f437b6e380213150233838701f3c41f56248ea | ASCII: ...RTIFICATE-----..'.y.<*..v....7...!1P#88p.<A.bH.
2026-01-04 01:32:28.897 | DEBUG    | üîê AUTH indication recebida: 50 bytes
2026-01-04 01:32:28.898 | DEBUG    | Fragmento recebido: seq=5, total=6, payload=47 bytes, flags=0x02
2026-01-04 01:32:28.898 | DEBUG    | Fragmento 6/6 armazenado (6 de 6 recebidos)
2026-01-04 01:32:28.898 | INFO     | ‚úÖ Mensagem reconstru√≠da: 947 bytes (6 fragmentos)
2026-01-04 01:32:28.898 | DEBUG    | FragmentReassembler resetado
2026-01-04 01:32:28.898 | DEBUG    | üîê AUTH mensagem completa: 947 bytes
2026-01-04 01:32:29.051 | DEBUG    | Resposta auth lida do buffer: 947 bytes
2026-01-04 01:32:29.052 | DEBUG    | üì® Recebido: AuthMessage(type=CHALLENGE, payload=944 bytes)
2026-01-04 01:32:29.052 | INFO     | üé≤ Challenge recebido - processando certificado + challenge...
2026-01-04 01:32:29.053 | INFO     | üìú Extraindo certificado do peer do payload...
2026-01-04 01:32:29.158 | DEBUG    | ‚úÖ Assinatura da CA v√°lida
2026-01-04 01:32:29.159 | DEBUG    | ‚úÖ Certificado v√°lido temporalmente (expira em 2036-01-02 00:44:34+00:00)
2026-01-04 01:32:29.159 | INFO     | ‚úÖ Certificado validado com sucesso
2026-01-04 01:32:29.160 | INFO     | ‚úÖ Certificado do peer validado!
2026-01-04 01:32:29.161 | INFO     |    Peer NID: 4e127252...
2026-01-04 01:32:29.162 | INFO     |    Peer tipo: SINK
2026-01-04 01:32:29.163 | DEBUG    |    Challenge: e8279179dc3c2ac2b7762eb081f437b6...
2026-01-04 01:32:29.163 | INFO     | ‚úçÔ∏è  Assinando dados:
2026-01-04 01:32:29.164 | INFO     |    Data: 32 bytes | e8279179dc3c2ac2b7762eb081f437b6e380213150233838701f3c41f56248ea...
2026-01-04 01:32:29.182 | INFO     |    Signature: 138 bytes | 30818702415b43401d7fda1aa73992579fa21e65a19c573a3d5c38b48a529c51...
2026-01-04 01:32:29.183 | INFO     | ‚úçÔ∏è  Response gerada: 138 bytes
2026-01-04 01:32:29.184 | DEBUG    |    Estado: CHALLENGE_RECEIVED
2026-01-04 01:32:29.184 | DEBUG    | üì§ Enviando resposta (141 bytes)
2026-01-04 01:32:29.184 | DEBUG    | Mensagem pequena (141 bytes), 1 fragmento
2026-01-04 01:32:29.184 | DEBUG    | Enviando mensagem auth: 141 bytes em 1 fragmento(s)
2026-01-04 01:32:29.186 | INFO     | [OP-20260104_013157-0027] WRITE_REQUEST | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 144 bytes | Hex: 03000103008a30818702415b43401d7fda1aa73992579fa21e65a19c573a3d5c38b48a529c51dd2476de98f30841fc3c4740a4fda01f38938c6024282feb04fd | ASCII: ......0...A[C@.....9.W...e..W:=\8..R.Q.$v....A.<G@....8..`$(/... [TRUNCATED]
2026-01-04 01:32:29.256 | DEBUG    | ‚úÖ Write via SimpleBLE: 12340004-0000-1000-8000-00805f9b34fb (144 bytes)
2026-01-04 01:32:29.257 | INFO     | [OP-20260104_013157-0028] WRITE_SUCCESS | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb
2026-01-04 01:32:29.257 | DEBUG    |   Fragmento 1/1 enviado
2026-01-04 01:32:29.258 | DEBUG    | Autentica√ß√£o round 2/10
2026-01-04 01:32:29.258 | INFO     | [OP-20260104_013157-0029] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340004-0000-1000-8000-00805f9b34fb | Data: 6 bytes | Hex: 030001040000 | ASCII: ......
2026-01-04 01:32:29.258 | DEBUG    | üîê AUTH indication recebida: 6 bytes
2026-01-04 01:32:29.258 | DEBUG    | Fragmento recebido: seq=0, total=1, payload=3 bytes, flags=0x03
2026-01-04 01:32:29.259 | INFO     | Iniciando recep√ß√£o de 1 fragmentos
2026-01-04 01:32:29.259 | DEBUG    | Fragmento 1/1 armazenado (1 de 1 recebidos)
2026-01-04 01:32:29.259 | INFO     | ‚úÖ Mensagem reconstru√≠da: 3 bytes (1 fragmentos)
2026-01-04 01:32:29.260 | DEBUG    | FragmentReassembler resetado
2026-01-04 01:32:29.260 | DEBUG    | üîê AUTH mensagem completa: 3 bytes
2026-01-04 01:32:29.758 | DEBUG    | Resposta auth lida do buffer: 3 bytes
2026-01-04 01:32:29.759 | DEBUG    | üì® Recebido: AuthMessage(type=AUTH_SUCCESS, payload=0 bytes)
2026-01-04 01:32:29.759 | INFO     | ‚úÖ Peer confirmou autentica√ß√£o bem sucedida!
2026-01-04 01:32:29.761 | INFO     | ‚úÖ Autentica√ß√£o bem-sucedida!
2026-01-04 01:32:29.843 | DEBUG    | üîë Session key derivada: 32 bytes
2026-01-04 01:32:29.843 | INFO     | üîë Session key estabelecida
2026-01-04 01:32:29.844 | DEBUG    | üîë Session key configurada para porta uplink
2026-01-04 01:32:29.844 | INFO     | üîÄ Session key configurada no Router Daemon
2026-01-04 01:32:29.845 | INFO     | ‚úÖ Certificado do Sink armazenado para verifica√ß√£o de heartbeats
2026-01-04 01:32:29.846 | INFO     | DTLSChannel criado (client) com certificado node_0abd8260_cert.pem
2026-01-04 01:32:29.846 | INFO     | Iniciando handshake DTLS...
2026-01-04 01:32:29.846 | WARNING  | DTLS n√£o dispon√≠vel - operando em modo stub
2026-01-04 01:32:29.847 | INFO     | ‚úÖ Canal DTLS (stub) estabelecido
2026-01-04 01:32:29.848 | INFO     | üîê Canal DTLS end-to-end estabelecido com Sink
2026-01-04 01:32:29.848 | INFO     | üîë Chave de encripta√ß√£o end-to-end derivada (AES-256-GCM)
2026-01-04 01:32:29.849 | INFO     | üîë Chave de encripta√ß√£o end-to-end derivada
2026-01-04 01:32:31.598 | INFO     | [OP-20260104_013157-0030] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b170201000000066da5bc77b246ccc4c0e57da89a019a55e487c66c3563a9d39193 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......m..w.F....}....U...l5c.... [TRUNCATED]
2026-01-04 01:32:31.599 | DEBUG    | üì• Pacote recebido de uplink: 4e127252... ‚Üí 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 01:32:31.599 | DEBUG    | Novo source 4e127252...: seq=6 (primeiro pacote)
2026-01-04 01:32:31.600 | DEBUG    | Learning new route: 4e127252... ‚Üí uplink
2026-01-04 01:32:31.600 | DEBUG    | üìö Aprendido: 4e127252... ‚Üí uplink
2026-01-04 01:32:31.600 | INFO     | üì® Entregando localmente: 4e127252... ‚Üí 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 01:32:31.600 | DEBUG    | Novo source 4e127252...: seq=6 (primeiro pacote)
2026-01-04 01:32:31.601 | DEBUG    | üîç Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 01:32:31.601 | INFO     | üíì Verificando heartbeat:
2026-01-04 01:32:31.601 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 01:32:31.601 | INFO     |    Timestamp: 1767490351.4932556
2026-01-04 01:32:31.602 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da5670cbdf9180
2026-01-04 01:32:31.603 | INFO     | üîç Verificando assinatura:
2026-01-04 01:32:31.603 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da5670cbdf9180...
2026-01-04 01:32:31.604 | INFO     |    Signature: 139 bytes | 30818802420187cffc0eebd56ff47031012c07be503723a80d3b31526b67fa5b...
2026-01-04 01:32:31.605 | INFO     | ‚úÖ Assinatura verificada com sucesso!
2026-01-04 01:32:31.606 | DEBUG    | ‚úÖ Assinatura de heartbeat v√°lida
2026-01-04 01:32:31.606 | DEBUG    | üíì Heartbeat recebido (seq=6, age=0.11s)
2026-01-04 01:32:36.593 | INFO     | [OP-20260104_013157-0031] NOTIFICATION | Remote: E0:D3:62:D7:47:03 | Char: 12340001-0000-1000-8000-00805f9b34fb | Data: 236 bytes | Hex: 4e127252bd1a4c50860cf05dce3e7b174e127252bd1a4c50860cf05dce3e7b17020100000007687b2ab33bdae43f082ef77f3d3d79767e148eaae74d08a66136 | ASCII: N.rR..LP...].>{.N.rR..LP...].>{.......h{*.;..?....==yv~....M..a6 [TRUNCATED]
2026-01-04 01:32:36.595 | DEBUG    | üì• Pacote recebido de uplink: 4e127252... ‚Üí 4e127252... (type=MessageType(2), ttl=1)
2026-01-04 01:32:36.595 | DEBUG    | Source 4e127252...: seq=7 (novo highest, window: 2 seqs)
2026-01-04 01:32:36.596 | DEBUG    | üìö Aprendido: 4e127252... ‚Üí uplink
2026-01-04 01:32:36.596 | INFO     | üì® Entregando localmente: 4e127252... ‚Üí 4e127252... (type=MessageType(2), 166 bytes)
2026-01-04 01:32:36.597 | DEBUG    | Source 4e127252...: seq=7 (novo highest, window: 2 seqs)
2026-01-04 01:32:36.598 | DEBUG    | üîç Verificando assinatura: sig_len=139, signature_raw_len=139
2026-01-04 01:32:36.598 | INFO     | üíì Verificando heartbeat:
2026-01-04 01:32:36.599 | INFO     |    Sink NID: 4e127252bd1a4c50860cf05dce3e7b17
2026-01-04 01:32:36.600 | INFO     |    Timestamp: 1767490356.4960146
2026-01-04 01:32:36.602 | INFO     |    Data to verify: 4e127252bd1a4c50860cf05dce3e7b1741da5670cd1fbeb4
2026-01-04 01:32:36.603 | INFO     | üîç Verificando assinatura:
2026-01-04 01:32:36.603 | INFO     |    Data: 24 bytes | 4e127252bd1a4c50860cf05dce3e7b1741da5670cd1fbeb4...
2026-01-04 01:32:36.604 | INFO     |    Signature: 139 bytes | 308188024201b8aa52121609c6a3ce01f018d54344463d3ae9537851dc3980a4...
2026-01-04 01:32:36.609 | INFO     | ‚úÖ Assinatura verificada com sucesso!
2026-01-04 01:32:36.610 | DEBUG    | ‚úÖ Assinatura de heartbeat v√°lida
2026-01-04 01:32:36.611 | DEBUG    | üíì Heartbeat recebido (seq=7, age=0.12s)
2026-01-04 01:32:42.225 | INFO     | Desconectado de E0:D3:62:D7:47:03
2026-01-04 01:32:42.227 | INFO     | [OP-20260104_013157-0032] DISCONNECT | Remote: E0:D3:62:D7:47:03 | Reason: normal
2026-01-04 01:32:43.225 | WARNING  | ‚ö†Ô∏è  Conex√£o perdida com Sink
2026-01-04 01:32:43.228 | DEBUG    | Nenhum downlink para desconectar
2026-01-04 01:36:18.410 | INFO     | A parar Node...
2026-01-04 01:36:18.412 | INFO     | A parar GATT Server...
2026-01-04 01:36:18.415 | INFO     | ‚úÖ GATT Server parado
2026-01-04 01:36:18.417 | INFO     | ‚úÖ Node parado
